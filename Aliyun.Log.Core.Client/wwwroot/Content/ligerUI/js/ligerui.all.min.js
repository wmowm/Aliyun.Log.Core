(function(a){Function.prototype.ligerExtend=function(b,c){if(typeof b!="function")return this;this.base=b.prototype;this.base.constructor=b;var d=function(){};d.prototype=b.prototype;this.prototype=new d;this.prototype.constructor=this;c&&a.extend(this.prototype,c)};Function.prototype.ligerDefer=function(d,a,b){var c=this;return setTimeout(function(){c.apply(d,b||[])},a)};window.liger=a.ligerui={version:"V1.3.2",managerCount:0,managers:{},managerIdPrev:"ligerui",autoNewId:true,error:{managerIsExist:"\u7ba1\u7406\u5668id\u5df2\u7ecf\u5b58\u5728"},pluginPrev:"liger",attrPrev:"data",getId:function(a){a=a||this.managerIdPrev;var b=a+(1e3+this.managerCount);this.managerCount++;return b},add:function(a){if(arguments.length==2){var b=arguments[1];b.id=b.id||b.options.id||arguments[0].id;this.addManager(b);return}if(!a.id)a.id=this.getId(a.__idPrev());this.managers[a.id]=a},remove:function(b){if(typeof b=="string"||typeof b=="number")delete liger.managers[b];else if(typeof b=="object")if(b instanceof liger.core.Component)delete liger.managers[b.id];else{if(!a(b).attr(this.idAttrName))return false;delete liger.managers[a(b).attr(this.idAttrName)]}},"get":function(b,c){c=c||"ligeruiid";if(typeof b=="string"||typeof b=="number")return liger.managers[b];else if(typeof b=="object"){var d=b.length?b[0]:b,e=d[c]||a(d).attr(c);return!e?null:liger.managers[e]}return null},find:function(c){var d=[];for(var e in this.managers){var b=this.managers[e];if(c instanceof Function)b instanceof c&&d.push(b);else if(c instanceof Array)a.inArray(b.__getType(),c)!=-1&&d.push(b);else b.__getType()==c&&d.push(b)}return d},run:function(c,d,b){if(!c)return;b=a.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:false,hasElement:true,propertyToElemnt:null},b||{});c=c.replace(/^ligerGet/,"");c=c.replace(/^liger/,"");if(this==null||this==window||b.isStatic){if(!liger.plugins[c])liger.plugins[c]={fn:a[liger.pluginPrev+c],isStatic:true};return new a.ligerui[b.controlNamespace][c](a.extend({},a[b.defaultsNamespace][c]||{},a[b.defaultsNamespace][c+"String"]||{},d.length>0?d[0]:{}))}if(!liger.plugins[c])liger.plugins[c]={fn:a.fn[liger.pluginPrev+c],isStatic:false};if(/Manager$/.test(c))return liger.get(this,b.idAttrName);this.each(function(){if(this[b.idAttrName]||a(this).attr(b.idAttrName)){var f=liger.get(this[b.idAttrName]||a(this).attr(b.idAttrName));f&&d.length>0&&f.set(d[0]);return}if(d.length>=1&&typeof d[0]=="string")return;var g=d.length>0?d[0]:null,e=a.extend({},a[b.defaultsNamespace][c],a[b.defaultsNamespace][c+"String"],g);if(b.propertyToElemnt)e[b.propertyToElemnt]=this;if(b.hasElement)new a.ligerui[b.controlNamespace][c](this,e);else new a.ligerui[b.controlNamespace][c](e)});if(this.length==0)return null;if(d.length==0)return liger.get(this,b.idAttrName);if(typeof d[0]=="object")return liger.get(this,b.idAttrName);if(typeof d[0]=="string"){var e=liger.get(this,b.idAttrName);if(e==null)return;if(d[0]=="option"){if(d.length==2)return e.get(d[1]);else if(d.length>=3)return e.set(d[1],d[2])}else{var f=d[0];if(!e[f])return;var g=Array.apply(null,d);g.shift();return e[f].apply(e,g)}}return null},defaults:{},methods:{},core:{},controls:{},plugins:{}};a.ligerDefaults={};a.ligerMethos={};liger.defaults=a.ligerDefaults;liger.methods=a.ligerMethos;a.fn.liger=function(a){return a?liger.run.call(this,a,arguments):liger.get(this)};liger.core.Component=function(a){this.events=this.events||{};this.options=a||{};this.children={}};a.extend(liger.core.Component.prototype,{__getType:function(){return"liger.core.Component"},__idPrev:function(){return"ligerui"},"set":function(c,b,g){if(!c)return;if(typeof c=="object"){var d;if(this.options!=c){a.extend(this.options,c);d=c}else d=a.extend({},c);if(b==undefined||b==true)for(var e in d)e.indexOf("on")==0&&this.set(e,d[e]);if(b==undefined||b==false)for(var e in d)e.indexOf("on")!=0&&this.set(e,d[e],g);return}var f=c;if(f.indexOf("on")==0){typeof b=="function"&&this.bind(f.substr(2),b);return}if(!this.options)this.options={};if(this.trigger("propertychange",[c,b])==false)return;this.options[f]=b;var h="_set"+f.substr(0,1).toUpperCase()+f.substr(1);this[h]&&this[h].call(this,b,g);this.trigger("propertychanged",[c,b])},"get":function(a){var b="_get"+a.substr(0,1).toUpperCase()+a.substr(1);return this[b]?this[b].call(this,a):this.options[a]},hasBind:function(c){var b=c.toLowerCase(),a=this.events[b];return a&&a.length?true:false},trigger:function(d,a){if(!d)return;var f=d.toLowerCase(),b=this.events[f];if(!b)return;a=a||[];if(a instanceof Array==false)a=[a];for(var c=0;c<b.length;c++){var e=b[c];if(e.handler.apply(e.context,a)==false)return false}},bind:function(a,c,b){if(typeof a=="object"){for(var f in a)this.bind(f,a[f]);return}if(typeof c!="function")return false;var e=a.toLowerCase(),d=this.events[e]||[];b=b||this;d.push({handler:c,context:b});this.events[e]=d},unbind:function(e,c){if(!e){this.events={};return}var d=e.toLowerCase(),a=this.events[d];if(!a||!a.length)return;if(!c)delete this.events[d];else for(var b=0,f=a.length;b<f;b++)if(a[b].handler==c){a.splice(b,1);break}},destroy:function(){liger.remove(this)}});liger.core.UIComponent=function(c,d){liger.core.UIComponent.base.constructor.call(this,d);var b=this._extendMethods();b&&a.extend(this,b);this.element=c;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};liger.core.UIComponent.ligerExtend(liger.core.Component,{__getType:function(){return"liger.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();if(!this.element)this.id=this.options.id||liger.getId(this.__idPrev());else this.id=this.options.id||this.element.id||liger.getId(this.__idPrev());liger.add(this);if(!this.element)return;var c=this.attr();if(c&&c instanceof Array)for(var e=0;e<c.length;e++){var d=c[e];if(a(this.element).attr(d))this.options[d]=a(this.element).attr(d)}var f=this.options;if(a(this.element).attr("ligerui"))try{var b=a(this.element).attr("ligerui");if(b.indexOf("{")!=0)b="{"+b+"}";eval("attroptions = "+b+";");b&&a.extend(f,b)}catch(h){}function g(d,f){var b={};if(!d||d.indexOf(".")!=-1)return b;var c=liger.defaults[d];if(!c)return b;for(var a in c)if(f.attr(liger.attrPrev+"-"+a)){var e=f.attr(liger.attrPrev+"-"+a);if(typeof c[a]=="boolean")b[a]=e=="true"||e=="1";else b[a]=e}return b}a.extend(f,g(this.__getType(),a(this.element)))},_preRender:function(){},_render:function(){},_rendered:function(){this.element&&a(this.element).attr("ligeruiid",this.id)},_setCls:function(b){this.element&&b&&a(this.element).addClass(b)},attr:function(){return[]},destroy:function(){this.element&&a(this.element).remove();this.options=null;liger.remove(this)}});liger.controls.Input=function(a,b){liger.controls.Input.base.constructor.call(this,a,b)};liger.controls.Input.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Input"},attr:function(){return["nullText"]},setValue:function(a){return this.set("value",a)},getValue:function(){return this.get("value")},_setReadonly:function(c){var b=this.wrapper||this.text;if(!b||!b.hasClass("l-text"))return;var a=this.inputText;if(c){a&&a.attr("readonly","readonly");b.addClass("l-text-readonly")}else{a&&a.removeAttr("readonly");b.removeClass("l-text-readonly")}},setReadonly:function(a){return this.set("readonly",a)},setEnabled:function(){return this.set("disabled",false)},setDisabled:function(){return this.set("disabled",true)},updateStyle:function(){},resize:function(b,a){this.set({width:b,height:a+2})}});liger.win={top:false,mask:function(){function b(){if(!liger.win.windowMask)return;var b=a(window).height()+a(window).scrollTop();liger.win.windowMask.height(b)}if(!this.windowMask){this.windowMask=a("<div class='l-window-mask' style='display: block;'></div>").appendTo("body");a(window).bind("resize.ligeruiwin",b);a(window).bind("scroll",b)}this.windowMask.show();b();this.masking=true},unmask:function(f){for(var d=a("body > .l-dialog:visible,body > .l-window:visible"),b=0,h=d.length;b<h;b++){var e=d.eq(b).attr("ligeruiid");if(f&&f.id==e)continue;var c=liger.get(e);if(!c)continue;var g=c.get("modal");if(g)return}this.windowMask&&this.windowMask.hide();this.masking=false},createTaskbar:function(){if(!this.taskbar){this.taskbar=a('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body");this.top&&this.taskbar.addClass("l-taskbar-top");this.taskbar.tasks=a(".l-taskbar-tasks:first",this.taskbar);this.tasks={}}this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var a=this;a.taskbar.animate({bottom:-32},function(){a.taskbar.remove();a.taskbar=null})},activeTask:function(c){for(var a in this.tasks){var b=this.tasks[a];if(a==c.id)b.addClass("l-taskbar-task-active");else b.removeClass("l-taskbar-task-active")}},getTask:function(b){var a=this;return!a.taskbar?void 0:a.tasks[b.id]?a.tasks[b.id]:null},addTask:function(b){var c=this;!c.taskbar&&c.createTaskbar();if(c.tasks[b.id])return c.tasks[b.id];var e=b.get("title"),d=c.tasks[b.id]=a('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+e+"</div></div>");c.taskbar.tasks.append(d);c.activeTask(b);d.bind("click",function(){c.activeTask(b);if(b.actived)b.min();else b.active()}).hover(function(){a(this).addClass("l-taskbar-task-over")},function(){a(this).removeClass("l-taskbar-task-over")});return d},hasTask:function(){for(var a in this.tasks)if(this.tasks[a])return true;return false},removeTask:function(b){var a=this;if(!a.taskbar)return;if(a.tasks[b.id]){a.tasks[b.id].unbind();a.tasks[b.id].remove();delete a.tasks[b.id]}!a.hasTask()&&a.removeTaskbar()},setFront:function(d){var c=liger.find(liger.core.Win);for(var e in c){var b=c[e];if(b==d){a(b.element).css("z-index","9200");this.activeTask(b)}else a(b.element).css("z-index","9100")}}};liger.core.Win=function(a,b){liger.core.Win.base.constructor.call(this,a,b)};liger.core.Win.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Win"},mask:function(){this.options.modal&&liger.win.mask(this)},unmask:function(){this.options.modal&&liger.win.unmask(this)},min:function(){},max:function(){},active:function(){}});liger.draggable={dragging:false};liger.resizable={reszing:false};liger.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(a){var c=function(a){return a<10?"0"+a:a},f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i=function(a){f.lastIndex=0;return f.test(a)?'"'+a.replace(f,function(a){var b=meta[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'};if(a===null)return"null";var b=typeof a;if(b==="undefined")return undefined;if(b==="string")return i(a);if(b==="number"||b==="boolean")return""+a;if(b==="object"){if(typeof a.toJSON==="function")return liger.toJSON(a.toJSON());if(a.constructor===Date)return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null;var e=[];if(a.constructor===Array){for(var h=0,k=a.length;h<k;h++)e.push(liger.toJSON(a[h])||"null");return"["+e.join(",")+"]"}var g,j;for(var d in a){b=typeof d;if(b==="number")g='"'+d+'"';else if(b==="string")g=i(d);else continue;b=typeof a[d];if(b==="function"||b==="undefined")continue;j=liger.toJSON(a[d]);e.push(g+":"+j)}return"{"+e.join(",")+"}"}};liger.getEditor=function(b){var d=b.type,c=b.control,e=b.master;if(!d)return null;var g=0;if(c)c=c.substr(0,1).toUpperCase()+c.substr(1);var f={create:function(s,j,r){var f=j.field||j.column,l=r||{},q=j.column?true:false,h=a.extend({},b.options),m="text";if(a.inArray(d,["password","file","checkbox","radio"])!=-1)m=d;if(b.password)m="password";var i=a("<input type='"+m+"'/>");if(b.body)i=b.body.clone();i.appendTo(s);if(j.field){var p=f.name,n=a.isFunction(l.prefixID)?l.prefixID(e):l.prefixID||"";h.id=f.id||n+f.name;if(a.inArray(d,["select","combobox","autocomplete","popup"])!=-1){p=f.textField||f.comboboxName;if(f.comboboxName&&!f.id)h.id=(l.prefixID||"")+f.comboboxName}if(a.inArray(d,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])!=-1)h.valueFieldID=n+f.name;if(!b.body){var t=n+p,v=(new Date).getTime()+"_"+ ++g+"_"+f.name;i.attr(a.extend({id:v,name:t},f.attr));f.cssClass&&i.addClass(f.cssClass);f.validate&&!e.options.unSetValidateAttr&&i.attr("validate",liger.toJSON(f.validate))}a.extend(h,f.options)}if(f.dictionary){f.editor=f.editor||{};if(!f.editor.data){var o=[],u=f.dictionary.split("|");a(u).each(function(e,d){var a=d.split(","),b=a[0],c=a.length>=2?a[1]:a[0];o.push({id:b,value:b,text:c})});f.editor.data=o}}if(f.editor){if(f.editor.options){a.extend(h,f.editor.options);delete f.editor.options}if(f.editor.valueColumnName){h.valueField=f.editor.valueColumnName;delete f.editor.valueColumnName}if(f.editor.displayColumnName){h.textField=f.editor.displayColumnName;delete f.editor.displayColumnName}var k=f.editor.p||f.editor.ext;if(k){k=typeof k=="function"?k(j):k;a.extend(h,k);delete f.editor.p;delete f.editor.ext}a.extend(h,f.editor)}if(q){h.host_grid=this;h.host_grid_row=j.record;h.host_grid_column=j.column}else{h.host_form=this;if(f.readonly||h.host_form.get("readonly"))h.readonly=true}var w=i["liger"+c](h);q&&setTimeout(function(){i.focus()},100);return w},getValue:function(c,d){var b=d.field||d.column;if(c.getValue){var a=c.getValue(),e=d.column?d.column.editor.type:d.field.type;if(b&&b.editor&&b.editor.isArrayValue&&a)a=a.split(";");if(b&&b.editor&&b.editor.isRef&&c.getText)a=[a,c.getText()];if(b&&b.editor&&b.editor.isRefMul&&c.getText){var g=a.split(";"),h=c.getText().split(";");a=[];for(var f=0;f<g.length;f++)a.push([g[f],h[f]])}if(e=="int"||e=="digits")a=a?parseInt(a,10):0;else if(e=="float"||e=="number")a=a?parseFloat(a):0;return a}},setValue:function(f,b,e){var c=e.field||e.column;if(f.setValue){if(c&&c.editor&&c.editor.isArrayValue&&b)b=b.join(";");if(c&&c.editor&&c.editor.isRef&&a.isArray(b))b=b[0];if(c&&c.editor&&c.editor.isRefMul&&a.isArray(b)){for(var g=[],d=0;d<b.length;d++)g.push(b[d].length>1?b[d][1]:b[d][0]);b=g.join(";")}f.setValue(b)}},getText:function(b,a){var d=a.field||a.column;if(b.getText){var c=b.getText();if(c)return c}},setText:function(d,b,e){if(b&&d.setText)d.setText(b);else{var c=e.field||e.column;b=d.setValue()||e.value||"";if(c&&c.editor&&c.editor.isRef&&a.isArray(b)&&b.length>1)b=b[1];if(c&&c.editor&&c.editor.isRefMul&&a.isArray(b)&&b.length>1){for(var f=[],g=0;g<b.length;g++)f.push(b[1]);b=f.join(";")}d.setText&&d.setText(b)}},getSelected:function(a){if(a.getSelected)return a.getSelected()},resize:function(b,a,d,c){if(c.field)a=a-2;b.resize&&b.resize(a,d)},setEnabled:function(a,b){if(b)a.setEnabled&&a.setEnabled();else a.setDisabled&&a.setDisabled()},destroy:function(a){a.destroy&&a.destroy()}};return a.extend({},f,liger.editorCreatorDefaults||{},b)};liger.editors={text:{control:"TextBox"},date:{control:"DateEditor",setValue:function(b,a){if(typeof a=="string"&&/^\/Date/.test(a)){a=a.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+a)}b.setValue(a)}},combobox:{control:"ComboBox"},spinner:{control:"Spinner"},checkbox:{control:"CheckBox"},checkboxlist:{control:"CheckBoxList",body:a("<div></div>"),resize:function(a,b){a.set("width",b-2)}},radiolist:{control:"RadioList",body:a("<div></div>"),resize:function(a,b){a.set("width",b-2)}},listbox:{control:"ListBox",body:a("<div></div>"),resize:function(a,b){a.set("width",b-2)}},popup:{control:"PopupEdit"},number:{control:"TextBox",options:{number:true}},currency:{control:"TextBox",options:{currency:true}},digits:{control:"TextBox",options:{digits:true}},password:{control:"TextBox",password:true}};liger.editors.string=liger.editors.text;liger.editors.select=liger.editors.combobox;liger.editors["int"]=liger.editors.digits;liger.editors["float"]=liger.editors.number;liger.editors.chk=liger.editors.checkbox;liger.editors.popupedit=liger.editors.popup;a.fn.live=a.fn.on?a.fn.on:a.fn.live;if(!a.browser){var b=navigator.userAgent.toLowerCase();a.browser={version:(b.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(b),opera:/opera/.test(b),msie:/msie/.test(b)&&!/opera/.test(b),mozilla:/mozilla/.test(b)&&!/(compatible|webkit)/.test(b)}}})(jQuery);(function(a){liger.inject={prev:"liger-",defaults:{Grid_detail:{height:null,onShowDetail:null},Grid_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Grid_editor",Grid_popup:"PopupEdit",Grid_grid:"Grid",Grid_condition:"Form",Grid_toolbar:"Toolbar",Grid_fields:"Form_fields",Form_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Form_editor",Form_grid:"Grid",Form_columns:"Grid_columns",Form_condition:"Form",Form_popup:"PopupEdit",Form_buttons:"Button",Portal_panel:"Panel"},config:{Grid:{dynamics:"data,isChecked,detail,rowDraggingRender,toolbar,columns",arrays:"columns",columns:{dynamics:"render,totalSummary,headerRender,columns,editor,columns",arrays:"columns",textProperty:"display",columns:"liger.inject.config.Grid.columns",editor:{dynamics:"data,columns,render,renderItem,grid,condition,ext",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},toolbar:{arrays:"items"}},Form:{dynamics:"validate,fields,buttons",arrays:"fields,buttons",fields:{textProperty:"label",dynamics:"validate,editor",editor:{dynamics:"data,columns,render,renderItem,grid,condition,attr",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},buttons:"liger.inject.config.Button"},PopupEdit:{dynamics:"grid,condition"},Button:{textProperty:"text",dynamics:"click"},ComboBox:{dynamics:"columns,data,tree,grid,condition,render,parms,renderItem"},ListBox:{dynamics:"columns,data,render,parms"},RadioList:{dynamics:"data,parms"},CheckBoxList:{dynamics:"data,parms"},Panel:{},Portal:{dynamics:"rows,columns",arrays:"rows,columns",columns:{dynamics:"panels",arrays:"panels"},rows:{dynamics:"panels",arrays:"panels"},toolbar:{arrays:"items"}}},parse:function(a){try{return a==null?null:new Function("return "+a+";")()}catch(b){return null}},parseDefault:function(b){var d=this;if(!b)return b;var c={};a(b.split(",")).each(function(e,b){if(!b)return;b=b.substr(0,1).toUpperCase()+b.substr(1);a.extend(c,d.parse("liger.defaults."+b))});return c},fotmatValue:function(a,b){return b=="boolean"?a=="true"||a=="1":b=="number"&&a?parseFloat(a.toString()):a},getOptions:function(j){var g=j.jelement,m=j.defaults,h=j.config;h=a.extend({ignores:"",dynamics:"",arrays:""},h);var e=this,i={},d;if(h.textProperty)i[h.textProperty]=g.text();for(var b in m){var o=b.toLowerCase(),l=a("> ."+o,g);if(a.inArray(b,h.ignores.split(","))!=-1)continue;if(l.length){var n=j.controlName+"_"+b,c=e.defaults[n]||liger.defaults[n],f=h[b];if(typeof c=="string")c=e.parseDefault(c);else if(typeof c=="funcion")c=c();if(typeof f=="string")f=e.parse(f);else if(typeof f=="funcion")f=f();if(c)if(a.inArray(b,h.arrays.split(","))!=-1){d=[];a(">div,>li,>input",l).each(function(){d.push(e.getOptions({defaults:c,controlName:j.controlName,config:f,jelement:a(this)}))});i[b]=d}else i[b]=e.getOptions({defaults:c,controlName:j.controlName,config:f,jelement:l});l.remove()}else if(a.inArray(b,h.dynamics.split(","))!=-1||b.indexOf("on")==0){d=e.parse(g.attr("data-"+b)||g.attr(b));if(d)i[b]=e.fotmatValue(d,typeof m[b])}else{d=g.attr("data-"+b)||g.attr(b);if(d)i[b]=e.fotmatValue(d,typeof m[b])}}var k=g.attr("data-options")||g.attr("data-property");if(k)k=e.parse("{"+k+"}");k&&a.extend(i,k);return i},init:function(){var b=this,f=this.config;for(var d in b.defaults)if(typeof b.defaults[d]=="string")b.defaults[d]=b.parseDefault(b.defaults[d]);for(var c in liger.controls){var g=f[c]||{},e=b.prev+c.toLowerCase();a("."+e).each(function(){var d=a(this),h,e=a.extend({onrender:null,onrendered:null},liger.defaults[c]),f=b.getOptions({defaults:e,controlName:c,config:g,jelement:d});d[liger.pluginPrev+c](f)})}}};a(function(){liger.inject.init()})})(jQuery);(function(a){a.fn.ligerAccordion=function(){return a.ligerui.run.call(this,"ligerAccordion",arguments)};a.fn.ligerGetAccordionManager=function(){return a.ligerui.get(this)};a.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:false,heightDiff:0};a.ligerMethos.Accordion={};a.ligerui.controls.Accordion=function(b,c){a.ligerui.controls.Accordion.base.constructor.call(this,b,c)};a.ligerui.controls.Accordion.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return a.ligerMethos.Accordion},_render:function(){var b=this,c=this.options;b.accordion=a(b.element);!b.accordion.hasClass("l-accordion-panel")&&b.accordion.addClass("l-accordion-panel");var d=0;if(a("> div[lselected=true]",b.accordion).length>0)d=a("> div",b.accordion).index(a("> div[lselected=true]",b.accordion));a("> div",b.accordion).each(function(e,b){var c=a('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');e==d&&a(".l-accordion-toggle",c).addClass("l-accordion-toggle-open");if(a(b).attr("title")){a(".l-accordion-header-inner",c).html(a(b).attr("title"));a(b).attr("title","")}a(b).before(c);!a(b).hasClass("l-accordion-content")&&a(b).addClass("l-accordion-content");if(a(b).attr("data-icon")){c.addClass("l-accordion-header-hasicon");c.append('<i><img src="'+a(b).attr("data-icon")+'" /></i>')}});a(".l-accordion-header",b.accordion).removeClass("l-accordion-header-downfirst");a(".l-accordion-content:visible",b.accordion).next(".l-accordion-header:first").addClass("l-accordion-header-downfirst");a(".l-accordion-toggle",b.accordion).each(function(){!a(this).hasClass("l-accordion-toggle-open")&&!a(this).hasClass("l-accordion-toggle-close")&&a(this).addClass("l-accordion-toggle-close");a(this).hasClass("l-accordion-toggle-close")&&a(this).parent().next(".l-accordion-content:visible").hide()});a(".l-accordion-header",b.accordion).hover(function(){a(this).addClass("l-accordion-header-over")},function(){a(this).removeClass("l-accordion-header-over")});a(".l-accordion-toggle",b.accordion).hover(function(){if(a(this).hasClass("l-accordion-toggle-open"))a(this).addClass("l-accordion-toggle-open-over");else a(this).hasClass("l-accordion-toggle-close")&&a(this).addClass("l-accordion-toggle-close-over")},function(){if(a(this).hasClass("l-accordion-toggle-open"))a(this).removeClass("l-accordion-toggle-open-over");else a(this).hasClass("l-accordion-toggle-close")&&a(this).removeClass("l-accordion-toggle-close-over")});a(">.l-accordion-header",b.accordion).click(function(){var d=a(".l-accordion-toggle:first",this);if(d.hasClass("l-accordion-toggle-close")){d.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over");d.addClass("l-accordion-toggle-open");a(this).next(".l-accordion-content").show(c.speed).siblings(".l-accordion-content:visible").hide(c.speed);a(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")}else{d.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close");a(this).next(".l-accordion-content").hide(c.speed)}a(".l-accordion-header",b.accordion).removeClass("l-accordion-header-downfirst");a(".l-accordion-content:visible",b.accordion).next(".l-accordion-header:first").addClass("l-accordion-header-downfirst")});b.headerHoldHeight=0;a("> .l-accordion-header",b.accordion).each(function(){b.headerHoldHeight+=a(this).height()});if(c.height&&typeof c.height=="string"&&c.height.indexOf("%")>0){b.onResize();c.changeHeightOnResize&&a(window).resize(function(){b.onResize()})}else if(c.height){b.height=c.heightDiff+c.height;b.accordion.height(b.height);b.setHeight(c.height)}else b.header=b.accordion.height();b.set(c)},onResize:function(){var b=this,c=this.options;if(!c.height||typeof c.height!="string"||c.height.indexOf("%")==-1)return false;if(b.accordion.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.layout.parent().css("paddingTop"));d-=parseInt(b.layout.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*.01}else b.height=c.heightDiff+b.accordion.parent().height()*parseFloat(c.height)*.01;b.accordion.height(b.height);b.setContentHeight(b.height-b.headerHoldHeight)},setHeight:function(b){var c=this,d=this.options;c.accordion.height(b);b-=c.headerHoldHeight;a("> .l-accordion-content",c.accordion).height(b)}})})(jQuery);(function(a){a.fn.ligerButton=function(){return a.ligerui.run.call(this,"ligerButton",arguments)};a.fn.ligerGetButtonManager=function(){return a.ligerui.run.call(this,"ligerGetButtonManager",arguments)};a.ligerDefaults.Button={width:60,text:"Button",disabled:false,click:null,icon:null};a.ligerMethos.Button={};a.ligerui.controls.Button=function(b,c){a.ligerui.controls.Button.base.constructor.call(this,b,c)};a.ligerui.controls.Button.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return a.ligerMethos.Button},_render:function(){var b=this,c=this.options;b.button=a(b.element);b.button.addClass("l-button");b.button.append('<div class="l-button-l"></div><div class="l-button-r"></div><span></span>');b.button.hover(function(){if(c.disabled)return;b.button.addClass("l-button-over")},function(){if(c.disabled)return;b.button.removeClass("l-button-over")});c.click&&b.button.click(function(){!c.disabled&&c.click()});b.set(c)},_setIcon:function(b){var a=this;if(!b){a.button.removeClass("l-button-hasicon");a.button.find("img").remove()}else{a.button.addClass("l-button-hasicon");a.button.append('<img src="'+b+'" />')}},_setEnabled:function(a){a&&this.button.removeClass("l-button-disabled")},_setDisabled:function(a){if(a){this.button.addClass("l-button-disabled");this.options.disabled=true}else{this.button.removeClass("l-button-disabled");this.options.disabled=false}},_setWidth:function(a){this.button.width(a)},_setText:function(b){a("span",this.button).html(b)},setValue:function(a){this.set("text",a)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",false)},setDisabled:function(){this.set("disabled",true)}})})(jQuery);(function(a){a.fn.ligerCheckBox=function(){return a.ligerui.run.call(this,"ligerCheckBox",arguments)};a.fn.ligerGetCheckBoxManager=function(){return a.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)};a.ligerDefaults.CheckBox={disabled:false,readonly:false};a.ligerMethos.CheckBox={};a.ligerui.controls.CheckBox=function(b,c){a.ligerui.controls.CheckBox.base.constructor.call(this,b,c)};a.ligerui.controls.CheckBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return a.ligerMethos.CheckBox},_render:function(){var b=this,c=this.options;b.input=a(b.element);b.link=a('<a class="l-checkbox"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.link.click(function(){if(b.input.attr("disabled")||b.input.attr("readonly"))return false;if(c.disabled||c.readonly)return false;if(b.trigger("beforeClick",[b.element])==false)return false;if(a(this).hasClass("l-checkbox-checked"))b._setValue(false);else b._setValue(true);b.input.trigger("change")});b.wrapper.hover(function(){!c.disabled&&a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});this.set(c);this.updateStyle()},_setCss:function(a){this.wrapper.css(a)},_setValue:function(b){var a=this,c=this.options;if(!b){a.input[0].checked=false;a.link.removeClass("l-checkbox-checked")}else{a.input[0].checked=true;a.link.addClass("l-checkbox-checked")}},_setDisabled:function(a){if(a){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled")}else{this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled")}},_getValue:function(){return this.element.checked},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked)this.link.addClass("l-checkbox-checked");else this.link.removeClass("l-checkbox-checked")}})})(jQuery);(function(a){a.fn.ligerCheckBoxList=function(){return a.ligerui.run.call(this,"ligerCheckBoxList",arguments)};a.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,urlParms:null,ajaxContentType:null,ajaxType:"post",onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.CheckBoxList=a.ligerMethos.CheckBoxList||{};a.ligerui.controls.CheckBoxList=function(b,c){a.ligerui.controls.CheckBoxList.base.constructor.call(this,b,c)};a.ligerui.controls.CheckBoxList.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return a.ligerMethos.CheckBoxList},_init:function(){a.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(a(this.element).is(":hidden")||a(this.element).is(":text")){b.valueField=a(this.element);a(this.element).is(":text")&&b.valueField.hide()}else if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0)b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null)b.valueField[0].name=b.valueField[0].id;c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass);b.valueField.attr("data-ligerid",b.id);if(a(this.element).is(":hidden")||a(this.element).is(":text"))b.checkboxList=a("<div></div>").insertBefore(this.element);else b.checkboxList=a(this.element);b.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(b.valueField);b.checkboxList.table=a("table:first",b.checkboxList);b.set(c);b._addClickEven()},destroy:function(){this.checkboxList&&this.checkboxList.remove();this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(a){a&&this.checkboxList.addClass(a)},_setDisabled:function(b){if(b){this.checkboxList.addClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).attr("disabled",true)}else{this.checkboxList.removeClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).removeAttr("disabled")}},_setWidth:function(a){this.checkboxList.width(a)},_setHeight:function(a){this.checkboxList.height(a)},indexOf:function(c){var b=this,e=this.options;if(!b.data)return-1;for(var a=0,d=b.data.length;a<d;a++)if(typeof c=="object"){if(b.data[a]==c)return a}else if(b.data[a][e.valueField].toString()==c.toString())return a;return-1},removeItems:function(c){var b=this;if(!b.data)return;a(c).each(function(d,c){var a=b.indexOf(c);if(a==-1)return;b.data.splice(a,1)});b.refresh()},removeItem:function(b){if(!this.data)return;var a=this.indexOf(b);if(a==-1)return;this.data.splice(a,1);this.refresh()},insertItem:function(c,b){var a=this;if(!a.data)a.data=[];a.data.splice(b,0,c);a.refresh()},addItems:function(c){var b=this;if(!b.data)b.data=[];a(c).each(function(c,a){b.data.push(a)});b.refresh()},addItem:function(b){var a=this;if(!a.data)a.data=[];a.data.push(b);a.refresh()},_setValue:function(b){var c=this,a=this.options;a.value=b;c.valueField.val(a.value);this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(c){if(!c)return;var e=this,b=this.options,f=a.isFunction(b.urlParms)?b.urlParms.call(e):b.urlParms;if(f)for(name in f){c+=c.indexOf("?")==-1?"?":"&";c+=name+"="+f[name]}var d=a.isFunction(b.parms)?b.parms():b.parms;if(b.ajaxContentType=="application/json"&&typeof d!="string")d=liger.toJSON(d);a.ajax({type:b.ajaxType||"post",url:c,data:d,cache:false,dataType:"json",contentType:b.ajaxContentType,success:function(a){e.setData(a);e.trigger("success",[a])},error:function(a,b){e.trigger("error",[a,b])}})},setUrl:function(a){return this._setUrl(a)},setParm:function(b,d){if(!b)return;var c=this,a=c.get("parms");if(!a)a={};a[b]=d;c.set("parms",a)},clearContent:function(){var b=this,c=this.options;a("table",b.checkboxList).html("")},_setData:function(a){this.setData(a)},setData:function(a){var b=this,c=this.options;if(!a||!a.length)return;b.data=a;b.refresh();b.updateStyle()},refresh:function(){var f=this,d=this.options,c=this.data;this.clearContent();if(!c)return;for(var b=[],h=d.rowSize,e=false,j=d.name||f.id,a=0;a<c.length;a++){var l=c[a][d.valueField],k=c[a][d.textField],g=f.id+"-"+a,i=a%h==0;if(i){e&&b.push("</tr>");b.push("<tr>");e=true}b.push("<td><input type='checkbox' name='"+j+"' value='"+l+"' id='"+g+"'/><label for='"+g+"'>"+k+"</label></td>")}e&&b.push("</tr>");f.checkboxList.table.append(b.join(""))},_getValue:function(){var e=this,c=this.options,d=c.name||e.id,b=[];a('input:checkbox[name="'+d+'"]:checked').each(function(){b.push(this.value)});return!b.length?null:b.join(c.split)},getValue:function(){return this._getValue()},getText:function(){var e=this,c=this.options,d=c.name||e.id,b=[];a('input:checkbox[name="'+d+'"]:checked').each(function(){b.push(a(this).next("label").text())});return!b.length?null:b.join(c.split)},updateStyle:function(){this._dataInit()},_dataInit:function(){var a=this,c=this.options,b=a.valueField.val();a._changeValue(b)},_changeValue:function(b){var c=this,d=this.options,f=d.name||c.id,e=b?b.split(d.split):[];a("input:checkbox[name='"+f+"']",c.checkboxList).each(function(){this.checked=a.inArray(this.value,e)>-1});c.valueField.val(b);c.selectedValue=b},_addClickEven:function(){var a=this,b=this.options;a.checkboxList.click(function(){var b=a.getValue();b&&a.valueField.val(b)})}})})(jQuery);(function(a){a.fn.ligerComboBox=function(){return a.ligerui.run.call(this,"ligerComboBox",arguments)};a.fn.ligerGetComboBoxManager=function(){return a.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)};a.ligerDefaults.ComboBox={resize:true,isMultiSelect:false,isShowCheckBox:false,columns:null,width:null,selectBoxWidth:null,selectBoxHeight:120,selectBoxPosYDiff:-3,onBeforeSelect:false,onAfterShowData:null,onSelected:null,initValue:null,value:null,initText:null,valueField:"id",textField:"text",dataParmName:null,valueFieldID:null,ajaxComplete:null,ajaxBeforeSend:null,ajaxContentType:null,slide:false,split:";",data:null,dataGetter:null,tree:null,treeLeafOnly:true,condition:null,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:true,hideGridOnLoseFocus:false,url:null,urlParms:null,selectBoxRender:null,selectBoxRenderUpdate:null,detailEnabled:true,detailUrl:null,detailPostIdField:null,detailDataParmName:null,detailParms:null,detailDataGetter:null,delayLoad:false,triggerToLoad:false,emptyText:null,addRowButton:"\u65b0\u589e",addRowButtonClick:null,triggerIcon:null,onSuccess:null,onBeforeSetData:null,onError:null,onBeforeOpen:null,onButtonClick:null,onTextBoxKeyDown:null,onTextBoxKeyEnter:null,render:null,absolute:true,cancelable:true,css:null,parms:null,renderItem:null,autocomplete:false,autocompleteAllowEmpty:true,isTextBoxMode:false,highLight:false,readonly:false,ajaxType:"post",alwayShowInTop:false,alwayShowInDown:false,valueFieldCssClass:null,isRowReadOnly:null,rowClsRender:null,keySupport:false,initIsTriggerEvent:false,conditionSearchClick:null,onChangeValue:null,delayLoadGrid:true,setTextBySource:true};a.ligerDefaults.ComboBoxString={Search:"\u641c\u7d22"};a.ligerMethos.ComboBox=a.ligerMethos.ComboBox||{};a.ligerui.controls.ComboBox=function(b,c){a.ligerui.controls.ComboBox.base.constructor.call(this,b,c)};a.ligerui.controls.ComboBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return a.ligerMethos.ComboBox},_init:function(){a.ligerui.controls.ComboBox.base._init.call(this);var b=this.options;if(b.columns)b.isShowCheckBox=true;if(b.isMultiSelect)b.isShowCheckBox=true;if(b.triggerToLoad)b.delayLoad=true},_render:function(){var b=this,c=this.options;b.data=c.data;b.inputText=null;b.select=null;b.textFieldID="";b.valueFieldID="";b.valueField=null;if(a(this.element).is(":hidden")){b.valueField=a(this.element);b.textFieldID=c.textFieldID||this.element.id+"_txt";b.inputText=a('<input type="text" readonly="true"/>');b.inputText.attr("id",b.textFieldID).insertAfter(a(this.element));if(b.valueField.attr("validate")){b.inputText.attr("validate",b.valueField.attr("validate"));b.valueField.removeAttr("validate")}if(b.valueField.attr("validateMessage")){b.inputText.attr("validateMessage",b.valueField.attr("validateMessage"));b.valueField.removeAttr("validateMessage")}}else if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}else if(this.element.tagName.toLowerCase()=="select"){a(this.element).hide();b.select=a(this.element);c.isMultiSelect=false;c.isShowCheckBox=false;c.cancelable=false;b.textFieldID=c.textFieldID||this.element.id+"_txt";b.inputText=a('<input type="text" readonly="true"/>');b.inputText.attr("id",b.textFieldID).insertAfter(a(this.element));if(b.select.attr("validate")){b.inputText.attr("validate",b.select.attr("validate"));b.select.removeAttr("validate")}if(b.select.attr("validateMessage")){b.inputText.attr("validateMessage",b.select.attr("validateMessage"));b.select.removeAttr("validateMessage")}if(!c.value&&this.element.value)c.value=this.element.value}if(b.inputText[0].name==undefined)b.inputText[0].name=b.textFieldID;b.inputText.attr("data-comboboxid",b.id);if(b.valueField==null)if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input").filter("input:hidden");if(b.valueField.length==0)b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"}c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass);if(b.valueField[0].name==undefined)b.valueField[0].name=b.valueField[0].id;if(c.initValue!=null)b.valueField[0].value=c.initValue;b.valueField.attr("data-ligerid",b.id);b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');c.triggerIcon&&b.link.find("div:first").addClass(c.triggerIcon);b.selectBox=a('<div class="l-box-select" style="display:none"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>');b.selectBox.table=a("table:first",b.selectBox);b.selectBoxInner=b.selectBox.find(".l-box-select-inner:first");b.wrapper=b.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.textwrapper=b.wrapper.wrap('<div class="l-text-wrapper"></div>').parent();if(c.absolute)b.selectBox.appendTo("body").addClass("l-box-select-absolute");else b.textwrapper.append(b.selectBox);b.textwrapper.append(b.valueField);b.inputText.addClass("l-text-field");if(c.isShowCheckBox&&!b.select)a("table",b.selectBox).addClass("l-table-checkbox");else{c.isShowCheckBox=false;a("table",b.selectBox).addClass("l-table-nocheckbox")}b.link.hover(function(){if(c.disabled||c.readonly)return;this.className="l-trigger-hover"},function(){if(c.disabled||c.readonly)return;this.className="l-trigger"}).mousedown(function(){if(c.disabled||c.readonly)return;this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled||c.readonly)return;this.className="l-trigger-hover"}).click(function(){if(c.disabled||c.readonly)return;if(b.trigger("buttonClick")==false)return false;if(b.trigger("beforeOpen")==false)return false;if(c.triggerToLoad&&!b.triggerLoaded){b.triggerLoaded=true;b._setUrl(c.url,function(){b._toggleSelectBox(b.selectBox.is(":visible"))})}else b._toggleSelectBox(b.selectBox.is(":visible"))});b.inputText.click(function(){if(c.disabled||c.readonly)return;if(b.trigger("beforeOpen")==false)return false;if(!c.autocomplete)if(c.triggerToLoad&&!b.triggerLoaded){b.triggerLoaded=true;b._setUrl(c.url,function(){b._toggleSelectBox(b.selectBox.is(":visible"))})}else b._toggleSelectBox(b.selectBox.is(":visible"));else b.updateSelectBoxPosition()}).blur(function(){if(c.disabled)return;b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled||c.readonly)return;b.wrapper.addClass("l-text-focus")}).change(function(){b.trigger("changeValue",[this.value])});b.wrapper.hover(function(){if(c.disabled||c.readonly)return;b.wrapper.addClass("l-text-over")},function(){if(c.disabled||c.readonly)return;b.wrapper.removeClass("l-text-over")});b.resizing=false;b.selectBox.hover(null,function(){c.hideOnLoseFocus&&b.selectBox.is(":visible")&&!b.boxToggling&&!b.resizing&&b._toggleSelectBox(true)});b.bulidContent();b.set(c,null,"init");if(c.selectBoxWidth)b.selectBox.width(c.selectBoxWidth);else b.selectBox.css("width",b.wrapper.css("width"));if(c.grid)if(c.delayLoadGrid)b.bind("show",function(){if(!b.grid){b.setGrid(c.grid);b.set("SelectBoxHeight",c.selectBoxHeight)}});else if(!b.grid){b.setGrid(c.grid);b.set("SelectBoxHeight",c.selectBoxHeight)}b.updateSelectBoxPosition();a(document).bind("click.combobox",function(c){b.selectBox.is(":visible")&&a(c.target||c.srcElement).closest(".l-box-select, .l-text-combobox").length==0&&b._toggleSelectBox(true)})},destroy:function(){this.wrapper&&this.wrapper.remove();this.selectBox&&this.selectBox.remove();this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("","");a("a.l-checkbox-checked",this.selectBox).removeClass("l-checkbox-checked");a("td.l-selected",this.selectBox).removeClass("l-selected");a(":checkbox",this.selectBox).each(function(){this.checked=false});this.trigger("clear")},_setSelectBoxHeight:function(e){if(!e)return;var b=this,c=this.options;if(c.grid)b.grid&&b.grid.set("height",b.getGridHeight(e));else if(!c.tree){var d=a("tr",b.selectBox.table).length;if(!c.selectBoxHeight&&d<8)c.selectBoxHeight=d*30;if(c.selectBoxHeight)if(d<8)b.selectBoxInner.height("auto");else b.selectBoxInner.height(c.selectBoxHeight)}else b.selectBoxInner.height(c.selectBoxHeight)},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(d){var b=this,c=this.options;if(!d&&b.unselect){b.unselect.remove();b.unselect=null}if(!d&&!b.unselect)return;b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.wrapper.hover(function(){b.unselect.show()},function(){b.unselect.hide()});!c.disabled&&!c.readonly&&c.cancelable&&b.wrapper.append(b.unselect);b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){b.clear()})},_setDisabled:function(a){if(a)this.wrapper.addClass("l-text-disabled");else this.wrapper.removeClass("l-text-disabled")},_setReadonly:function(a){if(a)this.wrapper.addClass("l-text-readonly");else this.wrapper.removeClass("l-text-readonly")},_setLable:function(d){var b=this,c=this.options;if(d){if(b.labelwrapper)b.labelwrapper.find(".l-text-label:first").html(d+":&nbsp");else{b.labelwrapper=b.textwrapper.wrap('<div class="l-labeltext"></div>').parent();b.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+d+":&nbsp</div>");b.textwrapper.css("float","left")}if(!c.labelWidth)c.labelWidth=a(".l-text-label",b.labelwrapper).outerWidth();else a(".l-text-label",b.labelwrapper).outerWidth(c.labelWidth);a(".l-text-label",b.labelwrapper).width(c.labelWidth);a(".l-text-label",b.labelwrapper).height(b.wrapper.height());b.labelwrapper.append('<br style="clear:both;" />');c.labelAlign&&a(".l-text-label",b.labelwrapper).css("text-align",c.labelAlign);b.textwrapper.css({display:"inline"});b.labelwrapper.width(b.wrapper.outerWidth()+c.labelWidth+2)}},_setWidth:function(a){var b=this,c=this.options;if(a>20){b.wrapper.css({width:a});b.inputText.css({width:a-20});!c.selectBoxWidth&&b.selectBox.css({width:a})}},_setHeight:function(a){var b=this;if(a>10){b.wrapper.height(a);b.inputText.height(a-2)}},_setResize:function(e){var b=this,c=this.options;if(c.columns)return;if(e&&a.fn.ligerResizable){var d=c.selectBoxHeight?"e":"se,s,e";b.selectBox.ligerResizable({handles:d,onStartResize:function(){b.resizing=true;b.trigger("startResize")},onEndResize:function(){b.resizing=false;if(b.trigger("endResize")==false)return false},onStopResize:function(a){if(b.grid){a.newWidth&&b.selectBox.width(a.newWidth);a.newHeight&&b.set({selectBoxHeight:a.newHeight});b.grid.refreshSize();b.trigger("endResize");return false}return true}});b.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(f){var c=this,d=this.options;if(f==null)return"";var b="",g=function(c){for(var b=f.toString().split(d.split),a=0;a<b.length;a++)if(b[a]==c&&b[a]!="")return true;return false},e;if(c.options.grid&&c.options.grid.data)e=c.options.grid.data.Rows;else e=c.data;a(e).each(function(f,a){var e=a[d.valueField],c=a[d.textField];if(g(e))b+=c+d.split});if(b.length>0)b=b.substr(0,b.length-1);return b},findValueByText:function(d){var f=this,c=this.options;if(!d&&d=="")return"";var e=function(e){for(var b=d.toString().split(c.split),a=0;a<b.length;a++)if(b[a]==e)return true;return false},b="";a(f.data).each(function(g,a){var f=a[c.valueField],d=a[c.textField];if(e(d))b+=f+c.split});if(b.length>0)b=b.substr(0,b.length-1);return b},insertItem:function(c,b){var a=this,d=this.options;a.data=a.data||[];a.data.splice(b,0,c);a.setData(a.data)},addItem:function(b){var a=this,c=this.options;a.insertItem(b,(a.data||[]).length)},_setIsTextBoxMode:function(a){var b=this,c=this.options;a&&b.inputText.removeAttr("readonly")},_setValue:function(b,d){var c=this,e=this.options,i=false,f=true;if(d=="init"){d=null;i=true;f=e.initIsTriggerEvent?true:false}if(e.isTextBoxMode)d=b;else d=d||c.findTextByValue(b);if(e.tree)setTimeout(function(){if(e.setTextBySource)c.selectValueByTree(b);else c.treeSelectInit(b)},100);else if(!e.isMultiSelect){c._changeValue(b,d,f);a("tr[value='"+b+"'] td",c.selectBox).addClass("l-selected");a("tr[value!='"+b+"'] td",c.selectBox).removeClass("l-selected")}else{c._changeValue(b,d,f);if(b!=null){var h=b.toString().split(e.split);a("table.l-table-checkbox :checkbox",c.selectBox).each(function(){this.checked=false});for(var g=0;g<h.length;g++)a("table.l-table-checkbox tr[value="+h[g]+"] :checkbox",c.selectBox).each(function(){this.checked=true})}}e.selectBoxRenderUpdate&&e.selectBoxRenderUpdate.call(c,{selectBox:c.selectBox,value:b,text:d})},selectValue:function(a){this._setValue(a)},bulidContent:function(){var a=this,b=this.options;this.clearContent();if(a.select)a.setSelect();else b.tree&&a.setTree(b.tree)},reload:function(){var a=this,b=this.options;if(b.url)a.set("url",b.url);else a.grid&&a.grid.reload()},_setUrl:function(d,g){if(!d)return;var c=this,b=this.options;if(b.readonly)return;if(b.delayLoad&&!c.isAccessDelay&&!c.triggerLoaded){c.isAccessDelay=true;return}d=a.isFunction(d)?d.call(c):d;var f=a.isFunction(b.urlParms)?b.urlParms.call(c):b.urlParms;if(f)for(name in f){d+=d.indexOf("?")==-1?"?":"&";d+=name+"="+f[name]}var e=a.isFunction(b.parms)?b.parms.call(c):b.parms;if(b.ajaxContentType=="application/json"&&typeof e!="string")e=liger.toJSON(e);var h={type:b.ajaxType,url:d,data:e,cache:false,dataType:"json",beforeSend:b.ajaxBeforeSend,complete:b.ajaxComplete,success:function(e){var d=a.isFunction(b.dataGetter)?(d=b.dataGetter.call(c,e)):e;d=b.dataParmName&&d?d[b.dataParmName]:d;if(c.trigger("beforeSetData",[d])==false)return;c.setData(d);c.trigger("success",[d]);a.isFunction(g)&&g(d)},error:function(a,b){c.trigger("error",[a,b])}};if(b.ajaxContentType)h.contentType=b.ajaxContentType;a.ajax(h)},setUrl:function(b,a){return this._setUrl(b,a)},setParm:function(b,d){if(!b)return;var c=this,a=c.get("parms");if(!a)a={};a[b]=d;c.set("parms",a)},clearContent:function(){var b=this,c=this.options;if(!b)return;a("table",b.selectBox).html("");if(!b)return;b._setSelectBoxHeight(c.selectBoxHeight)},setSelect:function(){var b=this,c=this.options;this.clearContent();b.data=[];a("option",b.select).each(function(f){var d=a(this).val(),c=a(this).html();b.data.push({text:c,id:d});var e=a("<tr><td index='"+f+"' value='"+d+"' text='"+c+"'>"+c+"</td>");a("table.l-table-nocheckbox",b.selectBox).append(e);a("td",e).hover(function(){a(this).addClass("l-over").siblings("td").removeClass("l-over")},function(){a(this).removeClass("l-over")})});a("td:eq("+b.select[0].selectedIndex+")",b.selectBox).each(function(){if(a(this).hasClass("l-selected")){b.selectBox.hide();return}a(".l-selected",b.selectBox).removeClass("l-selected");a(this).addClass("l-selected");if(b.select[0].selectedIndex!=a(this).attr("index")&&b.select[0].onchange){b.select[0].selectedIndex=a(this).attr("index");b.select[0].onchange()}var e=parseInt(a(this).attr("index"));b.select[0].selectedIndex=e;b.select.trigger("change");b.selectBox.hide();var f=a(this).attr("value"),d=a(this).html();if(c.render)b.inputText.val(c.render(f,d));else b.inputText.val(d)});b._addClickEven()},_setData:function(a){this.setData(a)},getRowIndex:function(c){var a=this,e=this.options;if(!c)return-1;if(!a.data||!a.data.length)return-1;for(var b=0;b<a.data.length;b++){if(a.data[b]==null)continue;var d=a.data[b][e.valueField];if(d==c)return b}return-1},getRow:function(c){var a=this,e=this.options;if(!c)return null;if(!a.data||!a.data.length)return null;for(var b=0;b<a.data.length;b++){if(a.data[b]==null)continue;var d=a.data[b][e.valueField];if(d==c)return a.data[b]}return null},setData:function(e){var b=this,c=this.options;if(b.select)return;if(c.selectBoxRender){c.selectBoxRender.call(b,{selectBox:b.selectBox,data:e});return}if(!e||!e.length)e=[];if(b.data!=e)b.data=e;b.data=a.isFunction(b.data)?b.data():b.data;this.clearContent();if(c.columns){b.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px'></td></tr>");b.selectBox.table.append(b.selectBox.table.headrow);b.selectBox.table.addClass("l-box-select-grid");for(var g=0;g<c.columns.length;g++){var m=a("<td columnindex='"+g+"' columnname='"+c.columns[g].name+"'>"+c.columns[g].header+"</td>");c.columns[g].width&&m.width(c.columns[g].width);b.selectBox.table.headrow.append(m)}}var d=[];if(c.emptyText){b.emptyRow={};b.emptyRow[c.textField]=c.emptyText;b.emptyRow[c.valueField]=c.emptyValue!=undefined?c.emptyValue:"";e.splice(0,0,b.emptyRow)}for(var f=0;f<e.length;f++){var i=e[f][c.valueField],h=e[f][c.textField],l=a.isFunction(c.isRowReadOnly)?c.isRowReadOnly(e[f]):false;if(!c.columns){d.push("<tr value='"+i+"'");var k=[];l&&k.push(" rowreadonly ");a.isFunction(c.rowClsRender)&&k.push(c.rowClsRender(e[f]));if(k.length){d.push(" class='");d.push(k.join(""));d.push("'")}d.push(">");c.isShowCheckBox&&d.push("<td style='width:18px;'  index='"+f+"' value='"+i+"' text='"+h+"' ><input type='checkbox' /></td>");var j=h;if(c.renderItem)j=c.renderItem.call(b,{data:e[f],value:i,text:h,key:b.inputText.val()});else if(c.autocomplete&&c.highLight)j=b._highLight(h,b.inputText.val());else j="<span>"+j+"</span>";d.push("<td index='"+f+"' value='"+i+"' text='"+h+"' align='left'>"+j+"</td></tr>")}else{d.push("<tr value='"+i+"'");l&&d.push(" class='rowreadonly'");d.push(">");d.push("<td style='width:18px;'  index='"+f+"' value='"+i+"' text='"+h+"' ><input type='checkbox' /></td>");for(var g=0;g<c.columns.length;g++){var n=c.columns[g].name;d.push("<td>"+e[f][n]+"</td>")}d.push("</tr>")}}if(!c.columns)if(c.isShowCheckBox)a("table.l-table-checkbox",b.selectBox).append(d.join(""));else a("table.l-table-nocheckbox",b.selectBox).append(d.join(""));else b.selectBox.table.append(d.join(""));if(c.addRowButton&&c.addRowButtonClick&&!b.addRowButton){b.addRowButton=a('<div class="l-box-select-add"><a href="javascript:void(0)" class="link"><div class="icon"></div></a></div>');b.addRowButton.find(".link").append(c.addRowButton).click(c.addRowButtonClick);b.selectBoxInner.after(b.addRowButton)}b.set("selectBoxHeight",c.selectBoxHeight);c.isShowCheckBox&&a.fn.ligerCheckBox&&a("table input:checkbox",b.selectBox).ligerCheckBox();a(".l-table-checkbox input:checkbox",b.selectBox).change(function(){if(this.checked&&b.hasBind("beforeSelect")){var d=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div")d=a(this).parent().parent();else d=a(this).parent();if(d!=null&&b.trigger("beforeSelect",[d.attr("value"),d.attr("text")])==false){b.selectBox.slideToggle("fast");return false}}if(!c.isMultiSelect)if(this.checked){a("input:checked",b.selectBox).not(this).each(function(){this.checked=false;a(".l-checkbox-checked",a(this).parent()).removeClass("l-checkbox-checked")});b.selectBox.slideToggle("fast")}b._checkboxUpdateValue()});a("table.l-table-nocheckbox td",b.selectBox).hover(function(){!a(this).parent().hasClass("rowreadonly")&&a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});b._addClickEven();!c.autocomplete&&b.updateStyle();if(null!=a(".l-grid1 .l-grid-header-inner .l-grid-header-table .l-grid-hd-row .l-grid-hd-cell-checkbox").html())if(navigator.userAgent.indexOf("MSIE")>0)a("tr[id^=maingrid|2|]").each(function(f){var d=a(this).attr("id"),b=document.getElementById(d).offsetHeight;if(f>0)b=b-1;var d=a(this).attr("id"),c=d.replace("|2|","\\|1\\|");a("#"+c).attr("style","height:"+b+"px;");var e=(b-15)/2;a("#"+c+">td>div>span").attr("style","margin-top: "+e+"px;")});else a("tr[id^=maingrid\\|2\\|]").each(function(){var d=a(this).attr("id"),c=document.getElementById(d).offsetHeight,b=d.replace("|2|","\\|1\\|");a("#"+b).attr("style","height:"+c+"px;");var e=(c-15)/2;a("#"+b+">td>div>span").attr("style","margin-top: "+e+"px;")});b.trigger("afterShowData",[e])},setTree:function(d){var b=this,c=this.options;this.clearContent();b.selectBox.table.remove();if(d.checkbox!=false)d.onCheck=function(){var f=b.treeManager.getChecked(),d=[],e=[];a(f).each(function(b,a){if(c.treeLeafOnly&&a.data.children)return;d.push(a.data[c.valueField]);e.push(a.data[c.textField])});b._changeValue(d.join(c.split),e.join(c.split),true)};else{d.onSelect=function(a){if(b.trigger("BeforeSelect",[a])==false)return;if(c.treeLeafOnly&&a.data.children)return;var d=a.data[c.valueField],e=a.data[c.textField];b._changeValue(d,e,true);b.selectBox.hide()};d.onCancelSelect=function(){b._changeValue("","",true)}}d.onAfterAppend=function(){if(!b.treeManager)return;var a=null;if(c.initValue)a=c.initValue;else if(b.valueField.val()!="")a=b.valueField.val();b.selectValueByTree(a)};b.tree=a("<ul></ul>");a("div:first",b.selectBox).append(b.tree);b.innerTree=b.tree.ligerTree(d);b.treeManager=b.tree.ligerGetTreeManager()},getTree:function(){return this.innerTree},selectValueByTree:function(a){var b=this,d=this.options;if(a!=null){var c=b.treeSelectInit(a);b._changeValue(a,c,d.initIsTriggerEvent)}},treeSelectInit:function(d){var e=this,f=this.options;if(d!=null){var b="",c=d.toString().split(f.split);a(c).each(function(d,a){e.treeManager.selectNode(a.toString(),false);b+=e.treeManager.getTextByID(a);if(d<c.length-1)b+=f.split});return b}},setGrid:function(e){var b=this,c=this.options;if(b.grid)return;c.hideOnLoseFocus=c.hideGridOnLoseFocus?true:false;this.clearContent();b.selectBox.addClass("l-box-select-lookup");b.selectBox.table.remove();var k=a("div:first",b.selectBox),f=a("<div></div>").appendTo(k),o=a("<div></div>").appendTo(k);b.conditionPanel=f;if(c.condition){var m=a.extend({labelWidth:60,space:20,width:c.selectBoxWidth},c.condition);b.condition=f.ligerForm(m)}else f.remove();e=a.extend({columnWidth:120,alternatingRow:false,frozen:true,rownumbers:true,allowUnSelectRow:true},e,{width:"100%",height:b.getGridHeight(),inWindow:false,parms:c.parms,isChecked:function(d){var e=b.getValue();return!e?false:!c.valueField||!d[c.valueField]?false:a.inArray(d[c.valueField].toString(),e.split(c.split))!=-1}});b.grid=b.gridManager=o.ligerGrid(e);b.grid.bind("afterShowData",function(){b.updateSelectBoxPosition()});var d=[],g=function(){var f=[],g=[];a(d).each(function(b,a){f.push(a[c.valueField]);g.push(a[c.textField])});if(e.checkbox)b.selected=d;else if(d.length)b.selected=d[0];else b.selected=null;b._changeValue(f.join(c.split),g.join(c.split),true);b.trigger("gridSelect",{value:f.join(c.split),text:g.join(c.split),data:d})},l=function(b){for(var a=d.length-1;a>=0;a--)d[a][c.valueField]==b[c.valueField]&&d.splice(a,1)},n=function(b){for(var a=d.length-1;a>=0;a--)if(d[a][c.valueField]==b[c.valueField])return;d.push(b)};if(e.checkbox){var j=function(a,b){a&&n(b);!a&&l(b)};b.grid.bind("CheckAllRow",function(c){a(b.grid.rows).each(function(b,a){j(c,a)});g()});b.grid.bind("CheckRow",function(a,b){j(a,b);g()})}else{b.grid.bind("SelectRow",function(a){d=[a];g();b._toggleSelectBox(true)});b.grid.bind("UnSelectRow",function(){d=[];g()})}b.bind("show",function(){b.grid.refreshSize()});b.bind("clear",function(){d=[];b.grid.selecteds=[];b.grid._showData()});if(c.condition){var h=a('<li style="margin-right:9px"><div></div></li>'),i=a('<li style="margin-right:9px;float:right"><div></div></li>');a("ul:first",f).append(h).append(i).after('<div class="l-clear"></div>');a("div",h).ligerButton({text:c.Search,width:40,click:function(){var d=b.condition.toConditions();if(c.conditionSearchClick)c.conditionSearchClick({grid:b.grid,rules:d});else if(b.grid.get("url")){b.grid.setParm(e.conditionParmName||"condition",a.ligerui.toJSON(d));b.grid.reload()}else b.grid.loadData(a.ligerFilter.getFilterFunction(d))}});a("div",i).ligerButton({text:"\u5173\u95ed",width:40,click:function(){b.selectBox.hide()}})}b.grid.refreshSize()},getGridHeight:function(a){var b=this,c=this.options;a=a||b.selectBox.height();a-=b.conditionPanel.height();return a},_getValue:function(){var b=this,c=this.options;return c.isTextBoxMode?b.inputText.val():a(this.valueField).val()},getValue:function(){return this._getValue()},getSelected:function(){return this.selected},upFocus:function(){var b=this,f=this.options;if(b.grid){if(!b.grid.rows||!b.grid.rows.length)return;var d=b.grid.getSelected();if(d){var e=a.inArray(d,b.grid.rows);if(e-1<b.grid.rows.length){b.grid.unselect(d);b.grid.select(b.grid.rows[e-1])}}else b.grid.select(b.grid.rows[0])}else{var c=b.selectBox.table.find("td.l-over").attr("index");if(c==undefined||c=="0")return;else c=parseInt(c)-1;b.selectBox.table.find("td.l-over").removeClass("l-over");b.selectBox.table.find("td[index="+c+"]").addClass("l-over");b._scrollAdjust(c)}},downFocus:function(){var b=this,f=this.options;if(b.grid){if(!b.grid.rows||!b.grid.rows.length)return;var d=b.grid.getSelected();if(d){var e=a.inArray(d,b.grid.rows);if(e+1<b.grid.rows.length){b.grid.unselect(d);b.grid.select(b.grid.rows[e+1])}}else b.grid.select(b.grid.rows[0])}else{var c=b.selectBox.table.find("td.l-over").attr("index");if(c==b.data.length-1)return;if(c==undefined)c=0;else c=parseInt(c)+1;b.selectBox.table.find("td.l-over").removeClass("l-over");b.selectBox.table.find("td[index="+c+"]").addClass("l-over");b._scrollAdjust(c)}},_scrollAdjust:function(e){var d=this,i=this.options,b=a(".l-box-select-inner",d.selectBox).height(),c=a(".l-box-select-inner table",d.selectBox).height();if(c<=b)return;var h=parseInt(c/b)+(c%b?1:0),f=c/d.data.length,g=parseInt((e+1)*f/b)+((e+1)*f%b?1:0);a(".l-box-select-inner",d.selectBox).scrollTop((g-1)*b)},getText:function(){return this.inputText.val()},setText:function(a){var b=this,c=this.options;if(c.isTextBoxMode)return;b.inputText.val(a)},updateStyle:function(){var a=this,b=this.options;b.initValue=a._getValue();a._dataInit()},_dataInit:function(){var c=this,d=this.options,b=null;d.initValue!=null&&d.initText!=null&&c._changeValue(d.initValue,d.initText);if(d.initValue!=null){b=d.initValue;if(d.tree)b&&c.selectValueByTree(b);else if(c.data){var e=c.findTextByValue(b);c._changeValue(b,e)}}else if(c.valueField.val()!=""){b=c.valueField.val();if(d.tree)b&&c.selectValueByTree(b);else if(c.data){var e=c.findTextByValue(b);c._changeValue(b,e)}}if(!d.isShowCheckBox)a("table tr",c.selectBox).find("td:first").each(function(){if(b!=null&&b==a(this).attr("value"))a(this).addClass("l-selected");else a(this).removeClass("l-selected")});else a(":checkbox",c.selectBox).each(function(){var c=null,e=a(this);if(e.parent().get(0).tagName.toLowerCase()=="div")c=e.parent().parent();else c=e.parent();if(c==null)return;a(".l-checkbox",c).removeClass("l-checkbox-checked");e[0].checked=false;var f=(b||"").toString().split(d.split);a(f).each(function(f,d){if(b!=null&&d==c.attr("value")){a(".l-checkbox",c).addClass("l-checkbox-checked");e[0].checked=true}})})},_changeValue:function(c,d,g){var b=this,e=this.options;b.valueField.val(c);if(e&&e.render)b.inputText.val(e.render(c,d));else b.inputText.val(d);b.select&&a("option",b.select).each(function(){a(this).attr("selected",a(this).attr("value")==c)});b.selectedValue=c;b.selectedText=d;b.inputText.trigger("change");g&&d&&b.inputText.focus();var f=null;if(c&&typeof c=="string"&&c.indexOf(e.split)>-1){f=[];var h=c.split(e.split);a(h).each(function(c,a){f.push(b.getRow(a))})}else if(c)f=b.getRow(c);g&&b.trigger("selected",[c,d,f])},_checkboxUpdateValue:function(){var d=this,e=this.options,b="",c="";a("input:checked",d.selectBox).each(function(){var d=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div")d=a(this).parent().parent();else d=a(this).parent();if(!d)return;b+=d.attr("value")+e.split;c+=d.attr("text")+e.split});if(b.length>0)b=b.substr(0,b.length-1);if(c.length>0)c=c.substr(0,c.length-1);d._changeValue(b,c)},loadDetail:function(f,d){var g=this,b=this.options,c=a.isFunction(b.detailParms)?b.detailParms.call(g):b.detailParms;c[b.detailPostIdField||"id"]=f;if(b.ajaxContentType=="application/json")c=liger.toJSON(c);var e={type:b.ajaxType,url:b.detailUrl,data:c,cache:true,dataType:"json",beforeSend:b.ajaxBeforeSend,complete:b.ajaxComplete,success:function(e){var c=a.isFunction(b.detailDataGetter)?b.detailDataGetter(e):e;c=b.detailDataParmName?c[b.detailDataParmName]:c;d&&d(c)}};if(b.ajaxContentType)e.contentType=b.ajaxContentType;a.ajax(e)},enabledLoadDetail:function(){var b=this,a=this.options;return a.detailUrl&&a.detailEnabled?true:false},_addClickEven:function(){var b=this,c=this.options;a(".l-table-nocheckbox td",b.selectBox).click(function(){var e=a(this),f=e.attr("value"),d=parseInt(a(this).attr("index")),g=b.data[d],h=e.attr("text"),j=e.parent().hasClass("rowreadonly");if(j)return;if(b.enabledLoadDetail())b.loadDetail(f,function(a){b.data[d]=g=a;i()});else i();function i(){if(b.hasBind("beforeSelect")&&b.trigger("beforeSelect",[f,h,g])==false){if(c.slide)b.selectBox.slideToggle("fast");else b.selectBox.hide();return false}b.selected=g;if(a(this).hasClass("l-selected")){if(c.slide)b.selectBox.slideToggle("fast");else b.selectBox.hide();return}a(".l-selected",b.selectBox).removeClass("l-selected");e.addClass("l-selected");if(b.select)if(b.select[0].selectedIndex!=d){b.select[0].selectedIndex=d;b.select.trigger("change")}if(c.slide){b.boxToggling=true;b.selectBox.hide("fast",function(){b.boxToggling=false})}else b.selectBox.hide();b.lastInputText=h;b._changeValue(f,h,true)}})},updateSelectBoxPosition:function(){var b=this,c=this.options;if(c&&c.absolute){var d=a(document).height();if(c.alwayShowInTop||Number(b.wrapper.offset().top+1+b.wrapper.outerHeight()+b.selectBox.height())>d&&d>Number(b.selectBox.height()+1))b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top-1-b.selectBox.height()+(c.selectBoxPosYDiff||0)});else b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top+1+b.wrapper.outerHeight()+(c.selectBoxPosYDiff||0)});c.alwayShowInDown&&b.selectBox.css({left:b.wrapper.offset().left,top:b.wrapper.offset().top+1+b.wrapper.outerHeight()})}else{var f=b.wrapper.offset().top-a(window).scrollTop(),e=b.selectBox.height()+textHeight+4;f+e>a(window).height()&&f>e&&b.selectBox.css("marginTop",-1*(b.selectBox.height()+textHeight+5)+(c.selectBoxPosYDiff||0))}},_toggleSelectBox:function(g){var b=this,f=this.options;if(!b||!f)return;for(var e=a.ligerui.find(a.ligerui.controls.ComboBox),d=0,h=e.length;d<h;d++){var c=e[d];if(c.id!=b.id)c.selectBox.is(":visible")!=null&&c.selectBox.is(":visible")&&c.selectBox.hide()}e=a.ligerui.find(a.ligerui.controls.DateEditor);for(var d=0,h=e.length;d<h;d++){var c=e[d];if(c.id!=b.id)c.dateeditor.is(":visible")!=null&&c.dateeditor.is(":visible")&&c.dateeditor.hide()}var j=b.wrapper.height();b.boxToggling=true;if(g)if(f.slide)b.selectBox.slideToggle("fast",function(){b.boxToggling=false});else{b.selectBox.hide();b.boxToggling=false}else{b.updateSelectBoxPosition();if(f.slide)b.selectBox.slideToggle("fast",function(){b.boxToggling=false;if(!f.isShowCheckBox&&a("td.l-selected",b.selectBox).length>0){var c=a("td.l-selected",b.selectBox).offset().top-b.selectBox.offset().top;a(".l-box-select-inner",b.selectBox).animate({scrollTop:c})}});else{b._selectBoxShow();b.boxToggling=false;if(!b.tree&&!b.grid&&!f.isShowCheckBox&&a("td.l-selected",b.selectBox).length>0){var i=a("td.l-selected",b.selectBox).offset().top-b.selectBox.offset().top;a(".l-box-select-inner",b.selectBox).animate({scrollTop:i})}}}b.isShowed=b.selectBox.is(":visible");b.trigger("toggle",[g]);b.trigger(g?"hide":"show")},_selectBoxShow:function(){var a=this,b=this.options;if(b.readonly)return;if(!b.grid&&!b.tree){if(a.selectBox.table.find("tr").length||b.selectBoxRender&&a.selectBoxInner.html())a.selectBox.show();else a.selectBox.hide();return}a.selectBox.show();return},_highLight:function(a,c){if(!a)return a;var b=a.indexOf(c);return b==-1?a:a.substring(0,b)+"<span class='l-highLight'>"+c+"</span>"+a.substring(c.length+b)},_setAutocomplete:function(d){var b=this,c=this.options;if(!d)return;if(c.readonly)return;b.inputText.removeAttr("readonly");b.lastInputText=b.inputText.val();b.inputText.keyup(function(e){if(e.keyCode==38||e.keyCode==40||e.keyCode==13)return;this._acto&&clearTimeout(this._acto);this._acto=setTimeout(function(){if(b.lastInputText==b.inputText.val())return;var e=b.inputText.val();if(e)e=e.replace(/(^\s*)|(\s*$)/g,"");else{c.initValue="";b.valueField.val("")}b.lastInputText=b.inputText.val();if(a.isFunction(d)){d.call(b,{key:e,show:function(){b._selectBoxShow()}});return}if(!c.autocompleteAllowEmpty&&!e){b.clear();b.selectBox.hide();return}if(c.url){b.setParm("key",e);b.setUrl(c.url,function(){b._selectBoxShow()})}else if(c.grid){b.grid.setParm("key",e);b.grid.reload()}this._acto=null},300)})}});a.ligerui.controls.ComboBox.prototype.setValue=a.ligerui.controls.ComboBox.prototype.selectValue;a.ligerui.controls.ComboBox.prototype.setInputValue=a.ligerui.controls.ComboBox.prototype._changeValue;(function(){a(document).unbind("keydown.ligercombobox");a(document).bind("keydown.ligercombobox",function(g){function j(){!b.selectBox.is(":visible")&&b.selectBox.show();b.downFocus()}function i(){if(!c){b._changeValue(e,d.attr("text"),true);b.selectBox.hide();b.trigger("textBoxKeyEnter",[{element:d.get(0)}])}else{b._changeValue(c[h.valueField],c[h.textField],true);b.selectBox.hide();b.trigger("textBoxKeyEnter",[{rowdata:c}])}}var f=a("input:focus");if(f.length&&f.attr("data-comboboxid")){var b=liger.get(f.attr("data-comboboxid"));if(!b)return;var h=b.options;if(!b.get("keySupport"))return;if(g.keyCode==38)b.upFocus();else if(g.keyCode==40)if(b.hasBind("textBoxKeyDown"))b.trigger("textBoxKeyDown",[{callback:function(){j()}}]);else j();else if(g.keyCode==13){if(!b.selectBox.is(":visible"))return;var c=null;if(b.grid)c=b.grid.getSelected();var d=b.selectBox.table.find("td.l-over");if(c||d.length){var e=d.attr("value");if(c&&c.ID)e=c.ID;if(b.enabledLoadDetail())b.loadDetail(e,function(d){if(!c){var a=b.getRowIndex(e);if(a==-1)return;b.data=b.data||[];b.data[a]=b.selected=d}i()});else i()}}}})})()})(jQuery);(function(a){a.fn.ligerDateEditor=function(){return a.ligerui.run.call(this,"ligerDateEditor",arguments)};a.fn.ligerGetDateEditorManager=function(){return a.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)};a.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",width:null,showTime:false,onChangeDate:false,absolute:true,cancelable:true,readonly:false};a.ligerDefaults.DateEditorString={dayMessage:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],monthMessage:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],todayMessage:"\u4eca\u5929",closeMessage:"\u5173\u95ed"};a.ligerMethos.DateEditor={};a.ligerui.controls.DateEditor=function(b,c){a.ligerui.controls.DateEditor.base.constructor.call(this,b,c)};a.ligerui.controls.DateEditor.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return a.ligerMethos.DateEditor},_render:function(){var b=this,d=this.options;if(!d.showTime&&d.format.indexOf(" hh:mm")>-1)d.format=d.format.replace(" hh:mm","");if(this.element.tagName.toLowerCase()!="input"||this.element.type!="text")return;b.inputText=a(this.element);!b.inputText.hasClass("l-text-field")&&b.inputText.addClass("l-text-field");b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');b.text=b.inputText.wrap('<div class="l-text l-text-date"></div>').parent();b.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.text.append(b.link);b.textwrapper=b.text.wrap('<div class="l-text-wrapper"></div>').parent();var c="";c+="<div class='l-box-dateeditor' style='display:none'>";c+="    <div class='l-box-dateeditor-header'>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>";c+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>";c+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>";c+="    </div>";c+="    <div class='l-box-dateeditor-body'>";c+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>";c+="            <thead>";c+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";c+="            </thead>";c+="            <tbody>";c+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";c+="            </tbody>";c+="        </table>";c+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";c+="    </div>";c+="    <div class='l-box-dateeditor-toolbar'>";c+="        <div class='l-box-dateeditor-time'></div>";c+="        <div class='l-button l-button-today'></div>";c+="        <div class='l-button l-button-close'></div>";c+="        <div class='l-clear'></div>";c+="    </div>";c+="</div>";b.dateeditor=a(c);if(d.absolute)b.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute");else b.textwrapper.append(b.dateeditor);b.header=a(".l-box-dateeditor-header",b.dateeditor);b.body=a(".l-box-dateeditor-body",b.dateeditor);b.toolbar=a(".l-box-dateeditor-toolbar",b.dateeditor);b.body.thead=a("thead",b.body);b.body.tbody=a("tbody",b.body);b.body.monthselector=a(".l-box-dateeditor-monthselector",b.body);b.body.yearselector=a(".l-box-dateeditor-yearselector",b.body);b.body.hourselector=a(".l-box-dateeditor-hourselector",b.body);b.body.minuteselector=a(".l-box-dateeditor-minuteselector",b.body);b.toolbar.time=a(".l-box-dateeditor-time",b.toolbar);b.toolbar.time.hour=a("<a></a>");b.toolbar.time.minute=a("<a></a>");b.buttons={btnPrevYear:a(".l-box-dateeditor-header-prevyear",b.header),btnNextYear:a(".l-box-dateeditor-header-nextyear",b.header),btnPrevMonth:a(".l-box-dateeditor-header-prevmonth",b.header),btnNextMonth:a(".l-box-dateeditor-header-nextmonth",b.header),btnYear:a(".l-box-dateeditor-header-year",b.header),btnMonth:a(".l-box-dateeditor-header-month",b.header),btnToday:a(".l-button-today",b.toolbar),btnClose:a(".l-button-close",b.toolbar)};var e=new Date;b.now={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()};b.currentDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay(),date:e.getDate(),hour:e.getHours(),minute:e.getMinutes()};b.selectedDate=null;b.usedDate=null;a("td",b.body.thead).each(function(c,b){a(b).html(d.dayMessage[c])});a("li",b.body.monthselector).each(function(c,b){a(b).html(d.monthMessage[c])});b.buttons.btnToday.html(d.todayMessage);b.buttons.btnClose.html(d.closeMessage);if(d.showTime){b.toolbar.time.show();b.toolbar.time.append(b.toolbar.time.hour).append(":").append(b.toolbar.time.minute);a("li",b.body.hourselector).each(function(b){var c=b;if(b<10)c="0"+b.toString();a(this).html(c)});a("li",b.body.minuteselector).each(function(b){var c=b;if(b<10)c="0"+b.toString();a(this).html(c)})}b.bulidContent();d.initValue&&b.inputText.val(d.initValue);b.inputText.val()!=""&&b.onTextChange();b.dateeditor.hover(null,function(){b.dateeditor.is(":visible")&&!b.editorToggling&&b.toggleDateEditor(true)});b.link.hover(function(){if(d.disabled)return;this.className="l-trigger-hover"},function(){if(d.disabled)return;this.className="l-trigger"}).mousedown(function(){if(d.disabled)return;this.className="l-trigger-pressed"}).mouseup(function(){if(d.disabled)return;this.className="l-trigger-hover"}).click(function(){if(d.disabled)return;b.bulidContent();b.toggleDateEditor(b.dateeditor.is(":visible"))});if(d.disabled){b.inputText.attr("readonly","readonly");b.text.addClass("l-text-disabled")}b.buttons.btnClose.click(function(){b.toggleDateEditor(true)});a("td",b.body.tbody).hover(function(){if(a(this).hasClass("l-box-dateeditor-today"))return;a(this).addClass("l-box-dateeditor-over")},function(){a(this).removeClass("l-box-dateeditor-over")}).click(function(){a(".l-box-dateeditor-selected",b.body.tbody).removeClass("l-box-dateeditor-selected");!a(this).hasClass("l-box-dateeditor-today")&&a(this).addClass("l-box-dateeditor-selected");b.currentDate.date=parseInt(a(this).html());b.currentDate.day=(new Date(b.currentDate.year,b.currentDate.month-1,1)).getDay();if(a(this).hasClass("l-box-dateeditor-out"))if(a("tr",b.body.tbody).index(a(this).parent())==0){if(--b.currentDate.month==0){b.currentDate.month=12;b.currentDate.year--}}else if(++b.currentDate.month==13){b.currentDate.month=1;b.currentDate.year++}b.selectedDate={year:b.currentDate.year,month:b.currentDate.month,date:b.currentDate.date};b.showDate();b.editorToggling=true;b.dateeditor.slideToggle("fast",function(){b.editorToggling=false})});a(".l-box-dateeditor-header-btn",b.header).hover(function(){a(this).addClass("l-box-dateeditor-header-btn-over")},function(){a(this).removeClass("l-box-dateeditor-header-btn-over")});b.buttons.btnYear.click(function(){!b.body.yearselector.is(":visible")&&a("li",b.body.yearselector).each(function(d){var c=b.currentDate.year+(d-4);if(c==b.currentDate.year)a(this).addClass("l-selected");else a(this).removeClass("l-selected");a(this).html(c)});b.body.yearselector.slideToggle()});b.body.yearselector.hover(function(){},function(){a(this).slideUp()});a("li",b.body.yearselector).click(function(){b.currentDate.year=parseInt(a(this).html());b.body.yearselector.slideToggle();b.bulidContent()});b.buttons.btnMonth.click(function(){a("li",b.body.monthselector).each(function(c){if(b.currentDate.month==c+1)a(this).addClass("l-selected");else a(this).removeClass("l-selected")});b.body.monthselector.slideToggle()});b.body.monthselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",b.body.monthselector).click(function(){var c=a("li",b.body.monthselector).index(this);b.currentDate.month=c+1;b.body.monthselector.slideToggle();b.bulidContent()});b.toolbar.time.hour.click(function(){a("li",b.body.hourselector).each(function(c){if(b.currentDate.hour==c)a(this).addClass("l-selected");else a(this).removeClass("l-selected")});b.body.hourselector.slideToggle()});b.body.hourselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",b.body.hourselector).click(function(){var c=a("li",b.body.hourselector).index(this);b.currentDate.hour=c;b.body.hourselector.slideToggle();b.bulidContent();b.showDate()});b.toolbar.time.minute.click(function(){a("li",b.body.minuteselector).each(function(c){if(b.currentDate.minute==c)a(this).addClass("l-selected");else a(this).removeClass("l-selected")});b.body.minuteselector.slideToggle("fast",function(){var c=a("li",this).index(a("li.l-selected",this));if(c>29){var b=a("li.l-selected",this).offset().top-a(this).offset().top;a(this).animate({scrollTop:b})}})});b.body.minuteselector.hover(function(){},function(){a(this).slideUp("fast")});a("li",b.body.minuteselector).click(function(){var c=a("li",b.body.minuteselector).index(this);b.currentDate.minute=c;b.body.minuteselector.slideToggle("fast");b.bulidContent();b.showDate()});b.buttons.btnPrevMonth.click(function(){if(--b.currentDate.month==0){b.currentDate.month=12;b.currentDate.year--}b.bulidContent()});b.buttons.btnNextMonth.click(function(){if(++b.currentDate.month==13){b.currentDate.month=1;b.currentDate.year++}b.bulidContent()});b.buttons.btnPrevYear.click(function(){b.currentDate.year--;b.bulidContent()});b.buttons.btnNextYear.click(function(){b.currentDate.year++;b.bulidContent()});b.buttons.btnToday.click(function(){b.currentDate={year:b.now.year,month:b.now.month,day:b.now.day,date:b.now.date};b.selectedDate={year:b.now.year,month:b.now.month,day:b.now.day,date:b.now.date};b.showDate();b.dateeditor.slideToggle("fast")});b.inputText.change(function(){b.onTextChange()}).blur(function(){b.text.removeClass("l-text-focus")}).focus(function(){b.text.addClass("l-text-focus")});b.text.hover(function(){b.text.addClass("l-text-over")},function(){b.text.removeClass("l-text-over")});if(d.label){b.labelwrapper=b.textwrapper.wrap('<div class="l-labeltext"></div>').parent();b.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+d.label+":&nbsp</div>");b.textwrapper.css("float","left");if(!d.labelWidth)d.labelWidth=a(".l-text-label",b.labelwrapper).outerWidth();else a(".l-text-label",b.labelwrapper).outerWidth(d.labelWidth);a(".l-text-label",b.labelwrapper).width(d.labelWidth);a(".l-text-label",b.labelwrapper).height(b.text.height());b.labelwrapper.append('<br style="clear:both;" />');d.labelAlign&&a(".l-text-label",b.labelwrapper).css("text-align",d.labelAlign);b.textwrapper.css({display:"inline"});b.labelwrapper.width(b.text.outerWidth()+d.labelWidth+2)}b.set(d);a(document).bind("click.dateeditor",function(c){b.dateeditor.is(":visible")&&a(c.target||c.srcElement).closest(".l-box-dateeditor, .l-text-date").length==0&&b.toggleDateEditor(true)})},destroy:function(){this.textwrapper&&this.textwrapper.remove();this.dateeditor&&this.dateeditor.remove();this.options=null;a.ligerui.remove(this)},bulidContent:function(){var b=this,h=this.options,f=(new Date(b.currentDate.year,b.currentDate.month-1,1)).getDay(),c=b.currentDate.month,e=b.currentDate.year;if(++c==13){c=1;e++}var d=(new Date(e,c-1,0)).getDate(),g=(new Date(b.currentDate.year,b.currentDate.month-1,0)).getDate();b.buttons.btnMonth.html(h.monthMessage[b.currentDate.month-1]);b.buttons.btnYear.html(b.currentDate.year);b.toolbar.time.hour.html(b.currentDate.hour);b.toolbar.time.minute.html(b.currentDate.minute);b.toolbar.time.hour.html().length==1&&b.toolbar.time.hour.html("0"+b.toolbar.time.hour.html());b.toolbar.time.minute.html().length==1&&b.toolbar.time.minute.html("0"+b.toolbar.time.minute.html());a("td",this.body.tbody).each(function(){this.className=""});a("tr",this.body.tbody).each(function(e,c){a("td",c).each(function(h,c){var j=e*7+(h-f),i=j+1;if(b.selectedDate&&b.currentDate.year==b.selectedDate.year&&b.currentDate.month==b.selectedDate.month&&j+1==b.selectedDate.date){(h==0||h==6)&&a(c).addClass("l-box-dateeditor-holiday");a(c).addClass("l-box-dateeditor-selected");a(c).siblings().removeClass("l-box-dateeditor-selected")}else if(b.currentDate.year==b.now.year&&b.currentDate.month==b.now.month&&j+1==b.now.date){(h==0||h==6)&&a(c).addClass("l-box-dateeditor-holiday");a(c).addClass("l-box-dateeditor-today")}else if(j<0){i=g+i;a(c).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else if(j>d-1){i=i-d;a(c).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else if(h==0||h==6)a(c).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected");else c.className="";a(c).html(i)})})},updateSelectBoxPosition:function(){var b=this,d=this.options;if(d.absolute){var c=a(document).height();if(Number(b.text.offset().top+1+b.text.outerHeight()+b.dateeditor.height())>c&&c>Number(b.dateeditor.height()+1))b.dateeditor.css({left:b.text.offset().left,top:b.text.offset().top-1-b.dateeditor.height()});else b.dateeditor.css({left:b.text.offset().left,top:b.text.offset().top+1+b.text.outerHeight()})}else if(b.text.offset().top+4>b.dateeditor.height()&&b.text.offset().top+b.dateeditor.height()+textHeight+4-a(window).scrollTop()>a(window).height()){b.dateeditor.css("marginTop",-1*(b.dateeditor.height()+textHeight+5));b.showOnTop=true}else b.showOnTop=false},toggleDateEditor:function(g){for(var b=this,i=this.options,e=a.ligerui.find(a.ligerui.controls.ComboBox),d=0,f=e.length;d<f;d++){var c=e[d];if(c.id!=b.id)c.selectBox.is(":visible")!=null&&c.selectBox.is(":visible")&&c.selectBox.hide()}e=a.ligerui.find(a.ligerui.controls.DateEditor);for(var d=0,f=e.length;d<f;d++){var c=e[d];if(c.id!=b.id)c.dateeditor.is(":visible")!=null&&c.dateeditor.is(":visible")&&c.dateeditor.hide()}var h=b.text.height();b.editorToggling=true;if(g)b.dateeditor.hide("fast",function(){b.editorToggling=false});else{b.updateSelectBoxPosition();b.dateeditor.slideDown("fast",function(){b.editorToggling=false})}},showDate:function(){var b=this,d=this.options;if(!this.currentDate)return;this.currentDate.hour=parseInt(b.toolbar.time.hour.html(),10);this.currentDate.minute=parseInt(b.toolbar.time.minute.html(),10);var a=this.currentDate.year+"/"+this.currentDate.month+"/"+this.currentDate.date+" "+this.currentDate.hour+":"+this.currentDate.minute,c=new Date(a);a=b.getFormatDate(c);this.inputText.val(a);this.onTextChange()},isDateTime:function(c){var d=this,e=this.options,a=c.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(a==null)return false;var b=new Date(a[1],a[3]-1,a[4]);return b=="NaN"?false:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]},isLongDateTime:function(c){var e=this,f=this.options,d=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/,a=c.match(d);if(a==null)return false;var b=new Date(a[1],a[3]-1,a[4],a[5],a[6]);return b=="NaN"?false:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]&&b.getHours()==a[5]&&b.getMinutes()==a[6]},getFormatDate:function(a){if(a===null||a=="NaN")return null;var f=this,e=this.options,b=e.format,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};if(/(y+)/.test(b))b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length));for(var c in d)if((new RegExp("("+c+")")).test(b))b=b.replace(RegExp.$1,RegExp.$1.length==1?d[c]:("00"+d[c]).substr((""+d[c]).length));return b},clear:function(){this.set("value","");this.usedDate=null},_setCancelable:function(d){var b=this,c=this.options;if(!d&&b.unselect){b.unselect.remove();b.unselect=null}if(!d&&!b.unselect)return;b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.text.hover(function(){b.unselect.show()},function(){b.unselect.hide()});!c.disabled&&c.cancelable&&b.text.append(b.unselect);b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){if(c.readonly)return;b.clear()})},_rever:function(){var a=this,b=this.options;if(!a.usedDate)a.inputText.val("");else a.inputText.val(a.getFormatDate(a.usedDate))},_getMatch:function(i){var h=[-1,-1,-1,-1,-1,-1],f=0,a="^",b=i||this.options.format;while(true){var d=b.match(/^yyyy|MM|dd|mm|hh|HH|ss|-|\/|:|\s/);if(d){var e=d[0].charAt(0),c=d[0].length,g="yMdhms".indexOf(e);if(g!=-1){h[g]=f+1;a+="(\\d{1,"+c+"})"}else{var j=e==" "?"\\s":e;a+="("+j+")"}f++;if(c==b.length){a+="$";break}b=b.substring(c)}else return null}return{reg:new RegExp(a),position:h}},_bulidDate:function(e){var g=this,f=this.options,b=this._getMatch();if(!b)return null;var c=e.match(b.reg);if(!c)return null;var a={y:b.position[0]==-1?1900:c[b.position[0]],M:b.position[1]==-1?0:parseInt(c[b.position[1]],10)-1,d:b.position[2]==-1?1:parseInt(c[b.position[2]],10),h:b.position[3]==-1?0:parseInt(c[b.position[3]],10),m:b.position[4]==-1?0:parseInt(c[b.position[4]],10),s:b.position[5]==-1?0:parseInt(c[b.position[5]],10)};if(a.M<0||a.M>11||a.d<0||a.d>31)return null;var d=new Date(a.y,a.M,a.d);if(f.showTime){if(a.m<0||a.m>59||a.h<0||a.h>23||a.s<0||a.s>59)return null;d.setHours(a.h);d.setMinutes(a.m);d.setSeconds(a.s)}return d},updateStyle:function(){this.onTextChange()},onTextChange:function(){var b=this,f=this.options,e=b.inputText.val();if(!e){b.selectedDate=null;return true}var c=b._bulidDate(e);if(!c){b._rever();return}else b.usedDate=c;b.selectedDate={year:b.usedDate.getFullYear(),month:b.usedDate.getMonth()+1,day:b.usedDate.getDay(),date:b.usedDate.getDate(),hour:b.usedDate.getHours(),minute:b.usedDate.getMinutes()};b.currentDate={year:b.usedDate.getFullYear(),month:b.usedDate.getMonth()+1,day:b.usedDate.getDay(),date:b.usedDate.getDate(),hour:b.usedDate.getHours(),minute:b.usedDate.getMinutes()};var d=b.getFormatDate(c);b.inputText.val(d);b.trigger("changeDate",[d]);a(b.dateeditor).is(":visible")&&b.bulidContent()},_setHeight:function(a){var b=this;if(a>4){b.text.css({height:a});b.inputText.css({height:a});b.textwrapper.css({height:a})}},_setWidth:function(a){var b=this;if(a>20){b.text.css({width:a});b.inputText.css({width:a-20});b.textwrapper.css({width:a})}},_setValue:function(a){var b=this;!a&&b.inputText.val("");if(typeof a=="string"){if(/^\/Date/.test(a)){a=a.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+a)}b.inputText.val(a);b.usedDate=a}if(typeof a=="object")if(a instanceof Date){b.inputText.val(b.getFormatDate(a));b.onTextChange()}},_getValue:function(){return this.usedDate},setEnabled:function(){var b=this,a=this.options;this.inputText.removeAttr("readonly");this.text.removeClass("l-text-disabled");a.disabled=false},setDisabled:function(){var b=this,a=this.options;this.inputText.attr("readonly","readonly");this.text.addClass("l-text-disabled");a.disabled=true}})})(jQuery);(function(a){var b=a.ligerui;a(".l-dialog-btn").live("mouseover",function(){a(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-btn-over")});a(".l-dialog-tc .l-dialog-close").live("mouseover",function(){a(this).addClass("l-dialog-close-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-close-over")});a.ligerDialog=function(){return b.run.call(null,"ligerDialog",arguments,{isStatic:true})};a.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/";a.ligerDefaults.Dialog={cls:null,contentCls:null,id:null,buttons:null,isDrag:true,width:280,height:null,content:"",target:null,url:null,urlParms:null,load:false,type:"none",left:null,top:null,modal:true,data:null,name:null,isResize:false,allowClose:true,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:true,show:true,title:"\u63d0\u793a",showMax:false,showToggle:false,showMin:false,slide:a.browser.msie?false:true,fixedType:null,showType:null,layoutMode:1,onLoaded:null,onExtend:null,onExtended:null,onCollapse:null,onCollapseed:null,onContentHeightChange:null,onClose:null,onClosed:null,onStopResize:null,minIsHide:false};a.ligerDefaults.DialogString={titleMessage:"\u63d0\u793a",ok:"\u786e\u5b9a",yes:"\u662f",no:"\u5426",cancel:"\u53d6\u6d88",waittingMessage:"\u6b63\u5728\u7b49\u5f85\u4e2d,\u8bf7\u7a0d\u5019..."};a.ligerMethos.Dialog=a.ligerMethos.Dialog||{};b.controls.Dialog=function(a){b.controls.Dialog.base.constructor.call(this,null,a)};b.controls.Dialog.ligerExtend(b.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return a.ligerMethos.Dialog},_render:function(){var c=this,d=this.options,f="";c.set(d,true);var h=a('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');a("body").append(h);c.dialog=h;d.layoutMode==2&&h.find("td.l-dialog-tl,td.l-dialog-cl,td.l-dialog-bl,td.l-dialog-tr,td.l-dialog-cr,td.l-dialog-br").remove();c.element=h[0];c.dialog.body=a(".l-dialog-body:first",c.dialog);c.dialog.header=a(".l-dialog-tc-inner:first",c.dialog);c.dialog.winbtns=a(".l-dialog-winbtns:first",c.dialog.header);c.dialog.buttons=a(".l-dialog-buttons:first",c.dialog);c.dialog.content=a(".l-dialog-content:first",c.dialog);c.set(d,false);d.allowClose==false&&a(".l-dialog-close",c.dialog).remove();if(d.target||d.url||d.type=="none"){d.type=null;c.dialog.addClass("l-dialog-win")}d.cls&&c.dialog.addClass(d.cls);d.id&&c.dialog.attr("id",d.id);c.mask();d.isDrag&&c._applyDrag();d.isResize&&c._applyResize();if(d.type)c._setImage();else{a(".l-dialog-image",c.dialog).remove();c.dialog.content.addClass("l-dialog-content-noimage")}d.contentCls&&c.dialog.content.addClass(d.contentCls);if(!d.show){c.unmask();c.dialog.hide()}if(d.target){c.dialog.content.prepend(d.target);a(d.target).show()}else if(d.url){var g=a.isFunction(d.url)?d.url.call(c):d.url,e=a.isFunction(d.urlParms)?d.urlParms.call(c):d.urlParms;if(d.timeParmName){e=e||{};e[d.timeParmName]=(new Date).getTime()}if(e)for(var k in e){g+=g.indexOf("?")==-1?"?":"&";g+=k+"="+e[k]}if(d.load)c.dialog.body.load(g,function(){c._saveStatus();c.trigger("loaded")});else{c.jiframe=a("<iframe frameborder='0'></iframe>");var i=d.name?d.name:"ligerwindow"+(new Date).getTime();c.jiframe.attr("name",i);c.jiframe.attr("id",i);c.dialog.content.prepend(c.jiframe);c.dialog.content.addClass("l-dialog-content-nopadding l-dialog-content-frame");setTimeout(function(){c.dialog.body.find(".l-dialog-loading:first").length==0&&c.dialog.body.append("<div class='l-dialog-loading' style='display:block;'></div>");var b=a(".l-dialog-loading:first",c.dialog.body);c.jiframe[0].dialog=c;c.jiframe.attr("src",g).bind("load.dialog",function(){b.hide();c.trigger("loaded")});c.frame=window.frames[c.jiframe.attr("name")]},0);f="jquery_ligerui_"+(new Date).getTime();c.tmpInput=a("<input></input>");c.tmpInput.attr("id",f);c.dialog.content.prepend(c.tmpInput)}}if(d.opener)c.dialog.opener=d.opener;if(d.buttons)a(d.buttons).each(function(e,b){var d=a('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');a(".l-dialog-btn-inner",d).html(b.text);a(".l-dialog-buttons-inner",c.dialog.buttons).prepend(d);b.width&&d.width(b.width);b.onclick&&d.click(function(){b.onclick(b,c,e)});b.cls&&d.addClass(b.cls)});else c.dialog.buttons.remove();a(".l-dialog-buttons-inner",c.dialog.buttons).append("<div class='l-clear'></div>");a(".l-dialog-title",c.dialog).bind("selectstart",function(){return false});c.dialog.click(function(){b.win.setFront(c)});a(".l-dialog-tc .l-dialog-close",c.dialog).click(function(){if(d.isHidden)c.hide();else c.close()});if(!d.fixedType)if(d.width=="auto")setTimeout(function(){j()},100);else j();function j(){var b=0,e=0,f=d.width||c.dialog.width();if(d.slide==true)d.slide="fast";if(d.left!=null)b=d.left;else d.left=b=.5*(a(window).width()-f);if(d.top!=null)e=d.top;else d.top=e=.5*(a(window).height()-c.dialog.height())+a(window).scrollTop()-10;if(b<0)d.left=b=0;if(e<0)d.top=e=0;c.dialog.css({left:b,top:e})}c.show();a("body").bind("keydown.dialog",function(b){var a=b.which;if(a==13)c.enter();else a==27&&c.esc()});c._updateBtnsWidth();c._saveStatus();c._onReisze();if(f!=""){a("#"+f).focus();a("#"+f).remove()}},_borderX:12,_borderY:32,doMax:function(i){var c=this,f=this.options,g=a(window).width(),d=a(window).height(),h=0,e=0;if(b.win.taskbar){d-=b.win.taskbar.outerHeight();if(b.win.top)e+=b.win.taskbar.outerHeight()}if(i){c.dialog.body.animate({width:g-c._borderX},f.slide);c.dialog.animate({left:h,top:e},f.slide);c.dialog.content.animate({height:d-c._borderY-c.dialog.buttons.outerHeight()},f.slide,function(){c._onReisze()})}else{c.set({width:g,height:d,left:h,top:e});c._onReisze()}},max:function(){var b=this,c=this.options;if(b.winmax){b.winmax.addClass("l-dialog-recover");b.doMax(c.slide);if(b.wintoggle)if(b.wintoggle.hasClass("l-dialog-extend"))b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled");else b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled");b.resizable&&b.resizable.set({disabled:true});b.draggable&&b.draggable.set({disabled:true});b.maximum=true;a(window).bind("resize.dialogmax",function(){b.doMax(false)})}},recover:function(){var b=this,c=this.options;if(b.winmax){b.winmax.removeClass("l-dialog-recover");if(c.slide){b.dialog.body.animate({width:b._width-b._borderX},c.slide);b.dialog.animate({left:b._left,top:b._top},c.slide);b.dialog.content.animate({height:b._height-b._borderY-b.dialog.buttons.outerHeight()},c.slide,function(){b._onReisze()})}else{b.set({width:b._width,height:b._height,left:b._left,top:b._top});b._onReisze()}b.wintoggle&&b.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled");a(window).unbind("resize.dialogmax")}this.resizable&&this.resizable.set({disabled:false});b.draggable&&b.draggable.set({disabled:false});b.maximum=false},min:function(){var c=this,d=this.options;if(d.minIsHide)c.dialog.hide();else{var a=b.win.getTask(this);if(d.slide){c.dialog.body.animate({width:1},d.slide);a.y=a.offset().top+a.height();a.x=a.offset().left+a.width()/2;c.dialog.animate({left:a.x,top:a.y},d.slide,function(){c.dialog.hide()})}else c.dialog.hide()}c.unmask();c.minimize=true;c.actived=false},active:function(){var c=this,h=this.options;if(c.minimize){var f=c._width,e=c._height,g=c._left,d=c._top;if(c.maximum){f=a(window).width();e=a(window).height();g=d=0;if(b.win.taskbar){e-=b.win.taskbar.outerHeight();if(b.win.top)d+=b.win.taskbar.outerHeight()}}if(h.slide){c.dialog.body.animate({width:f-c._borderX},h.slide);c.dialog.animate({left:g,top:d},h.slide)}else c.set({width:f,height:e,left:g,top:d})}c.actived=true;c.minimize=false;b.win.setFront(c);c.show()},toggle:function(){var a=this,b=this.options;if(!a.wintoggle)return;if(a.wintoggle.hasClass("l-dialog-extend"))a.extend();else a.collapse()},collapse:function(c){var a=this,b=this.options;if(!a.wintoggle)return;if(b.slide&&c!=false)a.dialog.content.animate({height:1},b.slide);else a.dialog.content.height(1);this.resizable&&this.resizable.set({disabled:true});a.wintoggle.addClass("l-dialog-extend")},extend:function(){var a=this,c=this.options;if(!a.wintoggle)return;var b=a._height-a._borderY-a.dialog.buttons.outerHeight();if(c.slide)a.dialog.content.animate({height:b},c.slide);else a.dialog.content.height(b);this.resizable&&this.resizable.set({disabled:false});a.wintoggle.removeClass("l-dialog-extend")},_updateBtnsWidth:function(){var b=this,c=a(">div",b.dialog.winbtns).length;b.dialog.winbtns.width(22*c)},_setLeft:function(a){if(!this.dialog)return;a!=null&&this.dialog.css({left:a})},_setTop:function(a){if(!this.dialog)return;a!=null&&this.dialog.css({top:a})},_setWidth:function(a){if(!this.dialog)return;a>=this._borderX&&this.dialog.body.width(a-this._borderX)},_setHeight:function(c){var a=this,d=this.options;if(!this.dialog)return;if(c=="auto")a.dialog.content.height("auto");else if(c>=this._borderY){var b=c-this._borderY-a.dialog.buttons.outerHeight();if(a.trigger("ContentHeightChange",[b])==false)return;if(d.load)a.dialog.body.height(b);else a.dialog.content.height(b);a.trigger("ContentHeightChanged",[b])}},_setShowMax:function(c){var b=this,d=this.options;if(c){if(!b.winmax)b.winmax=a('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(b.dialog.winbtns).hover(function(){if(a(this).hasClass("l-dialog-recover"))a(this).addClass("l-dialog-recover-over");else a(this).addClass("l-dialog-max-over")},function(){a(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){if(a(this).hasClass("l-dialog-recover"))b.recover();else b.max()})}else if(b.winmax){b.winmax.remove();b.winmax=null}b._updateBtnsWidth()},_setShowMin:function(d){var c=this,e=this.options;if(d){if(!c.winmin){c.winmin=a('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(c.dialog.winbtns).hover(function(){a(this).addClass("l-dialog-min-over")},function(){a(this).removeClass("l-dialog-min-over")}).click(function(){c.min()});!e.minIsHide&&b.win.addTask(c)}}else if(c.winmin){c.winmin.remove();c.winmin=null}c._updateBtnsWidth()},_setShowToggle:function(c){var b=this,d=this.options;if(c){if(!b.wintoggle)b.wintoggle=a('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(b.dialog.winbtns).hover(function(){if(a(this).hasClass("l-dialog-toggle-disabled"))return;if(a(this).hasClass("l-dialog-extend"))a(this).addClass("l-dialog-extend-over");else a(this).addClass("l-dialog-collapse-over")},function(){a(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(a(this).hasClass("l-dialog-toggle-disabled"))return;if(b.wintoggle.hasClass("l-dialog-extend")){if(b.trigger("extend")==false)return;b.wintoggle.removeClass("l-dialog-extend");b.extend();b.trigger("extended")}else{if(b.trigger("collapse")==false)return;b.wintoggle.addClass("l-dialog-extend");b.collapse();b.trigger("collapseed")}})}else if(b.wintoggle){b.wintoggle.remove();b.wintoggle=null}},enter:function(){var c=this,a=this.options,b;if(a.closeWhenEnter!=undefined)b=a.closeWhenEnter;else if(a.type=="warn"||a.type=="error"||a.type=="success"||a.type=="question")b=true;b&&c.close()},esc:function(){},_removeDialog:function(){var b=this,c=this.options;if(c.showType&&c.fixedType)b.dialog.animate({bottom:-1*c.height},function(){d()});else d();function d(){var d=a("iframe",b.dialog);if(d.length){var c=d[0];c.src="about:blank";if(c.contentWindow&&c.contentWindow.document)try{c.contentWindow.document.write("")}catch(e){}a.browser.msie&&CollectGarbage();d.remove()}b.dialog.remove()}},close:function(){var a=this,b=this.options;if(a.trigger("Close")==false)return;a.doClose();if(a.trigger("Closed")==false)return void 0},doClose:function(){var c=this;b.win.removeTask(this);a.ligerui.remove(this);c.unmask();c._removeDialog();a("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(c){var a=this,b=this.options;b.url=c;if(b.load)a.dialog.body.html("").load(b.url,function(){a.trigger("loaded")});else a.jiframe&&a.jiframe.attr("src",b.url)},_setContent:function(a){this.dialog.content.html(a)},_setTitle:function(b){var c=this,d=this.options;b&&a(".l-dialog-title",c.dialog).html(b)},_hideDialog:function(){var a=this,b=this.options;if(b.showType&&b.fixedType)a.dialog.animate({bottom:-1*b.height},function(){a.dialog.hide()});else a.dialog.hide()},hidden:function(){var a=this;b.win.removeTask(a);a.dialog.hide();a.unmask()},show:function(){var b=this,c=this.options;b.mask();if(c.fixedType)if(c.showType){b.dialog.css({bottom:-1*c.height}).addClass("l-dialog-fixed");b.dialog.show().animate({bottom:0})}else b.dialog.show().css({bottom:0}).addClass("l-dialog-fixed");else b.dialog.show();a.ligerui.win.setFront.ligerDefer(a.ligerui.win,100,[b])},setUrl:function(a){this._setUrl(a)},_saveStatus:function(){var a=this;a._width=a.dialog.body.width();a._height=a.dialog.body.height();var c=0,b=0;if(!isNaN(parseInt(a.dialog.css("top"))))c=parseInt(a.dialog.css("top"));if(!isNaN(parseInt(a.dialog.css("left"))))b=parseInt(a.dialog.css("left"));a._top=c;a._left=b},_applyDrag:function(){var c=this,d=this.options;if(a.fn.ligerDrag)c.draggable=c.dialog.ligerDrag({handler:".l-dialog-title",animate:false,onStartDrag:function(){b.win.setFront(c);var d=a("<div class='l-dragging-mask' style='display:block'></div>").height(c.dialog.height());c.dialog.append(d);c.dialog.content.addClass("l-dialog-content-dragging")},onDrag:function(c,a){var b=a.pageY||a.screenY;if(b<0)return false},onStopDrag:function(){c.dialog.find("div.l-dragging-mask:first").remove();c.dialog.content.removeClass("l-dialog-content-dragging");if(d.target){var e=b.find(a.ligerui.controls.DateEditor),f=b.find(a.ligerui.controls.ComboBox);a(a.merge(e,f)).each(function(){this.updateSelectBoxPosition&&this.updateSelectBoxPosition()})}c._saveStatus()}})},_onReisze:function(){var d=this,c=this.options;if(c.target||c.url){var b=a(c.target).liger();if(!b)b=a(c.target).find(":first").liger();if(!b)return;var e=d.dialog.content.height(),f=d.dialog.content.width();b.trigger("resize",[{width:f,height:e}])}},_applyResize:function(){var b=this,c=this.options;if(a.fn.ligerResizable)b.resizable=b.dialog.ligerResizable({onStopResize:function(a){var d=0,c=0;if(!isNaN(parseInt(b.dialog.css("top"))))d=parseInt(b.dialog.css("top"));if(!isNaN(parseInt(b.dialog.css("left"))))c=parseInt(b.dialog.css("left"));a.diffLeft&&b.set({left:c+a.diffLeft});a.diffTop&&b.set({top:d+a.diffTop});if(a.newWidth){b.set({width:a.newWidth});b.dialog.body.css({width:a.newWidth-b._borderX})}a.newHeight&&b.set({height:a.newHeight});b._onReisze();b._saveStatus();b.trigger("stopResize");return false},animate:false})},_setImage:function(){var b=this,c=this.options;if(c.type){var d={paddingLeft:74,paddingRight:15,paddingBottom:30};if(c.type=="success"||c.type=="donne"||c.type=="ok"){a(".l-dialog-image",b.dialog).addClass("l-dialog-image-donne").show();b.dialog.content.css(d)}else if(c.type=="error"){a(".l-dialog-image",b.dialog).addClass("l-dialog-image-error").show();b.dialog.content.css(d)}else if(c.type=="warn"){a(".l-dialog-image",b.dialog).addClass("l-dialog-image-warn").show();b.dialog.content.css(d)}else if(c.type=="question"){a(".l-dialog-image",b.dialog).addClass("l-dialog-image-question").show();b.dialog.content.css(d)}}}});b.controls.Dialog.prototype.hide=b.controls.Dialog.prototype.hidden;a.ligerDialog.open=function(b){return a.ligerDialog(b)};a.ligerDialog.close=function(){var a=b.find(b.controls.Dialog.prototype.__getType());for(var d in a){var c=a[d];c.destroy.ligerDefer(c,5)}b.win.unmask()};a.ligerDialog.show=function(e){var c=b.find(b.controls.Dialog.prototype.__getType());if(c.length)for(var d in c){c[d].show();return}return a.ligerDialog(e)};a.ligerDialog.hide=function(){var a=b.find(b.controls.Dialog.prototype.__getType());for(var d in a){var c=a[d];c.hide()}};a.ligerDialog.tip=function(b){b=a.extend({showType:"slide",width:240,modal:false,height:100},b||{});a.extend(b,{fixedType:"se",type:"none",isDrag:false,isResize:false,showMax:false,showToggle:false,showMin:false});return a.ligerDialog.open(b)};a.ligerDialog.alert=function(e,c,b,d,g){e=e||"";if(typeof c=="function"){d=c;b=null}else if(typeof b=="function")d=b;var f=function(c,a,b){a.close();d&&d(c,a,b)};p={content:e,buttons:[{text:a.ligerDefaults.DialogString.ok,onclick:f}]};if(typeof c=="string"&&c!="")p.title=c;if(typeof b=="string"&&b!="")p.type=b;a.extend(p,{showMax:false,showToggle:false,showMin:false},g||{});return a.ligerDialog(p)};a.ligerDialog.confirm=function(e,b,c){if(typeof b=="function"){c=b;type=null}var d=function(b,a){a.close();c&&c(b.type=="ok")};p={type:"question",content:e,buttons:[{text:a.ligerDefaults.DialogString.yes,onclick:d,type:"ok",cls:"l-dialog-btn-ok"},{text:a.ligerDefaults.DialogString.no,onclick:d,type:"no",cls:"l-dialog-btn-no"}]};if(typeof b=="string"&&b!="")p.title=b;a.extend(p,{showMax:false,showToggle:false,showMin:false});return a.ligerDialog(p)};a.ligerDialog.warning=function(e,b,d,f){if(typeof b=="function"){d=b;type=null}var c=function(b,a){a.close();d&&d(b.type)};p={type:"question",content:e,buttons:[{text:a.ligerDefaults.DialogString.yes,onclick:c,type:"yes"},{text:a.ligerDefaults.DialogString.no,onclick:c,type:"no"},{text:a.ligerDefaults.DialogString.cancel,onclick:c,type:"cancel"}]};if(typeof b=="string"&&b!="")p.title=b;a.extend(p,{showMax:false,showToggle:false,showMin:false},f||{});return a.ligerDialog(p)};a.ligerDialog.waitting=function(b){b=b||a.ligerDefaults.Dialog.waittingMessage;return a.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+b+"</div>",allowClose:false})};a.ligerDialog.closeWaitting=function(){var a=b.find(b.controls.Dialog);for(var d in a){var c=a[d];c.dialog.hasClass("l-dialog-waittingdialog")&&c.close()}};a.ligerDialog.success=function(c,e,b,d){return a.ligerDialog.alert(c,e,"success",b,d)};a.ligerDialog.error=function(c,e,b,d){return a.ligerDialog.alert(c,e,"error",b,d)};a.ligerDialog.warn=function(c,e,b,d){return a.ligerDialog.alert(c,e,"warn",b,d)};a.ligerDialog.question=function(b,d,c){return a.ligerDialog.alert(b,d,"question",null,c)};a.ligerDialog.prompt=function(g,b,c,d){var e=a('<input type="text" class="l-dialog-inputtext"/>');if(typeof c=="function")d=c;if(typeof b=="function")d=b;else if(typeof b=="boolean")c=b;if(typeof c=="boolean"&&c)e=a('<textarea class="l-dialog-textarea"></textarea>');(typeof b=="string"||typeof b=="int")&&e.val(b);var f=function(b,a){a.close();d&&d(b.type=="yes",e.val())};p={title:g,target:e,width:320,buttons:[{text:a.ligerDefaults.DialogString.ok,onclick:f,type:"yes"},{text:a.ligerDefaults.DialogString.cancel,onclick:f,type:"cancel"}]};return a.ligerDialog(p)}})(jQuery);(function(a){var b=a.ligerui;a.fn.ligerDrag=function(){return b.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};a.fn.ligerGetDragManager=function(){return b.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};a.ligerDefaults.Drag={onStartDrag:false,onDrag:false,onStopDrag:false,handler:null,clickDelay:100,proxy:true,revert:false,animate:true,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:false,proxyX:null,proxyY:null};b.controls.Drag=function(a){b.controls.Drag.base.constructor.call(this,null,a)};b.controls.Drag.ligerExtend(b.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var b=this,c=this.options;this.set(c);b.cursor="move";b.handler.css("cursor",b.cursor);b.mouseDowned=false;b.handler.bind("mousedown.drag",function(d){if(c.disabled)return;if(d.button==2)return;b.mouseDowned=true;a(document).bind("selectstart.drag",function(){return false});setTimeout(function(){b.mouseDowned&&b._start.call(b,d)},c.clickDelay||100)}).bind("mousemove.drag",function(){if(c.disabled)return;b.handler.css("cursor",b.cursor)}).bind("mouseup.drag",function(){a(document).unbind("selectstart.drag")});a(document).bind("mouseup",function(){b.mouseDowned=false})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(d){var c=this,e=this.options;if(c.reverting)return;if(e.disabled)return;c.current={target:c.target,left:c.target.offset().left,top:c.target.offset().top,startX:d.pageX||d.screenX,startY:d.pageY||d.clientY};if(c.trigger("startDrag",[c.current,d])==false)return false;c.cursor="move";c._createProxy(e.proxy,d);if(e.proxy&&!c.proxy)return false;(c.proxy||c.handler).css("cursor",c.cursor);a(document).bind("mousemove.drag",function(){c._drag.apply(c,arguments)});b.draggable.dragging=true;a(document).bind("mouseup.drag",function(){b.draggable.dragging=false;c._stop.apply(c,arguments)})},_drag:function(c){var b=this,f=this.options;if(!b.current)return;var d=c.pageX||c.screenX,e=c.pageY||c.screenY;b.current.diffX=d-b.current.startX;b.current.diffY=e-b.current.startY;(b.proxy||b.handler).css("cursor",b.cursor);b.receive&&b.receive.each(function(h,f){var i=a(f),g=i.offset();if(d>g.left&&d<g.left+i.width()&&e>g.top&&e<g.top+i.height())if(!b.receiveEntered[h]){b.receiveEntered[h]=true;b.trigger("dragEnter",[f,b.proxy||b.target,c])}else b.trigger("dragOver",[f,b.proxy||b.target,c]);else if(b.receiveEntered[h]){b.receiveEntered[h]=false;b.trigger("dragLeave",[f,b.proxy||b.target,c])}});if(b.hasBind("drag"))if(b.trigger("drag",[b.current,c])!=false)b._applyDrag();else if(b.proxy)b._removeProxy();else b._stop();else b._applyDrag()},_stop:function(c){var b=this,d=this.options;a(document).unbind("mousemove.drag");a(document).unbind("mouseup.drag");a(document).unbind("selectstart.drag");b.receive&&b.receive.each(function(d,a){b.receiveEntered[d]&&b.trigger("drop",[a,b.proxy||b.target,c])});if(b.proxy)if(d.revert)if(b.hasBind("revert"))if(b.trigger("revert",[b.current,c])!=false)b._revert(c);else b._removeProxy();else b._revert(c);else{b._applyDrag(b.target);b._removeProxy()}b.cursor="move";b.trigger("stopDrag",[b.current,c]);b.current=null;b.handler.css("cursor",b.cursor)},_revert:function(b){var a=this;a.reverting=true;a.proxy.animate({left:a.current.left,top:a.current.top},function(){a.reverting=false;a._removeProxy();a.trigger("endRevert",[a.current,b]);a.current=null})},_applyDrag:function(b){var a=this,d=this.options;b=b||a.proxy||a.target;var c={},e=false,f=b==a.target;if(a.current.diffX){if(f||d.proxyX==null)c.left=a.current.left+a.current.diffX;else c.left=a.current.startX+d.proxyX+a.current.diffX;e=true}if(a.current.diffY){if(f||d.proxyY==null)c.top=a.current.top+a.current.diffY;else c.top=a.current.startY+d.proxyY+a.current.diffY;e=true}if(b==a.target&&a.proxy&&d.animate){a.reverting=true;b.animate(c,function(){a.reverting=false})}else b.css(c)},_setReceive:function(b){this.receiveEntered={};if(!b)return;if(typeof b=="string")this.receive=a(b);else this.receive=b},_setHandler:function(b){var c=this,d=this.options;if(!b)c.handler=a(d.target);else c.handler=typeof b=="string"?a(b,d.target):b},_setTarget:function(b){this.target=a(b)},_setCursor:function(a){this.cursor=a;(this.proxy||this.handler).css("cursor",a)},_createProxy:function(c,e){if(!c)return;var b=this,d=this.options;if(typeof c=="function")b.proxy=c.call(this.options.target,b,e);else if(c=="clone"){b.proxy=b.target.clone().css("position","absolute");b.proxy.appendTo("body")}else{b.proxy=a("<div class='l-draggable'></div>");b.proxy.width(b.target.width()).height(b.target.height());b.proxy.attr("dragid",b.id).appendTo("body")}b.proxy.css({left:d.proxyX==null?b.current.left:b.current.startX+d.proxyX,top:d.proxyY==null?b.current.top:b.current.startY+d.proxyY}).show()},_removeProxy:function(){var a=this;if(a.proxy){a.proxy.remove();a.proxy=null}}})})(jQuery);(function(a){a.fn.ligerEasyTab=function(){return a.ligerui.run.call(this,"ligerEasyTab",arguments)};a.fn.ligerGetEasyTabManager=function(){return a.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)};a.ligerDefaults.EasyTab={};a.ligerMethos.EasyTab={};a.ligerui.controls.EasyTab=function(b,c){a.ligerui.controls.EasyTab.base.constructor.call(this,b,c)};a.ligerui.controls.EasyTab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return a.ligerMethos.EasyTab},_render:function(){var b=this,d=this.options;b.tabs=a(this.element);b.tabs.addClass("l-easytab");var c=0;if(a("> div[lselected=true]",b.tabs).length>0)c=a("> div",b.tabs).index(a("> div[lselected=true]",b.tabs));b.tabs.ul=a('<ul class="l-easytab-header"></ul>');a("> div",b.tabs).each(function(f,d){var e=a("<li><span></span></li>");f==c&&a("span",e).addClass("l-selected");if(a(d).attr("title")){a("span",e).html(a(d).attr("title"));a(d).removeAttr("title")}b.tabs.ul.append(e);!a(d).hasClass("l-easytab-panelbox")&&a(d).addClass("l-easytab-panelbox")});b.tabs.ul.prependTo(b.tabs);a(".l-easytab-panelbox:eq("+c+")",b.tabs).show().siblings(".l-easytab-panelbox").hide();a("> ul:first span",b.tabs).click(function(){if(a(this).hasClass("l-selected"))return;var c=a("> ul:first span",b.tabs).index(this);a(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected");a(".l-easytab-panelbox:eq("+c+")",b.tabs).show().siblings(".l-easytab-panelbox").hide()}).not("l-selected").hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});b.set(d)}})})(jQuery);(function(a){a.fn.ligerFilter=function(){return a.ligerui.run.call(this,"ligerFilter",arguments)};a.fn.ligerGetFilterManager=function(){return a.ligerui.run.call(this,"ligerGetFilterManager",arguments)};a.ligerDefaults.Filter={fields:[],operators:{},editors:{},buttonCls:null};a.ligerDefaults.FilterString={strings:{and:"\u5e76\u4e14",or:"\u6216\u8005",equal:"\u76f8\u7b49",notequal:"\u4e0d\u76f8\u7b49",startwith:"\u4ee5..\u5f00\u59cb",endwith:"\u4ee5..\u7ed3\u675f",like:"\u76f8\u4f3c",greater:"\u5927\u4e8e",greaterorequal:"\u5927\u4e8e\u6216\u7b49\u4e8e",less:"\u5c0f\u4e8e",lessorequal:"\u5c0f\u4e8e\u6216\u7b49\u4e8e","in":"\u5305\u62ec\u5728...",notin:"\u4e0d\u5305\u62ec...",addgroup:"\u589e\u52a0\u5206\u7ec4",addrule:"\u589e\u52a0\u6761\u4ef6",deletegroup:"\u5220\u9664\u5206\u7ec4"}};a.ligerDefaults.Filter.operators.string=a.ligerDefaults.Filter.operators.text=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"];a.ligerDefaults.Filter.operators.number=a.ligerDefaults.Filter.operators["int"]=a.ligerDefaults.Filter.operators["float"]=a.ligerDefaults.Filter.operators.date=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"];a.ligerDefaults.Filter.editors.string={create:function(c,d){var b=a("<input type='text'/>");c.append(b);b.ligerTextBox(d.editor.options||{});return b},setValue:function(a,b){a.val(b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};a.ligerDefaults.Filter.editors.date={create:function(c,d){var b=a("<input type='text'/>");c.append(b);b.ligerDateEditor(d.editor.options||{});return b},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};a.ligerDefaults.Filter.editors.number={create:function(d,b){var c=a("<input type='text'/>");d.append(c);var e={minValue:b.editor.minValue,maxValue:b.editor.maxValue};c.ligerSpinner(a.extend(e,b.editor.options||{}));return c},setValue:function(a,b){a.val(b)},getValue:function(a,b){var c=b.editor.type=="int";return c?parseInt(a.val(),10):parseFloat(a.val())},destroy:function(a){a.liger("destroy")}};a.ligerDefaults.Filter.editors.combobox={create:function(e,b){var c=a("<input type='text'/>");e.append(c);var d={data:b.data,slide:false,valueField:b.editor.valueField||b.editor.valueColumnName,textField:b.editor.textField||b.editor.displayColumnName};a.extend(d,b.editor.options||{});c.ligerComboBox(d);return c},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}};a.ligerui.controls.Filter=function(b,c){a.ligerui.controls.Filter.base.constructor.call(this,b,c)};a.ligerui.controls.Filter.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){var e=this,d=this.options;a.ligerui.controls.Filter.base._init.call(this);for(var b in liger.editors){var c=liger.editors[b];if(!c||b in d.editors)continue;d.editors[b]=liger.getEditor(a.extend({type:b,master:e},c))}},_render:function(){var b=this,c=this.options;b.set(c);a(b.element).bind("click",function(f){f.preventDefault();var c=a(f.target||f.srcElement),d=c.get(0).className;if(d.indexOf("addgroup")>=0){var e=c.parent().parent().parent().parent();b.addGroup(e)}else if(d.indexOf("deletegroup")>=0){var e=c.parent().parent().parent().parent();b.deleteGroup(e)}else if(d.indexOf("addrule")>=0){var e=c.parent().parent().parent().parent();b.addRule(e)}else if(d.indexOf("deleterole")>=0){var g=c.parent().parent();b.deleteRule(g)}})},_setFields:function(){var b=this,c=this.options;b.group&&b.group.remove();b.group=a(b._bulidGroupTableHtml()).appendTo(b.element);c.buttonCls&&b.group.find(".addgroup,.addrule,.deletegroup").addClass(c.buttonCls)},editors:{},editorCounter:0,addGroup:function(c){var e=this,f=this.options;c=a(c||e.group);var i=a(">tbody:first > tr:last",c),b=[];b.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">');var h=!c.hasClass("l-filter-group-alt");b.push(e._bulidGroupTableHtml(h,true));b.push("</td></tr>");var d=a(b.join(""));f.buttonCls&&d.find(".addgroup,.addrule,.deletegroup").addClass(f.buttonCls);i.before(d);var g=d.find("table:first");f.addDefult&&e.addRule(g);return g},deleteGroup:function(b){var c=this,d=this.options;a("td.l-filter-value",b).each(function(){var b=a(this).parent();a("select.fieldsel",b).unbind();c.removeEditor(b)});a(b).parent().parent().remove()},removeEditor:function(b){var g=this,e=this.options,d=a(b).attr("editortype"),f=a(b).attr("editorid"),c=g.editors[f];c&&e.editors[d].destroy&&e.editors[d].destroy(c);a("td.l-filter-value:first",b).html("")},setData:function(d,c){var b=this,e=this.options;c=c||b.group;var f=a(">tbody:first > tr:last",c);c&&c.find(">tbody:first > tr").not(f).remove();a("select:first",f).val(d.op);d.rules&&a(d.rules).each(function(){var d=b.addRule(c),h=this.field,f=function(){for(var a=0;a<e.fields.length;a++)if(e.fields[a].name==h)return e.fields[a];return null}();a("select.opsel",d).html(b._bulidOpSelectOptionsHtml(this.type||"string",f.operator));d.attr("fieldtype",this.type||"string");a("select.opsel",d).val(this.op);a("select.fieldsel",d).val(this.field).trigger("change");var g=d.attr("editorid");if(g&&b.editors[g]){var f=b.getField(this.field);if(f&&f.editor){var i={field:f,filter:b};e.editors[f.editor.type].setValue.call(b,b.editors[g],this.value,i)}}else a(":text",d).val(this.value)});d.groups&&a(d.groups).each(function(){var a=b.addGroup(c);b.setData(this,a)})},addRule:function(d){var c=this,e=this.options;d=d||c.group;var f=a(">tbody:first > tr:last",d),b=a(c._bulidRuleRowHtml());f.before(b);e.fields.length&&c.appendEditor(b,e.fields[0]);a("select.fieldsel",b).bind("change",function(){var j=a(this).parent().next().find("select:first"),g=a(this).val();if(!g)return;var d=c.getField(g),e=d.type||"string",i=b.attr("fieldtype");if(e!=i){j.html(c._bulidOpSelectOptionsHtml(e,d.operator));b.attr("fieldtype",e)}var f=null,h=b.attr("editortype");if(c.enabledEditor(d))f=d.editor.type;h&&c.removeEditor(b);if(f)c.appendEditor(b,d);else{b.removeAttr("editortype").removeAttr("editorid");a("td.l-filter-value:first",b).html('<input type="text" class="valtxt l-text" />')}});return b},deleteRule:function(b){a("select.fieldsel",b).unbind();this.removeEditor(b);a(b).remove()},appendEditor:function(f,b){var c=this,i=this.options;if(c.enabledEditor(b)){var g=a("td.l-filter-value:first",f).html(""),h=i.editors[b.editor.type],d=++c.editorCounter,e={filter:c};e.field=a.extend(true,{},b);e.field.name=b.name+"_"+d;c.editors[d]=h.create.call(this,g,e);f.attr("editortype",b.editor.type).attr("editorid",d)}},getData:function(d){var c=this,e=this.options;d=d||c.group;var b={};a("> tbody > tr",d).each(function(m,d){var i=a(d).hasClass("l-filter-rowlast"),h=a(d).hasClass("l-filter-rowgroup");if(h){var e=a("> td:first > table:first",d);if(e.length){if(!b.groups)b.groups=[];b.groups.push(c.getData(e))}}else if(i)b.op=a(".groupopsel:first",d).val();else{var f=a("select.fieldsel:first",d).val(),j=c.getField(f),l=a(".opsel:first",d).val(),g=c._getRuleValue(d,j),k=a(d).attr("fieldtype")||"string";if(!b.rules)b.rules=[];g!=null&&b.rules.push({field:f,op:l,value:g,type:k})}});return b},_getRuleValue:function(b,h){var c=this,i=this.options,f=a(b).attr("editorid"),e=a(b).attr("editortype"),d=c.editors[f],g={field:h,filter:c};return d?i.editors[e].getValue.call(c,d,g):a(".valtxt:first",b).val()},enabledEditor:function(a){var c=this,b=this.options;return!a.editor||!a.editor.type?false:a.editor.type in b.editors},getField:function(d){for(var f=this,c=this.options,a=0,e=c.fields.length;a<e;a++){var b=c.fields[a];if(b.name==d)return b}return null},_bulidGroupTableHtml:function(d,c){var e=this,b=this.options,a=[];a.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group');d&&a.push(" l-filter-group-alt");a.push('"><tbody>');a.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">');a.push('<select class="groupopsel">');a.push('<option value="and">'+b.strings.and+"</option>");a.push('<option value="or">'+b.strings.or+"</option>");a.push("</select>");a.push('<input type="button" value="'+b.strings.addgroup+'" class="addgroup">');a.push('<input type="button" value="'+b.strings.addrule+'" class="addrule">');c&&a.push('<input type="button" value="'+b.strings.deletegroup+'" class="deletegroup">');a.push("</td></tr>");a.push("</tbody></table>");return a.join("")},_bulidRuleRowHtml:function(b){var f=this,h=this.options;b=b||h.fields;var a=[],d=b&&b.length&&b[0].type?b[0].type:"string";a.push('<tr fieldtype="'+d+'"><td class="l-filter-column">');a.push('<select class="fieldsel">');for(var c=0,g=b.length;c<g;c++){var e=b[c];a.push('<option value="'+e.name+'"');c==0&&a.push(" selected ");a.push(">");a.push(e.display);a.push("</option>")}a.push("</select>");a.push("</td>");a.push('<td class="l-filter-op">');a.push('<select class="opsel">');a.push(f._bulidOpSelectOptionsHtml(d,b&&b.length?b[0].operator:null));a.push("</select>");a.push("</td>");a.push('<td class="l-filter-value">');a.push('<input type="text" class="valtxt" />');a.push("</td>");a.push("<td>");a.push('<div class="l-icon-cross deleterole"></div>');a.push("</td>");a.push("</tr>");return a.join("")},_bulidOpSelectOptionsHtml:function(g,c){var i=this,f=this.options,b=f.operators[g],a=[];if(c&&c.length)b=c.split(",");if(!b||!b.length)b=["equal","notequal"];for(var d=0,h=b.length;d<h;d++){var e=b[d];a[a.length]='<option value="'+e+'">';a[a.length]=f.strings[e];a[a.length]="</option>"}return a.join("")}});a.ligerFilter=function(){};a.ligerFilter.filterTranslator={translateGroup:function(a){var b=[];if(a==null)return" 1==1 ";var c=false;b.push("(");if(a.rules!=null)for(var d in a.rules){if(d=="indexOf")continue;var f=a.rules[d];c&&b.push(this.getOperatorQueryText(a.op));b.push(this.translateRule(f));c=true}if(a.groups!=null)for(var g in a.groups){var e=a.groups[g];c&&b.push(this.getOperatorQueryText(a.op));b.push(this.translateGroup(e));c=true}b.push(")");return c==false?" 1==1 ":b.join("")},translateRule:function(b){var a=[];if(b==null)return" 1==1 ";if(b.op=="like"||b.op=="startwith"||b.op=="endwith"){a.push("/");b.op=="startwith"&&a.push("^");a.push(b.value);b.op=="endwith"&&a.push("$");a.push("/i.test(");a.push('o["');a.push(b.field);a.push('"]');a.push(")");return a.join("")}a.push('o["');a.push(b.field);a.push('"]');a.push(this.getOperatorQueryText(b.op));a.push('"');a.push(b.value);a.push('"');return a.join("")},getOperatorQueryText:function(a){switch(a){case"equal":return" == ";case"notequal":return" != ";case"greater":return" > ";case"greaterorequal":return" >= ";case"less":return" < ";case"lessorequal":return" <= ";case"and":return" && ";case"or":return" || ";default:return" == "}}};a.ligerFilter.getFilterFunction=function(b){if(a.isArray(b))b={op:"and",rules:b};var c=" return  "+a.ligerFilter.filterTranslator.translateGroup(b);return new Function("o",c)}})(jQuery);(function(a){a.fn.ligerForm=function(){return a.ligerui.run.call(this,"ligerForm",arguments)};a.ligerui.getConditions=function(b){if(!b)return null;b=liger.get(a(b));if(b&&b.toConditions)return b.toConditions()};a.ligerDefaults=a.ligerDefaults||{};a.ligerDefaults.Form={width:null,inputWidth:180,labelWidth:90,space:40,rightToken:"\uff1a",labelAlign:"left",align:"left",autoTypePrev:"ui-",fields:[],appendID:true,prefixID:null,toJSON:a.ligerui.toJSON,labelCss:null,fieldCss:null,spaceCss:null,onAfterSetFields:null,buttons:null,readonly:false,editors:{},validate:null,unSetValidateAttr:false,tab:null,clsTab:"ui-tabs-nav ui-helper-clearfix",clsTabItem:"ui-state-default",clsTabItemSelected:"ui-tabs-selected",clsTabContent:"ui-tabs-panel ui-widget-content"};a.ligerDefaults.FormString={invalidMessage:"\u5b58\u5728{errorCount}\u4e2a\u5b57\u6bb5\u9a8c\u8bc1\u4e0d\u901a\u8fc7\uff0c\u8bf7\u68c0\u67e5!",detailMessage:"\u8be6\u7ec6",okMessage:"\u786e\u5b9a"};a.ligerDefaults.Form.editors.textarea={create:function(f,c,e){var b=a('<textarea class="l-textarea" />'),d=(e.prefixID||"")+c.field.name;if(a("#"+d).length)b=a("#"+d);b.attr({id:d,name:d});c.field.editor&&c.field.editor.height&&b.height(c.field.editor.height);e.readonly&&b.attr("readonly",true);f.append(b);return b},getValue:function(a){return a.val()},setValue:function(a,b){a.val(b)},resize:function(a,b){a.css({width:b-2}).parent().css("width","auto")}};a.ligerDefaults.Form.editors.hidden={create:function(f,c,g){var b=a('<input type = "hidden"  />'),d=(g.prefixID||"")+c.field.name;if(a("#"+d).length)b=a("#"+d);b.attr(a.extend({id:d,name:d},c.field.attr));var e=c.field.editor||c.field.options;e&&b.val(e.value);f.append(b);return b},getValue:function(a){return a.val()},setValue:function(a,b){a.val(b)}};a.ligerDefaults.Form_fields={name:null,textField:null,type:null,editor:null,label:null,labelInAfter:false,afterContent:null,beforeContent:null,hideSpace:false,hideLabel:false,rightToken:null,attrRender:null,style:null,containerCls:null,newline:true,op:null,vt:null,attr:null,validate:null};a.ligerDefaults.Form_editor={};a.ligerDefaults.Form.editorBulider=function(b){var j=this,h=this.options;if(!b||!b.length)return;var c={},e=b.attr("ltype"),g={};if(h.readonly)c.readonly=true;c=a.extend({width:(g.width||h.inputWidth)-2},g.options,g.editor,c);var d=null;if(e=="autocomplete")c.autocomplete=true;if(b.is("select")&&e!="none")d=b.ligerComboBox(c);else if(b.is(":password")&&e!="none")d=b.ligerTextBox(c);else if(b.is(":radio")&&e!="none")d=b.ligerRadio(c);else if(b.is(":checkbox")&&e!="none")d=b.ligerCheckBox(c);else if(b.is("textarea")&&e!="none"){b.addClass("l-textarea");d={getValue:function(){return b.val()},setValue:function(a){b.val(a)}}}else if(e&&e!="none"){if(b.is(":text"))switch(e){case"select":case"combobox":case"autocomplete":d=b.ligerComboBox(c);break;case"spinner":d=b.ligerSpinner(c);break;case"date":d=b.ligerDateEditor(c);break;case"popup":d=b.ligerPopupEdit(c);break;case"currency":d=c.currency=true;case"float":case"number":c.number=true;d=b.ligerTextBox(c);break;case"int":case"digits":c.digits=true;default:d=b.ligerTextBox(c)}else if(b.is(":hidden"))switch(e){case"select":case"combobox":case"autocomplete":d=b.ligerComboBox(c);break;case"checkboxlist":d=b.ligerCheckBoxList(c);break;case"radiolist":d=b.ligerRadioList(c);break;case"listbox":d=b.ligerListBox(c)}}else{var f=b.get(0).className;if(f){var i=h.autoTypePrev||"ui-";if(f.indexOf(i)!=-1)f=f.replace(i,"")}if(!f&&(b.is(":hidden")||b.is(":text"))&&b.attr("name"))d={getValue:function(){return b.val()},setValue:function(a){b.val(a)}};else switch(f){case"textbox":case"password":d=b.ligerTextBox(c);break;case"datepicker":d=b.ligerDateEditor(c);break;case"spinner":d=b.ligerSpinner(c);break;case"checkbox":d=b.ligerCheckBox(c);break;case"combobox":d=b.ligerComboBox(c);break;case"checkboxlist":d=b.ligerCheckBoxList(c);break;case"radiolist":d=b.ligerRadioList(c);break;case"listbox":d=b.ligerListBox(c)}}return!d?null:{name:b.attr("name"),control:d}};a.ligerui.controls.Form=function(b,c){a.ligerui.controls.Form.base.constructor.call(this,b,c)};a.ligerui.controls.Form.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){var e=this,d=this.options;a.ligerui.controls.Form.base._init.call(this);for(var b in liger.editors){var c=liger.editors[b];if(!c||b in d.editors)continue;d.editors[b]=liger.getEditor(a.extend({type:b,master:e},c))}},_render:function(){var b=this,d=this.options,c=a(this.element);b.form=c.is("form")?c:c.parents("form:first");a("input,select,textarea",c).each(function(){var c=d.editorBulider.call(b,a(this));if(c){b.autoEditors=b.autoEditors||[];b.autoEditors.push(c)}});if(b.autoEditors&&b.autoEditors.length&&d.validate){b.validate=b.validate||{};a(b.autoEditors).each(function(){var c=this.name,a=this.control;if(c&&a.inputText&&a.inputText.attr("validate")){var e=null,d=null;eval("v = "+a.inputText.attr("validate"));if(e){b.validate.rules=b.validate.rules||{};b.validate.rules[c]=e}if(a.inputText.attr("validateMessage")){eval("vm = "+a.inputText.attr("validateMessage"));if(d){b.validate.messages=b.validate.messages||{};b.validate.messages[c]=d}}}})}b.set(d);b.initValidate();if(d.buttons){var e=a('<ul class="l-form-buttons"></ul>').appendTo(c);a(d.buttons).each(function(){var b=a("<li><div></div></li>").appendTo(e);a("div:first",b).ligerButton(this)})}if(!b.element.id)b.element.id=b.id;a("#"+b.element.id+" .togglebtn").live("click",function(){if(a(this).hasClass("togglebtn-down"))a(this).removeClass("togglebtn-down");else a(this).addClass("togglebtn-down");for(var d=a(this).parent().nextAll("ul,div"),c=0;c<d.length;c++){var b=a(d[c]);if(b.hasClass("l-group"))break;if(a(this).hasClass("togglebtn-down"))b.hide();else b.show()}})},_setWidth:function(a){var b=this,c=this.options;a&&b.form.width(a)},getEditor:function(g){var d=this,a=this.options;if(!d.editors)return;var c=e(null);if(c)return c;if(a.tab&&a.tab.items)for(var b=0;b<a.tab.items.length;b++){var f=a.tab.items[b],c=e(f,b);if(c)return c}return null;function e(e,c){for(var h=e==null?a.fields:e.fields,b=0,j=h.length;b<j;b++){var i=h[b],f=c==null?b:"tab"+c+"_"+b;if(i.name==g&&d.editors[f])return d.editors[f].control}}},getField:function(b){var c=this,a=this.options;return!a.fields?null:a.fields[b]},toConditions:function(){var c=this,d=this.options,b=[];a(d.fields).each(function(g,a){var f=a.name,h=a.textField,d=c.editors[g];if(!d||!f)return;var e=d.editor.getValue.call(c,d.control,{field:a});e!=null&&e!==""&&b.push({op:a.operator||"like",field:f,value:e,type:a.type||"string"})});return b},_preSetFields:function(){var f=this,d=this.options,b=null,c=null;a(d.fields).each(function(e,a){if(d.readonly||a.readonly||a.editor&&a.editor.readonly)delete a.validate;if(a.type=="hidden")return;a.type=a.type||"text";if(a.newline==null)a.newline=true;if(b&&!a.group){a.group=b;a.groupicon=c}if(a.group){a.group=a.group.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,"");b=a.group;c=a.groupicon}})},_setReadonly:function(c){var b=this,e=this.options;if(c&&b.editors)for(var d in b.editors){var a=b.editors[d].control;a&&a._setReadonly&&a._setReadonly(true)}},_setFields:function(c){var b=this,d=this.options;if(a.isFunction(d.prefixID))d.prefixID=d.prefixID(b);var e=a(b.element).addClass("l-form");b._initFieldsValidate({fields:c});b._initFieldsHtml({panel:e,fields:c});b._createEditors({fields:c});b.trigger("afterSetFields")},_initFieldsValidate:function(d){var b=this,e=this.options,c=d.fields;b.validate=b.validate||{};c&&c.length&&a(c).each(function(f,a){var g=a.name,d=a.readonly||a.editor&&a.editor.readonly?true:false,c=(e.prefixID||"")+(a.textField||a.id||a.name);if(a.validate&&!d){b.validate.rules=b.validate.rules||{};b.validate.rules[c]=a.validate;if(a.validateMessage){b.validate.messages=b.validate.messages||{};b.validate.messages[c]=a.validateMessage}}})},_initFieldsHtml:function(i){var e=this,f=this.options,h=i.panel,d=i.fields,n=i.idPrev||e.id,m=i.tabindex;a(">.l-form-container",h).remove();var c=0,j=0;if(d&&d.length){e._preSetFields(d);var b=['<div class="l-form-container">'],g=false,l=null,k=[];a(d).each(function(c,b){if(!b.group)b.group="";a.inArray(b.group,k)==-1&&k.push(b.group)});a(k).each(function(k,h){a(d).each(function(v,k){if(k.group!=h)return;var o=a.inArray(k,d),u=k.id||k.name,p=k.newline,t=(f.prefixID||"")+(k.id||k.name);if(!u)return;if(k.type=="hidden"){!a("#"+t).length&&b.push('<div style="display:none" id="'+(n+"|"+v)+'"></div>');return}var q=k.group&&k.group!=l;if(o==0||q)p=true;if(p){c=0;if(g){b.push("</ul>");g=false}if(q){b.push('<div class="l-group');k.groupicon&&b.push(" l-group-hasicon");b.push('">');k.groupicon&&b.push('<img src="'+k.groupicon+'" />');b.push("<span>"+k.group+"</span></div>");l=k.group}b.push("<ul>");g=true}b.push('<li class="l-fieldcontainer');p&&b.push(" l-fieldcontainer-first");k.containerCls&&b.push(" "+k.containerCls);b.push('"');k.style&&b.push(' style="'+k.style+'"');b.push(' fieldindex="'+o+'"');m!=null&&b.push(' tabindex="'+m+'"');k.attrRender&&b.push(" "+k.attrRender());b.push("><ul>");if(k.beforeContent){var r=a.isFunction(k.beforeContent)?k.afterContent(k):k.beforeContent;r&&b.push(r)}!k.hideLabel&&!k.labelInAfter&&b.push(e._buliderLabelContainer(k,o));b.push(e._buliderControlContainer(k,o,i.idPrev));k.labelInAfter&&b.push(e._buliderLabelContainer(k,o));if(k.afterContent){var s=a.isFunction(k.afterContent)?k.afterContent(k):k.afterContent;s&&b.push(s)}!k.hideSpace&&b.push(e._buliderSpaceContainer(k,o));b.push("</ul></li>");c+=k.width||f.inputWidth||0;c+=k.space||f.space||0;c+=k.labelWidth||f.labelWidth||0;if(c>j)j=c})});if(g){b.push("</ul>");g=false}b.push('<div class="l-clear"></div>');b.push("</div>");h.append(b.join(""));!f.width||j>f.width;a(".l-group .togglebtn",h).remove();a(".l-group",h).width(h.width()*.95).append("<div class='togglebtn'></div>")}},_createEditors:function(c){var b=this,g=this.options,e=c.fields,f=c.idPrev||b.id,d=c.editPrev||"";b.editors=b.editors||{};var h=a(b.element);a(e).each(function(i,k){var c=document.getElementById(f+"|"+i),j=g.editors[k.type],e=d+i;if(!c)return;c=a(c);var h=b._createEditor(j,c,{field:k},c.width(),c.height());if(!h)return;b.editors[e]&&b.editors[e].control&&b.editors[e].control.destroy&&b.editors[e].control.destroy();b.editors[e]={control:h,editor:j}})},getChanges:function(){var c=this,f=this.options,b=c.data,d=c.getData();c.data=b;var e={};for(var a in b)if(d[a]!=b[a])e[a]=d[a];return e},setEnabled:function(c,g){var e=[];if(a.isArray(c))e=c;typeof c=="string"&&e.push(c);var i=this,b=this.options;f(b.fields);if(b.tab&&b.tab.items)for(var d=0;d<b.tab.items.length;d++){var h=b.tab.items[d];f(h.fields,d)}function f(c,b){a(c).each(function(h,d){var f=d.name,k=d.textField,j=b==null?"":"tab"+b+"_",c=i.editors[j+h];if(!c||!f)return;if(!c.editor||!c.editor.setEnabled)return;if(a.inArray(f,e)==-1)return;c.editor.setEnabled(c.control,g)})}},setVisible:function(c,g){var e=[];if(a.isArray(c))e=c;typeof c=="string"&&e.push(c);var i=this,b=this.options;f(b.fields);if(b.tab&&b.tab.items)for(var d=0;d<b.tab.items.length;d++){var h=b.tab.items[d];f(h.fields,d)}function f(c,b){a(c).each(function(c,d){var f=d.name;if(a.inArray(f,e)==-1)return;i._setFieldPanelVisible(b,c,g)})}},_setFieldPanelVisible:function(c,b,d){var e=this,f=this.options;if(c==null)a("li.l-fieldcontainer[fieldindex="+b+"]",e.element)[d?"show":"hide"]();else a("div."+f.clsTabContent+"[data-index="+c+"] li.l-fieldcontainer[fieldindex="+b+"]",e.element)[d?"show":"hide"]()},getData:function(){var b=this,c=this.options;b.data=b.formData||{};b.autoEditors&&b.autoEditors.length&&a(b.autoEditors).each(function(){var c=this.name,a=this.control;if(c&&a&&a.getValue)b.data[c]=a.getValue()});e(c.fields);if(c.tab&&c.tab.items)for(var d=0;d<c.tab.items.length;d++){var f=c.tab.items[d];e(f.fields,d)}function e(d,c){a(d).each(function(h,d){var g=d.name,e=d.textField,i=c==null?"":"tab"+c+"_",a=b.editors[i+h];if(!a)return;if(g){var f=a.editor.getValue.call(b,a.control,{field:d});b._setValueByName(b.data,g,f)}if(e&&a.editor.getText){var f=a.editor.getText.call(b,a.control,{field:d});b._setValueByName(b.data,e,f)}})}return b.data},_setData:function(a){this.setData(a)},setData:function(f){var b=this,c=this.options;b.data=f||{};b.autoEditors&&b.autoEditors.length&&a(b.autoEditors).each(function(){var c=this.name,a=this.control;c&&b.data[c]&&a&&a.setValue&&a.setValue(b.data[c])});e(c.fields);if(c.tab&&c.tab.items)for(var d=0;d<c.tab.items.length;d++){var g=c.tab.items[d];e(g.fields,d)}function e(d,c){a(d).each(function(g,d){var f=d.name,e=d.textField,h=c==null?"":"tab"+c+"_",a=b.editors[h+g];if(!a)return;if(f&&f in b.data){var i=b._getValueByName(b.data,f);a.editor.setValue.call(b,a.control,i,{field:d})}if(e&&e in b.data){var j=b._getValueByName(b.data,e);a.editor.setText.call(b,a.control,j,{field:d})}})}},_setValueByName:function(b,a,c){if(!b||!a)return null;if(a.indexOf(".")==-1)b[a]=c;else try{new Function("data,value","data."+a+"=value;")(b,c)}catch(d){}},_getValueByName:function(b,a){if(!b||!a)return null;if(a.indexOf(".")==-1)return b[a];else try{return new Function("data","return data."+a+";")(b)}catch(c){return null}},valid:function(){var a=this,b=this.options;return!a.form||!a.validator?true:a.form.valid()},showFieldError:function(d,c){var b=a("[name="+d+"]",this.element);if(b.hasClass("l-textarea"))b.addClass("l-textarea-invalid");else b.hasClass("l-text-field")&&b.parent().addClass("l-text-invalid");a(b).removeAttr("title").ligerHideTip();a(b).attr("title",c).ligerTip({distanceX:5,distanceY:-3,auto:true})},hideFieldError:function(c){var b=a("[name="+c+"]",this.element);if(b.hasClass("l-textarea"))b.removeClass("l-textarea-invalid");else b.parent().removeClass("l-text-invalid");a(b).removeAttr("title").ligerHideTip()},initValidate:function(){var b=this,c=this.options;if(!b.form||!c.validate||!b.form.validate){b.validator=null;return}var e=c.validate==true?{}:c.validate,d=a.extend({errorPlacement:function(c,b){if(!a(c).html())return;if(!b.attr("id")){var d=(new Date).getTime();b.attr("id",d);c.attr("for",d)}if(b.hasClass("l-textarea"))b.addClass("l-textarea-invalid");else b.hasClass("l-text-field")&&b.parent().addClass("l-text-invalid");a(b).removeAttr("title").ligerHideTip();a(b).attr("title",a(c).html()).ligerTip({distanceX:5,distanceY:-3,auto:true})},success:function(d){var c=d.attr("for");if(!c)return;var b=a("#"+c);if(b.hasClass("l-textarea"))b.removeClass("l-textarea-invalid");else b.parent().removeClass("l-text-invalid");a(b).removeAttr("title").ligerHideTip()}},e,{rules:b.validate.rules,messages:b.validate.messages});b.validator=b.form.validate(d)},setFieldValidate:function(f,c,e){var b=a("[name="+f+"]");if(!b.length||!b.rules)return;var d=b.rules("remove");if(d){b.hasClass("l-text-field")&&b.parent().removeClass("l-text-invalid");b.removeAttr("title").ligerHideTip();d.required&&b.parents("li:first").next("li:first").find(".l-star").remove()}if(!c)return;var g=a.extend({},c,{messages:e});b.rules("add",g);c.required&&b.parents("li:first").next("li:first").append('<span class="l-star">*</span>')},showInvalid:function(){var d=this,c=this.options;if(!d.validator)return;var e=c.invalidMessage.replace("{errorCount}",d.validator.errorList.length);if(c.showInvalid)c.showInvalid(e);else{var f=a('<div><div class="invalid">'+e+'<a class="viewInvalidDetail" href="javascript:void(0)">'+c.detailMessage+'</a></div><div class="invalidDetail" style="display:none;">'+b(d.validator.errorList)+"</div></div>");f.find("a.viewInvalidDetail:first").bind("click",function(){a(this).parent().next("div.invalidDetail").toggle()});a.ligerDialog.open({type:"error",width:350,showMax:false,showToggle:false,showMin:false,target:f,buttons:[{text:c.okMessage,onclick:function(b,a){a.close()}}]})}},_createEditor:function(a,d,c,f,e){var i=this,g=this.options;try{var b=a.create.call(this,d,c,g);b&&a.resize&&a.resize.call(this,b,f,e,c);return b}catch(h){return null}},_buliderLabelContainer:function(c){var h=this,d=this.options,f=c.label||c.display,b=c.labelWidth||c.labelwidth||d.labelWidth,g=c.labelAlign||d.labelAlign;if(f){var e=c.rightToken;if(e==null||e=="")e=d.rightToken;f+=e}var a=[];a.push("<li");d.labelCss&&a.push(' class="'+d.labelCss+'"');a.push(' style="');if(/px$/i.test(b)||/auto/i.test(b)||/%$/i.test(b))a.push("width:"+b+";");else b&&a.push("width:"+b+"px;");g&&g!="top"&&a.push("text-align:"+g+";");a.push('">');f&&a.push(f);a.push("</li>");return a.join("")},_buliderControlContainer:function(c,g,e){var i=this,d=this.options,b=c.width||d.inputWidth,f=c.align||c.textAlign||c.textalign||d.align,a=[],e=e||i.id,h=c.labelAlign||d.labelAlign;a.push("<li");a.push(' id="'+(e+"|"+g)+'"');d.fieldCss&&a.push(' class="'+d.fieldCss+'"');a.push(' style="');if(/px$/i.test(b)||/auto/i.test(b)||/%$/i.test(b))a.push("width:"+b+";");else b&&a.push("width:"+b+"px;");f&&a.push("text-align:"+f+";");h=="top"&&a.push("clear:both;");a.push('">');a.push("</li>");return a.join("")},_buliderSpaceContainer:function(c){var e=this,d=this.options,b=c.space||c.spaceWidth||d.space;if(c.space===0||c.spaceWidth===0)b=0;var a=[];a.push("<li");d.spaceCss&&a.push(' class="'+d.spaceCss+'"');a.push(' style="');(/px$/i.test(b)||/auto/i.test(b)||/%$/i.test(b))&&a.push("width:"+b+";");b&&a.push("width:"+b+"px;");a.push('">');c.validate&&c.validate.required&&a.push("<span class='l-star'>*</span>");a.push("</li>");return a.join("")},_getInputAttrHtml:function(a){var b=[],d=(a.type||"text").toLowerCase();if(d=="textarea"){a.cols&&b.push('cols="'+a.cols+'" ');a.rows&&b.push('rows="'+a.rows+'" ')}b.push('ltype="'+d+'" ');a.op&&b.push('op="'+a.op+'" ');a.vt&&b.push('vt="'+a.vt+'" ');if(a.attr)for(var c in a.attr)b.push(c+'="'+a.attr[c]+'" ');return b.join("")},_setTab:function(f){var b=this,e=this.options;if(!f||!f.items)return;for(var k=a('<div class="l-form-tabs"></div>').appendTo(b.element),i=a('<ul class="'+e.clsTab+'" original-title="">').appendTo(k),c=0;c<f.items.length;c++){var d=f.items[c],g=a('<li class="'+e.clsTabItem+'"><a href="javascript:void(0)"></a></li>').appendTo(i),h=a('<div class="'+e.clsTabContent+'">').appendTo(k),j=b.id+"|tdb"+c;g.add(h).attr("data-index",c);d.id&&g.attr("data-id",d.id);g.find("a:first").text(d.title);b._initFieldsValidate({fields:d.fields});b._initFieldsHtml({panel:h,fields:d.fields,tabindex:c,idPrev:j});b._createEditors({fields:d.fields,idPrev:j,editPrev:"tab"+c+"_"})}i.find("li").click(function(){a(this).addClass(e.clsTabItemSelected)},function(){a(this).removeClass(e.clsTabItemSelected)}).click(function(){var c=a(this).attr("data-index");b.selectTab(c)});b.selectTab(0)},selectTab:function(b){var g=this,f=this.options,e=a(g.element).find(".l-form-tabs:first"),d=e.find(".ui-tabs-nav li"),c=e.find(".ui-tabs-panel");d.filter("[data-index="+b+"]").addClass(f.clsTabItemSelected);d.filter("[data-index!="+b+"]").removeClass(f.clsTabItemSelected);c.filter("[data-index="+b+"]").show();c.filter("[data-index!="+b+"]").hide()},destroy:function(){try{var c=this,f=this.options;liger.remove(this);for(var d in c.editors){var b=c.editors[d].control;b&&b.destroy&&b.destroy()}a(c.element).remove()}catch(e){}}});function b(c){var b=[];a(c).each(function(f,c){var e=a(c.element).parents("li:first").prev("li:first").html(),d=c.message;b.push("<div>"+e+" "+d+"</div>")});return b.join("")}})(jQuery);(function(a){var c=a.ligerui;a.fn.ligerGrid=function(){return a.ligerui.run.call(this,"ligerGrid",arguments)};a.fn.ligerGetGridManager=function(){return a.ligerui.run.call(this,"ligerGetGridManager",arguments)};a.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:true,url:false,urlParms:null,data:null,usePager:true,hideLoadButton:false,pagerRender:null,page:1,pageSize:20,pageSizeOptions:[20,50,100,200,400],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:false,switchPageSizeApplyComboBox:false,allowAdjustColWidth:true,checkbox:false,isSingleCheck:false,allowHideColumn:true,enabledEdit:false,isScroll:true,dateFormat:"yyyy-MM-dd",inWindow:true,statusName:"__status",method:"post",async:true,fixedCellHeight:true,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",allowUnSelectRow:false,alternatingRow:true,mouseoverRowCssClass:"l-grid-row-over",enabledSort:true,rowClsRender:null,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"\u5206\u7ec4",groupRender:null,totalRender:null,delayLoad:false,where:null,selectRowButtonOnly:false,selectable:true,whenRClickToSelect:false,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:true,detailToEdit:false,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,isSelected:null,frozen:true,frozenDetail:false,frozenCheckbox:true,detail:null,detailHeight:260,isShowDetailToggle:null,rownumbers:false,frozenRownumbers:true,rownumbersColWidth:26,colDraggable:false,rowDraggable:false,rowDraggingRender:null,autoCheckChildren:true,onRowDragDrop:null,rowHeight:28,headerRowHeight:28,toolbar:null,toolbarShowInLeft:true,headerImg:null,editorTopDiff:3,editorLeftDiff:1,editorHeightDiff:-1,unSetValidateAttr:true,autoFilter:false,rowSelectable:true,scrollToPage:false,scrollToAppend:true,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onBeforeSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onBeforeCancelEdit:null,onAfterSubmitEdit:null,onRowDragDrop:null,onGroupExtend:null,onGroupCollapse:null,onTreeExpand:null,onTreeCollapse:null,onTreeExpanded:null,onTreeCollapsed:null,onLoadData:null,onHeaderCellBulid:null};a.ligerDefaults.GridString={errorMessage:"\u53d1\u751f\u9519\u8bef",pageStatMessage:"\u663e\u793a\u4ece{from}\u5230{to}\uff0c\u603b {total} \u6761 \u3002\u6bcf\u9875\u663e\u793a\uff1a{pagesize}",pageTextMessage:"Page",loadingMessage:"\u52a0\u8f7d\u4e2d...",findTextMessage:"\u67e5\u627e",noRecordMessage:"\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u5b58\u5728",isContinueByDataChanged:"\u6570\u636e\u5df2\u7ecf\u6539\u53d8,\u5982\u679c\u7ee7\u7eed\u5c06\u4e22\u5931\u6570\u636e,\u662f\u5426\u7ee7\u7eed?",cancelMessage:"\u53d6\u6d88",saveMessage:"\u4fdd\u5b58",applyMessage:"\u5e94\u7528",draggingMessage:"{count}\u884c"};a.ligerDefaults.Grid_columns={id:null,name:null,totalSummary:null,display:null,headerRender:null,isAllowHide:true,isSort:false,type:null,columns:null,width:120,minWidth:80,format:null,align:"left",hide:false,editor:null,render:null,textField:null};a.ligerDefaults.Grid_editor={type:null,ext:null,onChange:null,onChanged:null};a.ligerMethos.Grid=a.ligerMethos.Grid||{};a.ligerDefaults.Grid.sorters=a.ligerDefaults.Grid.sorters||{};a.ligerDefaults.Grid.formatters=a.ligerDefaults.Grid.formatters||{};a.ligerDefaults.Grid.editors=a.ligerDefaults.Grid.editors||{};a.ligerDefaults.Grid.sorters.date=function(a,b){return a<b?-1:a>b?1:0};a.ligerDefaults.Grid.sorters["int"]=function(a,b){return parseInt(a)<parseInt(b)?-1:parseInt(a)>parseInt(b)?1:0};a.ligerDefaults.Grid.sorters["float"]=function(a,b){return parseFloat(a)<parseFloat(b)?-1:parseFloat(a)>parseFloat(b)?1:0};a.ligerDefaults.Grid.sorters.string=function(a,b){return!a?false:a.localeCompare(b)};a.ligerDefaults.Grid.formatters.date=function(a,c){function b(a,e){var f=this,g=this.options;if(isNaN(a))return null;var b=e,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};if(/(y+)/.test(b))b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length));for(var c in d)if((new RegExp("("+c+")")).test(b))b=b.replace(RegExp.$1,RegExp.$1.length==1?d[c]:("00"+d[c]).substr((""+d[c]).length));return b}if(!a)return"";if(typeof a=="string"&&/^\/Date/.test(a)){a=a.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+a)}if(a instanceof Date){var d=c.format||this.options.dateFormat||"yyyy-MM-dd";return b(a,d)}else return a.toString()};a.ligerDefaults.Grid.formatters.ref=function(b){return a.isArray(b)?b.length>1?b[1]:b[0]:b};a.ligerui.controls.Grid=function(b,c){a.ligerui.controls.Grid.base.constructor.call(this,b,c)};a.ligerui.controls.Grid.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return a.ligerMethos.Grid},_init:function(){a.ligerui.controls.Grid.base._init.call(this);var c=this,b=this.options;b.dataType=b.url?"server":"local";if(b.dataType=="local"){b.data=b.data||[];b.dataAction="local"}if(b.isScroll==false)b.height="auto";if(!b.frozen){b.frozenCheckbox=false;b.frozenDetail=false;b.frozenRownumbers=false}if(b.detailToEdit){b.enabledEdit=true;b.clickToEdit=false;b.detail={height:"auto",onShowDetail:function(e,d){a(d).addClass("l-grid-detailpanel-edit");c.beginEdit(e,function(){var c=a("<div class='l-editbox'></div>");c.width(120).height(b.rowHeight+1);c.appendTo(d);return c});function f(){a(d).parent().parent().remove();c.collapseDetail(e)}a("<div class='l-clear'></div>").appendTo(d);a("<div class='l-button'>"+b.saveMessage+"</div>").appendTo(d).click(function(){c.endEdit(e);f()});a("<div class='l-button'>"+b.applyMessage+"</div>").appendTo(d).click(function(){c.submitEdit(e)});a("<div class='l-button'>"+b.cancelMessage+"</div>").appendTo(d).click(function(){c.cancelEdit(e);f()})}}}if(b.tree){b.tree.childrenName=b.tree.childrenName||"children";b.tree.isParent=b.tree.isParent||function(a){var c=b.tree.childrenName in a;return!c?false:a[b.tree.childrenName]==null||!a[b.tree.childrenName]||a[b.tree.childrenName].length==0?false:true};b.tree.isExtend=b.tree.isExtend||function(a){return"isextend"in a&&a.isextend==false?false:true}}for(var d in liger.editors){var e=liger.editors[d];if(!e||d in b.editors)continue;b.editors[d]=liger.getEditor(a.extend({type:d,master:c},e))}},_render:function(){var c=this,d=this.options;c.grid=a(c.element);c.grid.addClass("l-panel");var b=[];b.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>");b.push("                    <div class='l-grid-loading'></div>");b.push("        <div class='l-panel-topbar' style='display:none'><div class='l-panel-topbarinner'></div></div><div class='l-clear'></div>");b.push("        <div class='l-panel-bwarp'>");b.push("            <div class='l-panel-body'>");b.push("                <div class='l-grid'>");b.push("                    <div class='l-grid-dragging-line'></div>");b.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");b.push("                  <div class='l-grid1'>");b.push("                      <div class='l-grid-header l-grid-header1'>");b.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");b.push("                      </div>");b.push("                      <div class='l-grid-body l-grid-body1'>");b.push("                      </div>");b.push("                  </div>");b.push("                  <div class='l-grid2'>");b.push("                      <div class='l-grid-header l-grid-header2'>");b.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");b.push("                      </div>");b.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>");b.push("                      </div>");b.push("                  </div>");b.push("                 </div>");b.push("              </div>");b.push("         </div>");b.push("         <div class='l-panel-bar'>");b.push("            <div class='l-panel-bbar-inner'>");b.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>");b.push("            <div class='l-bar-group l-bar-selectpagesize'></div>");b.push("                <div class='l-bar-separator'></div>");b.push("                <div class='l-bar-group'>");b.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>");b.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>");b.push("                </div>");b.push("                <div class='l-bar-separator'></div>");b.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>");b.push("                <div class='l-bar-separator'></div>");b.push("                <div class='l-bar-group'>");b.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>");b.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>");b.push("                </div>");b.push("                <div class='l-bar-separator'></div>");b.push("                <div class='l-bar-group'>");b.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>");b.push("                </div>");b.push("                <div class='l-bar-separator'></div>");b.push("                <div class='l-clear'></div>");b.push("            </div>");b.push("         </div>");c.grid.html(b.join(""));c.header=a(".l-panel-header:first",c.grid);c.body=a(".l-panel-body:first",c.grid);c.toolbar=a(".l-panel-bar:first",c.grid);c.popup=a(".l-grid-popup:first",c.grid);c.gridloading=a(".l-grid-loading:first",c.grid);c.draggingline=a(".l-grid-dragging-line",c.grid);c.topbar=a(".l-panel-topbarinner:first",c.grid);c.gridview=a(".l-grid:first",c.grid);c.gridview.attr("id",c.id+"grid");c.gridview1=a(".l-grid1:first",c.gridview);c.gridview2=a(".l-grid2:first",c.gridview);c.gridheader=a(".l-grid-header:first",c.gridview2);c.gridbody=a(".l-grid-body:first",c.gridview2);if(d.autoFilter){var f={text:"\u9ad8\u7ea7\u67e5\u8be2",gridid:c.id,click:function(){c.showFilter()},icon:"search2"};if(d.toolbar&&d.toolbar.items)d.toolbar.items.push(f);else d.toolbar={items:[f]}}c.f={};c.f.gridheader=a(".l-grid-header:first",c.gridview1);c.f.gridbody=a(".l-grid-body:first",c.gridview1);c.currentData=null;c.changedCells={};c.editors={};c.editor={editing:false};c.cacheData={};d.height=="auto"&&c.bind("SysGridHeightChanged",function(){c.enabledFrozen()&&c.gridview.height(Math.max(c.gridview1.height(),c.gridview2.height()))});var e=a.extend({},d);this._bulid();this._setColumns(d.columns);delete e.columns;delete e.data;delete e.url;c.set(e);if(!d.delayLoad)if(d.url)c.set({url:d.url});else d.data&&c.set({data:d.data})},_setFrozen:function(a){if(a)this.grid.addClass("l-frozen");else this.grid.removeClass("l-frozen")},_setCssClass:function(a){this.grid.addClass(a)},_setLoadingMessage:function(a){this.gridloading.html(a)},_setToolbar:function(b){var c=this,e=this.options;if(b&&a.fn.ligerToolBar){c.topbar.parent().show();c.toolbarManager=c.topbar.ligerToolBar(b);if(b.title){var d=a("<div class='l-panel-topbartitle'><span>"+b.title+"</span></div>");if(b.icon){d.append("<img class='l-panel-topbaricon' src='"+b.icon+"'></img>");d.addClass("l-panel-topbartitle-hasicon")}c.topbar.parent().append(d)}e.toolbarShowInLeft&&c.topbar.addClass("l-panel-topbarinner-left")}else c.topbar.parent().remove()},isHorizontalScrollShowed:function(){var b=this,a=b.gridbody.find(".l-grid-body-inner:first");return!a.length?false:b.gridbody.width()-20<a.width()},_setHeight:function(c){var b=this,d=this.options;b.unbind("SysGridHeightChanged");if(c=="auto"){b.bind("SysGridHeightChanged",function(){b.enabledFrozen()&&b.gridview.height(Math.max(b.gridview1.height(),b.gridview2.height()))});return}c=b._calculateGridBodyHeight(c);if(c>0){b.gridbody.height(c);b.f.gridbody.height(c);b.f.gridbody.height(c);var f=d.headerRowHeight*(b._columnMaxLevel-1)+d.headerRowHeight-1;b.gridview.height(c+f)}b._updateHorizontalScrollStatus.ligerDefer(b,10)},_calculateGridBodyHeight:function(b){var d=this,c=this.options;if(typeof b=="string"&&b.indexOf("%")>0)if(c.inWindow)b=a(window).height()*parseInt(b)*.01;else b=d.grid.parent().height()*parseInt(b)*.01;if(c.title)b-=24;if(c.usePager&&c.pagerRender||!c.scrollToPage)b-=d.toolbar.outerHeight();if(c.totalRender)b-=25;if(c.toolbar)b-=d.topbar.outerHeight();var e=c.headerRowHeight*(d._columnMaxLevel-1)+c.headerRowHeight-1;b-=e||0;return b},_updateHorizontalScrollStatus:function(){var a=this,b=this.options;if(a.isHorizontalScrollShowed())a.gridview.addClass("l-grid-hashorizontal");else a.gridview.removeClass("l-grid-hashorizontal")},_updateFrozenWidth:function(){var a=this,c=this.options;if(a.enabledFrozen()){a.gridview1.width(a.f.gridtablewidth);var b=a.gridview.width()-a.f.gridtablewidth;a.gridview2.css({left:a.f.gridtablewidth});b>0&&a.gridview2.css({width:b})}},_setWidth:function(){var a=this,c=this.options;a.enabledFrozen()&&a._onResize()},_setUrl:function(a){this.options.url=a;if(a){this.options.dataType="server";this.loadData(true)}else this.options.dataType="local"},removeParm:function(c){var d=this,a=d.get("parms");if(!a)a={};if(a instanceof Array)b(a,function(a){return a.name==c});else delete a[c];d.set("parms",a)},setParm:function(c,d){var e=this,a=e.get("parms");if(!a)a={};if(a instanceof Array){b(a,function(a){return a.name==c});a.push({name:c,value:d})}else a[c]=d;e.set("parms",a)},_setData:function(){this.loadData(this.options.data);this.trigger("afterSetData")},loadData:function(d,k){var b=this,c=this.options;b.loading=true;b.trigger("loadData");var g=null,h=true;if(typeof d=="function"){g=d;if(b.lastData)b.data=b.lastData;else{b.data=b.currentData;if(!b.data)b.data={};if(!b.data[c.root])b.data[c.root]=[];b.lastData=b.data}h=false}else if(typeof d=="boolean")h=d;else if(typeof d=="object"&&d){h=false;c.dataType="local";c.data=d}else if(typeof d=="number")c.newPage=d;if(!c.newPage)c.newPage=1;if(c.dataAction=="server")if(!c.sortOrder)c.sortOrder="asc";var f=[];if(c.parms){var e=a.isFunction(c.parms)?c.parms():c.parms;if(e.length){a(e).each(function(){f.push({name:this.name,value:this.value})});for(var i=e.length-1;i>=0;i--)e[i].temp&&e.splice(i,1)}else if(typeof e=="object")for(var j in e)f.push({name:j,value:e[j]})}if(c.dataAction=="server"){if(c.usePager){f.push({name:c.pageParmName,value:c.newPage});f.push({name:c.pagesizeParmName,value:c.pageSize})}if(c.sortName){f.push({name:c.sortnameParmName,value:c.sortName});f.push({name:c.sortorderParmName,value:c.sortOrder})}}a(".l-bar-btnload span",b.toolbar).addClass("l-disabled");if(c.dataType=="local"){b.filteredData=a.extend(true,{},c.data||b.currentData);if(g)b.filteredData[c.root]=b._searchData(b.filteredData[c.root],g);if(c.usePager)b.currentData=b._getCurrentPageData(b.filteredData);else b.currentData=b.filteredData;b._convertTreeData();b._showData()}else if(c.dataAction=="local"&&!h){if(b.data&&b.data[c.root]){b.filteredData=b.data;if(g)b.filteredData[c.root]=b._searchData(b.filteredData[c.root],g);b.currentData=b._getCurrentPageData(b.filteredData);b._convertTreeData();b._showData()}}else b.loadServerData(f,g,k);b.loading=false},_convertTreeData:function(){var b=this,a=this.options;if(a.tree&&a.tree.idField&&a.tree.parentIDField){b.currentData[a.root]=b.arrayToTree(b.currentData[a.root],a.tree.idField,a.tree.parentIDField);b.currentData[a.record]=b.currentData[a.root].length}},loadServerData:function(i,h,g){var b=this,c=this.options,d=c.url;if(a.isFunction(d))d=d.call(b);var f=a.isFunction(c.urlParms)?c.urlParms.call(b):c.urlParms;if(f)for(name in f){d+=d.indexOf("?")==-1?"?":"&";d+=name+"="+f[name]}var e={type:c.method,url:d,data:i,async:c.async,dataType:"json",beforeSend:function(){if(b.hasBind("loading"))b.trigger("loading");else b.toggleLoading(true)},success:function(a){b.trigger("success",[a,b]);if(!a||!a[c.root]||!a[c.root].length){b.currentData=b.data={};b.currentData[c.root]=b.data[c.root]=[];if(a&&a[c.record])b.currentData[c.record]=b.data[c.record]=a[c.record];else b.currentData[c.record]=b.data[c.record]=0;b._convertTreeData();b._showData(g);return}b.data=a;if(b.data[c.record]!=null)b.cacheData.records=b.data[c.record];if(c.dataAction=="server"){b.currentData=b.data;if(b.currentData[c.record]==null&&b.cacheData.records)b.currentData[c.record]=b.cacheData.records}else{b.filteredData=b.data;if(h)b.filteredData[c.root]=b._searchData(b.filteredData[c.root],h);if(c.usePager)b.currentData=b._getCurrentPageData(b.filteredData);else b.currentData=b.filteredData;b.sortedData=b.currentData;}b._convertTreeData();b._showData.ligerDefer(b,10,[g])},complete:function(){b.trigger("complete",[b]);if(b.hasBind("loaded"))b.trigger("loaded",[b]);else b.toggleLoading.ligerDefer(b,10,[false])},error:function(d,f,e){b.currentData=b.data={};b.currentData[c.root]=b.data[c.root]=[];b.currentData[c.record]=b.data[c.record]=0;b.toggleLoading.ligerDefer(b,10,[false]);a(".l-bar-btnload span",b.toolbar).removeClass("l-disabled");b.trigger("error",[d,f,e])}};if(c.contentType)e.contentType=c.contentType;if(c.contentType=="application/json"&&typeof parms!="string")e.data=j(i);a.ajax(e);function j(e){if(!e)return"null";var b=e,d={};if(a.isArray(b))for(var c=0;c<b.length;c++)d[b[c].name]=b[c].value;else d=b;return liger.toJSON(d)}},toggleLoading:function(a){this.gridloading[a?"show":"hide"]()},_createEditor:function(d,e,c,g,f){var b=d.create.call(this,e,c);d.setValue&&d.setValue.call(this,b,c.value,c);if(c.column.editor&&c.column.editor.initSelect){b.element&&a(b.element).is(":text")&&a(b.element).select();if(b instanceof jQuery)if(b.is(":text"))b.select();else b.find(":text").select()}d.setText&&c.column.textField&&d.setText.call(this,b,c.text,c);d.resize&&d.resize.call(this,b,g,f,c);return b},beginEdit:function(l,f){var c=this,h=this.options;if(!h.enabledEdit)return;var b=c.getRow(l);if(b._editing)return;if(c.trigger("beginEdit",{record:b,rowindex:b.__index})==false)return;c.editors[b.__id]={};b._editing=true;c.reRender({rowdata:b});f=f||function(b,d){var f=c.getCellObj(b,d),e=a(f).html("");c.setCellEditing(b,d,true);return e};for(var g=0,o=c.columns.length;g<o;g++){var d=c.columns[g];if(!d.name||!d.editor||!d.editor.type||!h.editors[d.editor.type])continue;var j=h.editors[d.editor.type],i={record:b,value:c._getValueByName(b,d.name),column:d,rowindex:b.__index,grid:c},e=f(b,d),n=e.width(),m=e.height(),k=c._createEditor(j,e,i,n,m);c.editors[b.__id][d.__id]={editor:j,input:k,editParm:i,container:e}}c.trigger("afterBeginEdit",{record:b,rowindex:b.__index})},cancelEdit:function(d){var a=this;if(d==undefined)for(var f in a.editors)a.cancelEdit(f);else{var b=a.getRow(d);if(!a.editors[b.__id])return;if(a.trigger("beforeCancelEdit",{record:b,rowindex:b.__index})==false)return;for(var e in a.editors[b.__id]){var c=a.editors[b.__id][e];c.editor.destroy&&c.editor.destroy(c.input,c.editParm)}delete a.editors[b.__id];delete b._editing;a.reRender({rowdata:b})}},addEditRow:function(a,b){this.submitEdit();a=this.add(a);this.beginEdit(a,b)},submitEdit:function(f){var b=this,i=this.options;if(f==undefined)for(var h in b.editors)b.submitEdit(h);else{var a=b.getRow(f),d={};if(!a||!b.editors[a.__id])return;for(var g in b.editors[a.__id]){var c=b.editors[a.__id][g],e=c.editParm.column;if(e.name)d[e.name]=c.editor.getValue(c.input,c.editParm);if(e.textField&&c.editor.getText)d[e.textField]=c.editor.getText(c.input,c.editParm)}if(b.trigger("beforeSubmitEdit",{record:a,rowindex:a.__index,newdata:d})==false)return false;b.updateRow(a,d);b.trigger("afterSubmitEdit",{record:a,rowindex:a.__index,newdata:d})}},_enabledEditByCell:function(b){var c=this,d=this.options,a=c.getColumn(b);return!a?false:a.editor&&a.editor.type},endEditToNext:function(){var c=this,k=this.options,g=c.editor,b=null,d=null;if(g){var e=g.editParm,h=e.column,j=a.inArray(h,c.columns),i=c.getCellObj(e.record,e.column);d=a(i);b=d.next();if(!b.length)b=f();if(b.length)while(!c._enabledEditByCell(b.get(0))){d=b;b=b.next();if(!b.length)b=f()}function f(){return d.parent("tr").next(".l-grid-row").find("td:first")}}c.endEdit();b&&b.length&&c._applyEditor(b.get(0))},endEdit:function(d){var a=this,g=this.options;if(a.editor.editing){var b=a.editor;a.trigger("sysEndEdit",[a.editor.editParm]);a.trigger("endEdit",[a.editor.editParm]);b.editor.destroy&&b.editor.destroy(b.input,b.editParm);a.editor.container.remove();a.reRender({rowdata:a.editor.editParm.record,column:a.editor.editParm.column});a.trigger("afterEdit",[a.editor.editParm]);a.editor={editing:false}}else if(d!=undefined){var c=a.getRow(d);if(!a.editors[c.__id])return;if(a.submitEdit(d)==false)return false;for(var e in a.editors[c.__id]){var b=a.editors[c.__id][e];b.editor.destroy&&b.editor.destroy(b.input,b.editParm)}delete a.editors[c.__id];delete c._editing;a.trigger("afterEdit",{record:c,rowindex:c.__index})}else for(var f in a.editors)a.endEdit(f);a._fixHeight.ligerDefer(a,10)},setWidth:function(a){return this._setWidth(a)},setHeight:function(a){return this._setHeight(a)},enabledCheckbox:function(){return this.options.checkbox?true:false},enabledFrozen:function(){var b=this,a=this.options;if(!a.frozen)return false;var d=b.columns||[];if(b.enabledDetail()&&a.frozenDetail||b.enabledCheckbox()&&a.frozenCheckbox||a.frozenRownumbers&&a.rownumbers)return true;for(var c=0,e=d.length;c<e;c++)if(d[c].frozen)return true;this._setFrozen(false);return false},enabledDetailEdit:function(){return!this.enabledDetail()?false:this.options.detailToEdit?true:false},enabledDetail:function(){return this.options.detail&&this.options.detail.onShowDetail?true:false},enabledGroup:function(){return this.options.groupColumnName?true:false},deleteSelectedRow:function(){if(!this.selected)return;for(var b in this.selected){var a=this.selected[b];a.__id in this.records&&this._deleteData.ligerDefer(this,10,[a])}this.reRender.ligerDefer(this,20)},removeRange:function(c){var b=this,d=this.options;a.each(c,function(){b._removeData(this)});b.reRender()},remove:function(b){var a=this,d=this.options,c=a.getRow(b);a._removeData(b);a.reRender()},deleteRange:function(c){var b=this,d=this.options;a.each(c,function(){b._deleteData(this)});b.reRender()},deleteRow:function(c){var a=this,d=this.options,b=a.getRow(c);if(!b)return;a._deleteData(b);a.reRender();a.isDataChanged=true},_deleteData:function(f){var a=this,e=this.options,b=a.getRow(f);b[e.statusName]="delete";if(e.tree){var c=a.getChildren(b,true);if(c)for(var d=0,g=c.length;d<g;d++)c[d][e.statusName]="delete"}a.deletedRows=a.deletedRows||[];a.deletedRows.push(b);a._removeSelected(b)},updateCell:function(e,i,h){var b=this,k=this.options,d,f,c;if(typeof e=="string"){for(var g=0,n=b.columns.length;g<n;g++)b.columns[g].name==e&&b.updateCell(g,i,h);return}if(typeof e=="number"){d=b.columns[e];c=b.getRow(h);f=b.getCellObj(c,d)}else if(typeof e=="object"&&e.__id){d=e;c=b.getRow(h);f=b.getCellObj(c,d)}else{f=e;var j=f.id.split("|"),l=j[j.length-1];d=b._columns[l];var m=a(f).parent();c=c||b.getRow(m[0])}if(i!=null&&d.name){b._setValueByName(c,d.name,i);if(c[k.statusName]!="add")c[k.statusName]="update";b.isDataChanged=true}b.reRender({rowdata:c,column:d})},addRows:function(c,e,d,b){var f=this,g=this.options;a(c).each(function(){f.addRow(this,e,d,b)})},_createRowid:function(){return"r"+(1e3+this.recordNumber)},_isRowId:function(a){return a in this.records},_addNewRecord:function(a,d,e){var b=this,f=this.options;b.recordNumber++;a.__id=b._createRowid();a.__previd=d;if(d&&d!=-1){var c=b.records[d];if(c.__nextid&&c.__nextid!=-1){var g=b.records[c.__nextid];if(g)g.__previd=a.__id}c.__nextid=a.__id;a.__index=c.__index+1}else a.__index=0;if(f.tree){if(e&&e!=-1){var h=b.records[e];a.__pid=e;a.__level=h.__level+1}else{a.__pid=-1;a.__level=1}a.__hasChildren=a[f.tree.childrenName]?true:false}a[f.statusName]=a[f.statusName]||"nochanged";b.rows[a.__index]=a;b.records[a.__id]=a;return a},_getRows:function(d){var e=this,c=this.options,a=[];function b(d){if(!d||!d.length)return;for(var e=0,g=d.length;e<g;e++){var f=d[e];a.push(f);f[c.tree.childrenName]&&b(f[c.tree.childrenName])}}b(d);return a},_updateGridData:function(){var a=this,b=this.options;a.recordNumber=0;a.rows=[];a.records={};var c=-1;function d(f,h){if(!f||!f.length)return;for(var g=0,i=f.length;g<i;g++){var e=f[g];a.formatRecord(e);if(e[b.statusName]=="delete")continue;a._addNewRecord(e,c,h);c=e.__id;e.__hasChildren&&d(e[b.tree.childrenName],e.__id)}}d(a.currentData[b.root],-1);return a.rows},_moveData:function(i,j,h){var c=this,k=this.options,d=c.getRow(i),g=c.getRow(j),e,f,b=c._getParentChildren(d);e=a.inArray(d,b);b.splice(e,1);b=c._getParentChildren(g);f=a.inArray(g,b);b.splice(f+(h?1:0),0,d)},move:function(b,c,a){this._moveData(b,c,a);this.reRender()},moveRange:function(a,c,b){for(var d in a)this._moveData(a[d],c,b);this.reRender()},up:function(g){var b=this,h=this.options,c=b.getRow(g),e=b._getParentChildren(c),d=a.inArray(c,e);if(d==-1||d==0)return;b.move(c,e[d-1],false);var f=b.getSelected();f&&b.select(f)},down:function(g){var b=this,h=this.options,d=b.getRow(g),c=b._getParentChildren(d),e=a.inArray(d,c);if(e==-1||e==c.length-1)return;b.move(d,c[e+1],true);var f=b.getSelected();f&&b.select(f)},addRow:function(b,h,g,f){var c=this,a=this.options;b=b||{};c._addData(b,f,h,g);c.reRender();b[a.statusName]="add";if(a.tree){var d=c.getChildren(b,true);if(d)for(var e=0,i=d.length;e<i;e++)d[e][a.statusName]="add"}c.isDataChanged=true;a.total=a.total?a.total+1:1;a.pageCount=Math.ceil(a.total/a.pageSize);c._buildPager();c.trigger("SysGridHeightChanged");c.trigger("afterAddRow",[b]);return b},updateRow:function(f,e){var c=this,d=this.options,b=c.getRow(f);c.isDataChanged=true;a.extend(b,e||{});if(b[d.statusName]!="add")b[d.statusName]="update";c.reRender.ligerDefer(c,10,[{rowdata:b}]);return b},setCellEditing:function(e,c,h){var d=this,k=this.options,j=d.getCellObj(e,c),f=h?"addClass":"removeClass";a(j)[f]("l-grid-row-cell-editing");if(e.__id!=0){var b=a(d.getRowObj(e.__id)).prev();if(!b.length||b.length<=0||b[0].id==null||b[0].id=="")return;var i=d.getRow(b[0]),g=d.getCellObj(i,c);if(!g)return;a(g)[f]("l-grid-row-cell-editing-topcell")}if(c.__previd!=-1&&c.__previd!=null){var g=a(d.getCellObj(e,c)).prev();a(g)[f]("l-grid-row-cell-editing-leftcell")}},reRender:function(e){var b=this,g=this.options;e=e||{};var d=e.rowdata,c=e.column,h=e.totalOnly;if(c&&(c.isdetail||c.ischeckbox))return;if(d&&d[g.statusName]=="delete")return;if(h)a(b.columns).each(function(){f(this)});else if(d&&c){var j=b.getCellObj(d,c);a(j).html(b._getCellHtml(d,c));!c.issystem&&b.setCellEditing(d,c,false)}else if(d)a(b.columns).each(function(){b.reRender({rowdata:d,column:this})});else if(c){for(var i in b.records)b.reRender({rowdata:b.records[i],column:c});f(c)}else b._showData();function f(d){if(!d.totalSummary)return;for(var c=0;c<b.totalNumber;c++){var e=document.getElementById(b.id+"|total"+c+"|"+d.__id);a("div:first",e).html(b._getTotalCellContent(d,b.groups&&b.groups[c]?b.groups[c]:b.currentData[g.root]))}}},getData:function(d,b){var c=this,h=this.options,e=[];if(b==undefined)b=true;for(var g in c.records){var f=a.extend(true,{},c.records[g]);(f[h.statusName]==d||d==undefined)&&e.push(c.formatRecord(f,b))}return e},formatRecord:function(a,b){delete a.__id;delete a.__previd;delete a.__nextid;delete a.__index;if(this.options.tree){delete a.__pid;delete a.__level;delete a.__hasChildren}if(b)delete a[this.options.statusName];return a},getUpdated:function(){return this.getData("update",true)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",true)},getChanges:function(){var c=this,d=this.options,b=[];this.deletedRows&&a(this.deletedRows).each(function(){var d=a.extend(true,{},this);b.push(c.formatRecord(d,false))});a.merge(b,c.getData("update",false));a.merge(b,c.getData("add",false));return b},getColumn:function(a){var b=this,e=this.options;if(typeof a=="string")return b._isColumnId(a)?b._columns[a]:b.columns[parseInt(a)];else if(typeof a=="number")return b.columns[a];else if(typeof a=="object"&&a.nodeType==1){var c=a.id.split("|"),d=c[c.length-1];return b._columns[d]}return a},getColumnByName:function(b){var a=this,c=this.options;for(i=0;i<a.columns.length;i++)if(a.columns[i].name==b)return a.columns[i];return null},getColumnType:function(b){var a=this,c=this.options;for(i=0;i<a.columns.length;i++)if(a.columns[i].name==b)return a.columns[i].type?a.columns[i].type:"string";return null},isTotalSummary:function(){for(var b=this,c=this.options,a=0;a<b.columns.length;a++)if(b.columns[a].totalSummary)return true;return false},getColumns:function(c){var d=this,f=this.options,b=[];for(var e in d._columns){var a=d._columns[e];if(c!=undefined)a.__level==c&&b.push(a);else a.__leaf&&b.push(a)}return b},changeSort:function(c,e){var a=this,b=this.options;if(a.loading)return true;if(b.dataAction=="local"){var d=a.getColumnType(c);if(!a.sortedData)a.sortedData=a.filteredData;if(!a.sortedData||!a.sortedData[b.root])return;if(b.sortName==c)a.sortedData[b.root].reverse();else a.sortedData[b.root].sort(function(b,e){return a._compareData(b,e,c,d)});if(b.usePager)a.currentData=a._getCurrentPageData(a.sortedData);else a.currentData=a.sortedData;a._showData()}b.sortName=c;b.sortOrder=e;b.dataAction=="server"&&a.loadData(b.where)},changePage:function(f){var c=this,b=this.options;if(c.loading)return true;if(b.dataAction!="local"&&c.isDataChanged&&!confirm(b.isContinueByDataChanged))return false;b.pageCount=parseInt(a(".pcontrol span",c.toolbar).html());switch(f){case"first":if(b.page==1)return;b.newPage=1;break;case"prev":if(b.page==1)return;if(b.page>1)b.newPage=parseInt(b.page)-1;break;case"next":if(b.page>=b.pageCount)return;b.newPage=parseInt(b.page)+1;break;case"last":if(b.page>=b.pageCount)return;b.newPage=b.pageCount;break;case"input":var d=parseInt(a(".pcontrol input",c.toolbar).val());if(isNaN(d))d=1;if(d<1)d=1;else if(d>b.pageCount)d=b.pageCount;a(".pcontrol input",c.toolbar).val(d);b.newPage=d}if(b.newPage==b.page)return false;if(b.newPage==1){a(".l-bar-btnfirst span",c.toolbar).addClass("l-disabled");a(".l-bar-btnprev span",c.toolbar).addClass("l-disabled")}else{a(".l-bar-btnfirst span",c.toolbar).removeClass("l-disabled");a(".l-bar-btnprev span",c.toolbar).removeClass("l-disabled")}if(b.newPage==b.pageCount){a(".l-bar-btnlast span",c.toolbar).addClass("l-disabled");a(".l-bar-btnnext span",c.toolbar).addClass("l-disabled")}else{a(".l-bar-btnlast span",c.toolbar).removeClass("l-disabled");a(".l-bar-btnnext span",c.toolbar).removeClass("l-disabled")}c.trigger("changePage",[b.newPage]);if(b.dataAction=="server"){if(!b.parms)b.parms=[];if(a.isArray(b.parms))b.parms.push({name:"changepage",value:"1",temp:true});else b.parms.changepage="1";c.loadData(b.where)}else{c.currentData=c._getCurrentPageData(c.filteredData);if(b.tree){var e=b.tree.childrenName;a(c.filteredData[b.root]).each(function(b,a){if(a[e])a[e]=[]});c._convertTreeData()}c._showData()}},getSelectedRow:function(){for(var b in this.selected){var a=this.selected[b];if(a.__id in this.records)return a}return null},getSelectedRows:function(){var a=[];for(var c in this.selected){var b=this.selected[c];b.__id in this.records&&a.push(b)}return a},getSelectedRowObj:function(){for(var b in this.selected){var a=this.selected[b];if(a.__id in this.records)return this.getRowObj(a)}return null},getSelectedRowObjs:function(){var a=[];for(var c in this.selected){var b=this.selected[c];b.__id in this.records&&a.push(this.getRowObj(b))}return a},getCellObj:function(c,a){var b=this.getRow(c);a=this.getColumn(a);return document.getElementById(this._getCellDomId(b,a))},getRowObj:function(a,c){var b=this,d=this.options;return a==null?null:typeof a=="string"?b._isRowId(a)?document.getElementById(b.id+(c?"|1|":"|2|")+a):document.getElementById(b.id+(c?"|1|":"|2|")+b.rows[parseInt(a)].__id):typeof a=="number"?document.getElementById(b.id+(c?"|1|":"|2|")+b.rows[a].__id):typeof a=="object"&&a.__id?b.getRowObj(a.__id,c):a},getRow:function(a){var b=this,c=this.options;return a==null?null:typeof a=="string"?b._isRowId(a)?b.records[a]:b.rows[parseInt(a)]:typeof a=="number"?b.rows[parseInt(a)]:typeof a=="object"&&a.nodeType==1&&!a.__id?b._getRowByDomId(a.id):a},_setColumnVisible:function(b,c){var f=this,g=this.options;if(!c){b._hide=false;document.getElementById(b.__domid).style.display="";if(b.__pid!=-1){var a=f._columns[b.__pid];if(a._hide){document.getElementById(a.__domid).style.display="";this._setColumnVisible(a,c)}}}else{b._hide=true;document.getElementById(b.__domid).style.display="none";if(b.__pid!=-1){for(var e=true,a=this._columns[b.__pid],d=0;a&&d<a.columns.length;d++)if(!a.columns[d]._hide){e=false;break}if(e){a._hide=true;document.getElementById(a.__domid).style.display="none";this._setColumnVisible(a,c)}}}},toggleCol:function(d,e,k){var b=this,p=this.options,c;if(typeof d=="number")c=b.columns[d];else if(typeof d=="object"&&d.__id)c=d;else if(typeof d=="string")if(b._isColumnId(d))c=b._columns[d];else{a(b.columns).each(function(){this.name==d&&b.toggleCol(this,e,k)});return}if(!c)return;var l=c.__leafindex;if(l==1)return;var j=document.getElementById(c.__domid);if(!j)return;j=a(j);var f=[];for(var g in b.rows){var n=b.getCellObj(b.rows[g],c);n&&f.push(n)}for(var g=0;g<b.totalNumber;g++){var m=document.getElementById(b.id+"|total"+g+"|"+c.__id);m&&f.push(m)}var o=c._width;if(e&&c._hide){b._setColumnVisible(c,false);a(f).show()}else if(!e&&!c._hide){b._setColumnVisible(c,true);a(f).hide()}if(c.frozen){a("div:first",b.f.gridheader).width(b.f.gridtablewidth);a("div:first",b.f.gridbody).width(b.f.gridtablewidth)}else{a("div:first",b.gridheader).width(b.gridtablewidth+40);if(b.gridtablewidth)a("div:first",b.gridbody).width(b.gridtablewidth);else a("div:first",b.gridbody).css("width","auto")}b._updateFrozenWidth();!k&&a(":checkbox[columnindex="+l+"]",b.popup).each(function(){this.checked=e;if(a.fn.ligerCheckBox){var b=a(this).ligerGetCheckBoxManager();b&&b.updateStyle()}});var h=b.gridview1.width(),i=b.gridview.width();if(i-h<=0)b.gridview2.css({width:"auto"});else b.gridview2.css({width:i-h});b._f_gridLayout_autoAdapt(i-h)},setColumnWidth:function(e,d){var b=this,n=this.options;if(!d)return;d=parseInt(d,10);var c;if(typeof e=="number")c=b.columns[e];else if(typeof e=="object"&&e.__id)c=e;else if(typeof e=="string")if(b._isColumnId(e))c=b._columns[e];else{a(b.columns).each(function(){this.name==e&&b.setColumnWidth(this,d)});return}if(!c)return;var h=n.minColumnWidth;if(c.minWidth)h=c.minWidth;d=d<h?h:d;var k=d-c._width;if(b.trigger("beforeChangeColumnWidth",[c,d])==false)return;c._width=d;if(c.frozen){b.f.gridtablewidth+=k;a("div:first",b.f.gridheader).width(b.f.gridtablewidth);a("div:first",b.f.gridbody).width(b.f.gridtablewidth)}else{b.gridtablewidth+=k;a("div:first",b.gridheader).width(b.gridtablewidth+40);a("div:first",b.gridbody).width(b.gridtablewidth)}a(document.getElementById(c.__domid)).css("width",d);var i=[];for(var g in b.records){var m=b.getCellObj(b.records[g],c);m&&i.push(m);if(!b.enabledDetailEdit()&&b.editors[g]&&b.editors[g][c.__id]){var f=b.editors[g][c.__id];f.editor.resize&&f.editor.resize(f.input,d,f.container.height(),f.editParm)}}for(var j=0;j<b.totalNumber;j++){var l=document.getElementById(b.id+"|total"+j+"|"+c.__id);l&&i.push(l)}a(i).css("width",d).find("> div.l-grid-row-cell-inner:first").css("width",d-8);b._updateFrozenWidth();b._updateHorizontalScrollStatus.ligerDefer(b,10);b.trigger("afterChangeColumnWidth",[c,d])},changeHeaderText:function(b,e){var d=this,h=this.options,c;if(typeof b=="number")c=d.columns[b];else if(typeof b=="object"&&b.__id)c=b;else if(typeof b=="string")if(d._isColumnId(b))c=d._columns[b];else{a(d.columns).each(function(){this.name==b&&d.changeHeaderText(this,e)});return}if(!c)return;var f=c.__leafindex,g=document.getElementById(c.__domid);a(".l-grid-hd-cell-text",g).html(e);h.allowHideColumn&&a(":checkbox[columnindex="+f+"]",d.popup).parent().next().html(e)},changeCol:function(k,l,j){var c=this,h=this.options;if(!k||!l)return;var b=c.getColumn(k),e=c.getColumn(l);b.frozen=e.frozen;var f,i,d=b.__pid==-1?h.columns:c._columns[b.__pid].columns,g=e.__pid==-1?h.columns:c._columns[e.__pid].columns;f=a.inArray(b,d);i=a.inArray(e,g);var m=d==g,n=b.__level==e.__level;g.splice(i+(j?1:0),0,b);if(!m)d.splice(f,1);else if(j)d.splice(f,1);else d.splice(f+1,1);c._setColumns(h.columns);c.reRender()},collapseDetail:function(e){var b=this,i=this.options,d=b.getRow(e);if(!d)return;for(var c=0,h=b.columns.length;c<h;c++)if(b.columns[c].isdetail){var g=b.getRowObj(d),f=b.getCellObj(d,b.columns[c]);a(g).next("tr.l-grid-detailpanel").hide();a(".l-grid-row-cell-detailbtn:first",f).removeClass("l-open");b.trigger("SysGridHeightChanged");return}},extendDetail:function(e){var b=this,i=this.options,d=b.getRow(e);if(!d)return;for(var c=0,h=b.columns.length;c<h;c++)if(b.columns[c].isdetail){var g=b.getRowObj(d),f=b.getCellObj(d,b.columns[c]);a(g).next("tr.l-grid-detailpanel").show();a(".l-grid-row-cell-detailbtn:first",f).addClass("l-open");b.trigger("SysGridHeightChanged");return}},getParent:function(c){var b=this,d=this.options;if(!d.tree)return null;var a=b.getRow(c);return!a?null:a.__pid in b.records?b.records[a.__pid]:null},getChildren:function(e,f){var g=this,a=this.options;if(!a.tree)return null;var c=g.getRow(e);if(!c)return null;var d=[];function b(c){if(c[a.tree.childrenName])for(var e=0,h=c[a.tree.childrenName].length;e<h;e++){var g=c[a.tree.childrenName][e];if(g[a.statusName]=="delete")continue;d.push(g);f&&b(g)}}b(c);return d},isLeaf:function(b){var c=this,d=this.options,a=c.getRow(b);return!a?void 0:a.__hasChildren?false:true},hasChildren:function(c){var d=this,b=this.options,a=this.getRow(c);return!a?void 0:a[b.tree.childrenName]&&a[b.tree.childrenName].length?true:false},existRecord:function(a){for(var b in this.records)if(this.records[b]==a)return true;return false},_removeSelected:function(e){var b=this,i=this.options;if(i.tree){var c=b.getChildren(e,true);if(c)for(var d=0,h=c.length;d<h;d++){var f=a.inArray(c[d],b.selected);f!=-1&&b.selected.splice(f,1)}}var g=a.inArray(e,b.selected);g!=-1&&b.selected.splice(g,1)},_getParentChildren:function(e){var a=this,d=this.options,c=a.getRow(e),b;if(d.tree&&a.existRecord(c)&&c.__pid in a.records)b=a.records[c.__pid][d.tree.childrenName];else b=a.currentData[d.root];return b},_removeData:function(b){var e=this,f=this.options,c=e._getParentChildren(b),d=a.inArray(b,c);d!=-1&&c.splice(d,1);e._removeSelected(b)},_addData:function(g,e,f,i){var c=this,b=this.options;if(!c.currentData)c.currentData={};if(!c.currentData[b.root])c.currentData[b.root]=[];var d=c.currentData[b.root];if(f){if(b.tree)if(e)d=e[b.tree.childrenName];else if(f.__pid in c.records)d=c.records[f.__pid][b.tree.childrenName];var h=a.inArray(f,d);d.splice(h==-1?-1:h+(i?0:1),0,g)}else{if(b.tree&&e)d=e[b.tree.childrenName];d.push(g)}},_appendData:function(a,c,e,d){var b=this,f=this.options;a[f.statusName]="update";b._removeData(a);b._addData(a,c,e,d)},appendRange:function(g,c,e,d){var b=this,h=this.options,f=false;a.each(g,function(g,a){if(a.__id&&b.existRecord(a)){b.isLeaf(c)&&b.upgrade(c);b._appendData(a,c,e,d);f=true}else b.appendRow(a,c,e,d)});f&&b.reRender()},appendRow:function(d,c,f,e){var b=this,g=this.options;if(a.isArray(d)){b.appendRange(d,c,f,e);return}if(d.__id&&b.existRecord(d)){b._appendData(d,c,f,e);b.reRender();return}c&&b.isLeaf(c)&&b.upgrade(c);b.addRow(d,f,e?true:false,c)},upgrade:function(f){var c=this,d=this.options,b=c.getRow(f);if(!b||!d.tree)return;b[d.tree.childrenName]=b[d.tree.childrenName]||[];b.__hasChildren=true;var e=[c.getRowObj(b)];c.enabledFrozen()&&e.push(c.getRowObj(b,true));a("> td > div > .l-grid-tree-space:last",e).addClass("l-grid-tree-link l-grid-tree-link-open")},demotion:function(g){var b=this,i=this.options,c=b.getRow(g);if(!c||!i.tree)return;var f=[b.getRowObj(c)];b.enabledFrozen()&&f.push(b.getRowObj(c,true));a("> td > div > .l-grid-tree-space:last",f).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close");if(b.hasChildren(c))for(var e=b.getChildren(c),d=0,h=e.length;d<h;d++)b.deleteRow(e[d]);c.__hasChildren=false},collapseAll:function(){var b=this,c=this.options;a(b.rows).each(function(f,c){var d=b.getRowObj(c),e=a(".l-grid-tree-link",d);if(e.hasClass("l-grid-tree-link-close"))return;b.toggle(c)})},expandAll:function(){var b=this,c=this.options;a(b.rows).each(function(f,c){var d=b.getRowObj(c),e=a(".l-grid-tree-link",d);if(e.hasClass("l-grid-tree-link-open"))return;b.toggle(c)})},collapse:function(b){var c=this,f=this.options,d=c.getRowObj(b),e=a(".l-grid-tree-link",d);if(e.hasClass("l-grid-tree-link-close"))return;c.toggle(b)},expand:function(b){var c=this,f=this.options,d=c.getRowObj(b),e=a(".l-grid-tree-link",d);if(e.hasClass("l-grid-tree-link-open"))return;c.toggle(b)},toggle:function(l){if(!l)return;var b=this,p=this.options,c=b.getRow(l),j=[b.getRowObj(c)];b.enabledFrozen()&&j.push(b.getRowObj(c,true));var o=c.__level,d,e=a(".l-grid-tree-link:first",j),k=true;b.collapsedRows=b.collapsedRows||[];var n=e.hasClass("l-grid-tree-link-close");function i(g){for(var e=0,j=g.length;e<j;e++){var f=g[e],d=b.getChildren(f,false),h=d&&d.length?true:false,c=a([b.getRowObj(f.__id)]);if(b.enabledFrozen())c=c.add(b.getRowObj(f.__id,true));if(h)if(a(".l-grid-tree-link",c).hasClass("l-grid-tree-link-close"))c.show();else{c.show();i(d)}else{a(".l-grid-tree-link",c).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");c.show()}}}function f(){var d=[];if(!k){d=b.getChildren(c,true);a(d).each(function(){a(b.getRowObj(this)).hide();b.enabledFrozen()&&a(b.getRowObj(this,true)).hide()});b.trigger("treeCollapsed",[c]);return}d=b.getChildren(c,false);i(d);b.trigger("treeExpanded",[c])}if(n){function h(){e.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");d=a.inArray(c,b.collapsedRows);d!=-1&&b.collapsedRows.splice(d,1)}var m={update:function(){h();f()}};if(b.hasBind("treeExpand")&&b.trigger("treeExpand",[c,m])==false)return false;h()}else{function g(){e.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open");d=a.inArray(c,b.collapsedRows);d==-1&&b.collapsedRows.push(c)}var m={update:function(){g();f()}};if(b.hasBind("treeCollapse")&&b.trigger("treeCollapse",[c,m])==false)return false;k=false;g()}f()},_bulid:function(){var a=this;a._clearGrid();a._initBuildHeader();a._initHeight();a._initFootbar();a._buildPager();a._setEvent()},_setColumns:function(){var a=this;a._initColumns();a._initBuildGridHeader();a._initBuildPopup()},_initBuildHeader:function(){var b=this,c=this.options;if(c.title){a(".l-panel-header-text",b.header).html(c.title);c.headerImg&&b.header.append("<img src='"+c.headerImg+"' />").addClass("l-panel-header-hasicon")}else b.header.hide();if(c.toolbar){if(a.fn.ligerToolBar){b.toolbarManager=b.topbar.ligerToolBar(c.toolbar);if(b.topbar.height()==0)b.topbar.parent().height(25);else b.topbar.parent().height(b.topbar.height())}}else b.topbar.parent().remove()},_createColumnId:function(a){return a.id!=null&&a.id!=""?a.id.toString():"c"+(100+this._columnCount)},_isColumnId:function(a){return a in this._columns},_initColumns:function(){var b=this,d=this.options;b._columns={};b._columnCount=0;b._columnLeafCount=0;b._columnMaxLevel=1;if(!d.columns)return;function n(b,a){for(var c in a)if(a[c]in b)delete b[a[c]]}function g(a,c,j,i){if(a.editorType){a.editor=a.editor||{};a.editor.type=a.editorType}n(a,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]);if(c>b._columnMaxLevel)b._columnMaxLevel=c;b._columnCount++;a.__id=b._createColumnId(a);a.__domid=b.id+"|hcell|"+a.__id;b._columns[a.__id]=a;if(!a.columns||!a.columns.length)a.__leafindex=b._columnLeafCount++;a.__level=c;a.__pid=j;a.__previd=i;if(!a.columns||!a.columns.length){a.__leaf=true;return 1}for(var d=0,f=-1,e=0,k=a.columns.length;e<k;e++){var h=a.columns[e];d+=g(h,c+1,a.__id,f);f=h.__id}a.__leafcount=d;return d}var e=-1;if(d.rownumbers){var k=b.enabledGroup()?false:d.frozen&&d.frozenRownumbers,c={isrownumber:true,issystem:true,width:d.rownumbersColWidth,frozen:k};g(c,1,-1,e);e=c.__id}if(b.enabledDetail()){var m=b.enabledGroup()?false:d.frozen&&d.frozenDetail,c={isdetail:true,issystem:true,width:d.detailColWidth,frozen:m};g(c,1,-1,e);e=c.__id}if(b.enabledCheckbox()){var l=b.enabledGroup()?false:d.frozen&&d.frozenCheckbox,c={ischeckbox:true,issystem:true,width:d.detailColWidth,frozen:l};g(c,1,-1,e);e=c.__id}for(var h=0,q=d.columns.length;h<q;h++){var c=d.columns[h];if(!c)continue;g(c,1,-1,e);e=c.__id}for(var p in b._columns){var c=b._columns[p];if(c.__leafcount>1)c.__colSpan=c.__leafcount;if(c.__leaf&&c.__level!=b._columnMaxLevel)c.__rowSpan=b._columnMaxLevel-c.__level+1}b.columns=b.getColumns();var i=a(parent.document).width()-230,f=0;a(b.columns).each(function(c,a){a.columnname=a.name;a.columnindex=c;a.type=a.type||"string";a.islast=c==b.columns.length-1;a.isSort=a.isSort==false?false:true;a.frozen=a.frozen?true:false;a._width=b._getColumnWidth(a);if(a._width<20)f++;a._hide=a.hide?true:false});if(f>0){var j=parseInt(i/f),o=f;a(b.columns).each(function(b,a){if(a._width<20){f--;if(f==0)a._width=i-j*(o-1);else a._width=j}})}},_getColumnWidth:function(c){var d=this,f=this.options;if(c._width&&c._width>20)return c._width;var b=c.width||f.columnWidth;if(!b||b=="auto"){var h=0,g=0;a(d.columns).each(function(e,b){var a=b.width||f.columnWidth,c=!a||a=="auto"?true:false;if(c)h++;else g+=parseInt(d._getColumnWidth(b))+1});b=parseInt((d.grid.width()-g)/h)-1}if(typeof b=="string"&&b.indexOf("%")>0){var e=0;if(d.enabledDetail())e+=f.detailColWidth;if(d.enabledCheckbox())e+=f.checkboxColWidth;if(d.options.rownumbers)e+=d.options.rownumbersColWidth;c._width=b=parseInt(parseInt(b)*.01*(d.grid.width()-e-d.columns.length/2-1))}if(c.minWidth&&b<c.minWidth)b=c.minWidth;if(c.maxWidth&&b>c.maxWidth)b=c.maxWidth;return b},_createHeaderCell:function(b){var d=this,e=this.options,c=a("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");c.attr("id",b.__domid);!b.__leaf&&c.addClass("l-grid-hd-cell-mul");b.columnindex==d.columns.length-1&&c.addClass("l-grid-hd-cell-last");if(b.isrownumber){c.addClass("l-grid-hd-cell-rownumbers");c.html("<div class='l-grid-hd-cell-inner'></div>")}if(b.ischeckbox){c.addClass("l-grid-hd-cell-checkbox");c.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")}if(b.isdetail){c.addClass("l-grid-hd-cell-detail");c.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")}b.heightAlign&&a(".l-grid-hd-cell-inner:first",c).css("textAlign",b.heightAlign);b.__colSpan&&c.attr("colSpan",b.__colSpan);if(b.__rowSpan){c.attr("rowSpan",b.__rowSpan);c.height(e.headerRowHeight*b.__rowSpan);var h=(e.headerRowHeight*b.__rowSpan-e.headerRowHeight)/2-5;a(".l-grid-hd-cell-inner:first",c).css("paddingTop",h)}else c.height(e.headerRowHeight);if(b.__leaf){c.width(b._width);c.attr("columnindex",b.__leafindex)}var g=c.height();!b.__rowSpan&&g>10&&a(">div:first",c).height(g);b._hide&&c.hide();b.name&&c.attr({columnname:b.name});var f="";if(b.display&&b.display!="")f=b.display;else if(b.headerRender)f=b.headerRender(b);else f="&nbsp;";a(".l-grid-hd-cell-text:first",c).html(f);if(!b.issystem&&b.__leaf&&b.resizable!==false&&a.fn.ligerResizable&&e.allowAdjustColWidth)d.colResizable[b.__id]=c.ligerResizable({handles:"e",onStartResize:function(b,a){this.proxy.hide();d.draggingline.css({height:d.body.height(),top:0,left:a.pageX-d.grid.offset().left+parseInt(d.body[0].scrollLeft)}).show()},onResize:function(e,b){d.colresizing=true;d.draggingline.css({left:b.pageX-d.grid.offset().left+parseInt(d.body[0].scrollLeft)});a("body").add(c).css("cursor","e-resize")},onStopResize:function(e){d.colresizing=false;a("body").add(c).css("cursor","default");d.draggingline.hide();d.setColumnWidth(b,parseInt(b._width)+e.diffX);return false}});d.trigger("headerCellBulid",[c,b]);return c},_initBuildGridHeader:function(){var b=this,f=this.options;b.gridtablewidth=0;b.f.gridtablewidth=0;if(b.colResizable){for(var j in b.colResizable)b.colResizable[j].destroy();b.colResizable=null}b.colResizable={};a("tbody:first",b.gridheader).html("");a("tbody:first",b.f.gridheader).html("");for(var c=1;c<=b._columnMaxLevel;c++){var h=b.getColumns(c),i=c==b._columnMaxLevel,e=a("<tr class='l-grid-hd-row'></tr>"),d=a("<tr class='l-grid-hd-row'></tr>");!i&&e.add(d).addClass("l-grid-hd-mul");a("tbody:first",b.gridheader).append(e);a("tbody:first",b.f.gridheader).append(d);a(h).each(function(f,a){(a.frozen?d:e).append(b._createHeaderCell(a));if(a.__leaf){var c=a._width;if(!a.frozen)b.gridtablewidth+=(parseInt(c)?parseInt(c):0)+1;else b.f.gridtablewidth+=(parseInt(c)?parseInt(c):0)+1}})}if(b._columnMaxLevel>0){var g=f.headerRowHeight*b._columnMaxLevel;b.gridheader.add(b.f.gridheader).height(g);f.rownumbers&&f.frozenRownumbers&&b.f.gridheader.find("td:first").height(g)}b._updateFrozenWidth();a("div:first",b.gridheader).width(b.gridtablewidth+40)},_initBuildPopup:function(){var b=this,c=this.options;a(":checkbox",b.popup).unbind();a("tbody tr",b.popup).remove();a(b.columns).each(function(f,c){if(c.issystem)return;if(c.isAllowHide==false)return;var d='checked="checked"';if(c._hide)d="";var e=c.display;a("tbody",b.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+d+' class="l-checkbox" columnindex="'+f+'"/></td><td class="l-column-right">'+e+"</td></tr>")});a.fn.ligerCheckBox&&a("input:checkbox",b.popup).ligerCheckBox({onBeforeClick:function(d){return!d.checked?true:a("input:checked",b.popup).length<=c.minColToggle?false:true}});if(c.allowHideColumn){a("tr",b.popup).hover(function(){a(this).addClass("l-popup-row-over")},function(){a(this).removeClass("l-popup-row-over")});var d=function(){if(a("input:checked",b.popup).length+1<=c.minColToggle)return false;b.toggleCol(parseInt(a(this).attr("columnindex")),this.checked,true)};if(a.fn.ligerCheckBox)a(":checkbox",b.popup).bind("change",d);else a(":checkbox",b.popup).bind("click",d)}},_initHeight:function(){var a=this,b=this.options;if(b.height=="auto"){a.gridbody.height("auto");a.f.gridbody.height("auto")}b.width&&a.grid.width(b.width);a._onResize.call(a)},_initFootbar:function(){var c=this,b=this.options;if(b.usePager){if(b.pagerRender){c.toolbar.html(b.pagerRender.call(c));return}if(b.scrollToPage){c.toolbar.hide();return}var e="",d=-1;a(b.pageSizeOptions).each(function(f,a){var c="";if(b.pageSize==a)d=f;e+="<option value='"+a+"' "+c+" >"+a+"</option>"});a(".l-bar-selectpagesize",c.toolbar).append("<select name='rp'>"+e+"</select>");if(d!=-1)a(".l-bar-selectpagesize select",c.toolbar)[0].selectedIndex=d;b.switchPageSizeApplyComboBox&&a.fn.ligerComboBox&&a(".l-bar-selectpagesize select",c.toolbar).ligerComboBox({onBeforeSelect:function(){return b.url&&c.isDataChanged&&!confirm(b.isContinueByDataChanged)?false:true},width:45})}else c.toolbar.hide()},_searchData:function(c,d){for(var e=this,f=this.options,b=[],a=0;a<c.length;a++)if(d(c[a],a))b[b.length]=c[a];return b},_clearGrid:function(){var b=this,e=this.options;b._fixRows();for(var d in b.rows){var c=a(b.getRowObj(b.rows[d]));if(b.enabledFrozen())c=c.add(b.getRowObj(b.rows[d],true));c.unbind()}b.gridbody.html("");b.f.gridbody.html("");b.recordNumber=0;b.records={};b.rows=[];b._fixRows();b.selected=[];b.totalNumber=0;b.editorcounter=0},_fixRows:function(){var b=this,d=this.options;if(!b.rows)return;for(var c in b.rows)if(a.isFunction(b.rows[c]))delete b.rows[c]},_fillGridBody:function(l,f,j){var b=this,d=this.options,c=j=="scrollappend"?[]:['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(b.enabledGroup()){var h=[],g=[];b.groups=g;for(var o in l){var n=l[o],m=n[d.groupColumnName],k=a.inArray(m,h);if(k==-1){h.push(m);k=h.length-1;g.push([])}g[k].push(n)}a(g).each(function(a,e){g.length==1&&c.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"');if(a==g.length-1)c.push('<tr class="l-grid-grouprow l-grid-grouprow-last"');else if(a==0)c.push('<tr class="l-grid-grouprow l-grid-grouprow-first"');else c.push('<tr class="l-grid-grouprow"');c.push(' groupindex"='+a+'" >');c.push('<td colSpan="'+b.columns.length+'" class="l-grid-grouprow-cell">');c.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>');if(d.groupRender)c.push(d.groupRender(h[a],e,d.groupColumnDisplay));else c.push(d.groupColumnDisplay+":"+h[a]);c.push("</td>");c.push("</tr>");c.push(b._getHtmlFromData(e,f));b.isTotalSummary()&&c.push(b._getTotalSummaryHtml(e,"l-grid-totalsummary-group",f))})}else c.push(b._getHtmlFromData(l,f));!j=="scrollappend"&&c.push("</tbody></table></div>");if(j=="scrollappend")(f?b.f.gridbody:b.gridbody).find("tbody:first").append(c.join(""));else(f?b.f.gridbody:b.gridbody).html(c.join(""));if(f){b.f.gridbody.find(">l-jplace").remove();b.f.gridbody.append('<div class="l-jplace"></div>')}if(d.usePager&&d.scrollToPage&&!d.scrollToAppend){var i=f?b.f.gridbody.find("> .l-grid-body-inner"):b.gridbody.find("> .l-grid-body-inner"),e=i.find("> .l-scrollreplacetop");e=e.length?e:a('<div class="l-scrollreplacetop"></div>').prependTo(i);e.css("width","80%").height(b.lastScrollTop);e=i.find("> .l-scrollreplacebottom");e=e.length?e:a('<div class="l-scrollreplacebottom"></div>').appendTo(i);e.css("width","80%").height((d.pageCount-d.newPage)*b._getOnePageHeight())}!b.enabledGroup()&&b._bulidTotalSummary(f);a("> div:first",b.gridbody).width(b.gridtablewidth);b._onResize()},_showData:function(d){var b=this,c=this.options;b.changedCells={};var e=b.currentData[c.root];if(c.usePager){if(c.dataAction=="server"&&b.data&&b.data[c.record])c.total=b.data[c.record];else if(b.filteredData&&b.filteredData[c.root])c.total=b.filteredData[c.root].length;else if(b.data&&b.data[c.root])c.total=b.data[c.root].length;else if(e)c.total=e.length;c.page=c.newPage;if(!c.total)c.total=0;if(!c.page)c.page=1;c.pageCount=Math.ceil(c.total/c.pageSize);if(!c.pageCount)c.pageCount=1;!c.scrollToPage&&b._buildPager()}a(".l-bar-btnloading:first",b.toolbar).removeClass("l-bar-btnloading");if(b.trigger("beforeShowData",[b.currentData])==false)return;d!="scrollappend"&&b._clearGrid();b.isDataChanged=false;if(!e||!e.length){b.gridview.addClass("l-grid-empty");a(b.element).addClass("l-empty");a("<div></div>").addClass("l-grid-body-inner").appendTo(b.gridbody).css({width:b.gridheader.find(">div:first").width(),height:b.gridbody.height()});if(c.pagerRender){b.toolbar.html(c.pagerRender.call(b));return}b._onResize.ligerDefer(b,50);return}else{b.gridview.removeClass("l-grid-empty");a(b.element).removeClass("l-empty")}a(".l-bar-btnload:first span",b.toolbar).removeClass("l-disabled");b._updateGridData();b.enabledFrozen()&&b._fillGridBody(b.rows,true,d);b._fillGridBody(b.rows,false,d);b.trigger("SysGridHeightChanged");d=="scroll"&&b.trigger("sysScrollLoaded");if(c.totalRender){a(".l-panel-bar-total",b.element).remove();a(".l-panel-bar",b.element).before('<div class="l-panel-bar-total">'+c.totalRender(b.data,b.filteredData)+"</div>")}if(c.mouseoverRowCssClass)for(var g in b.rows){var f=a(b.getRowObj(b.rows[g]));if(b.enabledFrozen())f=f.add(b.getRowObj(b.rows[g],true));f.bind("mouseover.gridrow",function(){b._onRowOver(this,true)}).bind("mouseout.gridrow",function(){b._onRowOver(this,false)})}b._fixHeight();if(c.pagerRender){b.toolbar.html(c.pagerRender.call(b));return}b.gridbody.trigger("scroll.grid");if(null!=a(".l-grid1 .l-grid-header-inner .l-grid-header-table .l-grid-hd-row .l-grid-hd-cell-checkbox").html())if(navigator.userAgent.indexOf("MSIE")>0)a("tr[id^=maingrid|2|]").each(function(f){var d=a(this).attr("id"),b=document.getElementById(d).offsetHeight;if(f>0)b=b-1;var d=a(this).attr("id"),c=d.replace("|2|","\\|1\\|");a("#"+c).attr("style","height:"+b+"px;");var e=(b-15)/2;a("#"+c+">td>div>span").attr("style","margin-top: "+e+"px;")});else a("tr[id^=maingrid\\|2\\|]").each(function(){var d=a(this).attr("id"),c=document.getElementById(d).offsetHeight,b=d.replace("|2|","\\|1\\|");a("#"+b).attr("style","height:"+c+"px;");var e=(c-15)/2;a("#"+b+">td>div>span").attr("style","margin-top: "+e+"px;")});b.trigger("afterShowData",[b.currentData])},_fixHeight:function(){var d=this,i=this.options;if(i.fixedCellHeight||!i.frozen)return;var b,c;for(var k in d.columns){var e=d.columns[k];if(b&&c)break;if(e.frozen&&!b){b=e;continue}if(!e.frozen&&!c){c=e;continue}}if(!b||!c)return;for(var h in d.records){var f=d.getCellObj(h,b),g=d.getCellObj(h,c),j=Math.max(a(f).height(),a(g).height());a(f).add(g).height(j)}},_getRowDomId:function(a,b){return this.id+"|"+(b?"1":"2")+"|"+a.__id},_getCellDomId:function(b,a){return this._getRowDomId(b,a.frozen)+"|"+a.__id},_getHtmlFromData:function(h,f){if(!h)return"";for(var e=this,c=this.options,b=[],i=0,l=h.length;i<l;i++){var d=h[i],g=d.__id;if(!d)continue;b.push("<tr");b.push(' id="'+e._getRowDomId(d,f)+'"');b.push(' class="l-grid-row');if(!f&&e.enabledCheckbox()&&c.isChecked&&c.isChecked(d)){e.select(d);b.push(" l-selected")}else if(e.isSelected(d))b.push(" l-selected");else if(c.isSelected&&c.isSelected(d)){e.select(d);b.push(" l-selected")}d.__index%2==1&&c.alternatingRow&&b.push(" l-grid-row-alt");if(c.rowClsRender){var k=c.rowClsRender(d,g);k&&b.push(" "+k)}b.push('" ');c.rowAttrRender&&b.push(c.rowAttrRender(d,g));if(c.tree&&e.collapsedRows&&e.collapsedRows.length){var j=function(){var b=e.getParent(d);while(b){if(a.inArray(b,e.collapsedRows)!=-1)return true;b=e.getParent(b)}return false};j()&&b.push(' style="display:none;" ')}else if(c.tree&&c.tree.isExtend){var j=function(){var a=e.getParent(d);while(a){if(c.tree.isExtend(a)==false)return true;a=e.getParent(a)}return false};j()&&b.push(' style="display:none;" ')}b.push(">");a(e.columns).each(function(i,a){if(f!=a.frozen)return;b.push("<td");b.push(' id="'+e._getCellDomId(d,this)+'"');if(this.isrownumber){b.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(c.fixedCellHeight)b.push(' style = "height:'+c.rowHeight+'px;" ');else b.push(' style = "min-height:'+c.rowHeight+'px;" ');b.push(">"+(parseInt(d.__index)+1)+"</div></td>");return}if(this.ischeckbox){b.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(c.fixedCellHeight)b.push(' style = "height:'+c.rowHeight+'px;" ');else b.push(' style = "min-height:'+c.rowHeight+'px;" ');b.push(">");b.push('<span class="l-grid-row-cell-btn-checkbox"></span>');b.push("</div></td>");return}else if(this.isdetail){b.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(c.fixedCellHeight)b.push(' style = "height:'+c.rowHeight+'px;" ');else b.push(' style = "min-height:'+c.rowHeight+'px;" ');b.push(">");(!c.isShowDetailToggle||c.isShowDetailToggle(d))&&b.push('<span class="l-grid-row-cell-detailbtn"></span>');b.push("</div></td>");return}var h=this._width;b.push(' class="l-grid-row-cell ');e.changedCells[g+"_"+this.__id]&&b.push("l-grid-row-cell-edited ");this.islast&&b.push("l-grid-row-cell-last ");b.push('"');b.push(' style = "');b.push("width:"+h+"px; ");a._hide&&b.push("display:none;");b.push(' ">');b.push(e._getCellHtml(d,a));b.push("</td>")});b.push("</tr>")}return b.join("")},_getCellHtml:function(d,b){var f=this,c=this.options;if(b.isrownumber)return'<div class="l-grid-row-cell-inner">'+(parseInt(d.__index)+1)+"</div>";var a=[];a.push('<div class="l-grid-row-cell-inner"');a.push(' style = "width:'+parseInt(b._width-8)+"px;");c.fixedCellHeight&&a.push("height:"+c.rowHeight+"px;");a.push("min-height:"+c.rowHeight+"px; ");b.align&&a.push("text-align:"+b.align+";");var e=f._getCellContent(d,b);a.push('">'+e+"</div>");return a.join("")},_setValueByName:function(b,a,c){if(!b||!a)return null;if(a.indexOf(".")==-1)b[a]=c;else try{new Function("data,value","data."+a+"=value;")(b,c)}catch(d){}},_getValueByName:function(b,a){if(!b||!a)return null;if(a.indexOf(".")==-1)return b[a];else try{return new Function("data","return data."+a+";")(b)}catch(c){return null}},_getCellContent:function(b,a){var e=this,d=this.options;if(!b||!a)return"";if(a.isrownumber)return parseInt(b.__index)+1;var i=b.__id,h=b.__index,f=e._getValueByName(b,a.name),g=e._getValueByName(b,a.textField),c="";if(a.render)c=a.render.call(e,b,h,f,a);else if(d.formatters[a.type])c=d.formatters[a.type].call(e,f,a);else if(g!=null)c=g.toString();else if(f!=null)c=f.toString();if(d.tree&&(d.tree.columnName!=null&&d.tree.columnName==a.name||d.tree.columnId!=null&&d.tree.columnId==a.id))c=e._getTreeCellHtml(c,b);return c||""},_getTreeCellHtml:function(i,c){var d=c.__level,f=this,h=this.options,j=f.collapsedRows==null?h.tree.isExtend(c):a.inArray(c,f.collapsedRows||[])==-1,e=h.tree.isParent(c),b="";d=parseInt(d)||1;for(var g=1;g<d;g++)b+="<div class='l-grid-tree-space'></div>";if(j&&e)b+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>";else if(e)b+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>";else b+="<div class='l-grid-tree-space'></div>";b+="<span class='l-grid-tree-content'>"+i+"</span>";return b},_applyEditor:function(B){var b=this,h=this.options,f=B,p=f.id.split("|"),v=p[p.length-1],c=b._columns[v],C=a(f).parent(),e=b.getRow(C[0]),y=e.__id,w=e.__index;if(!c||!c.editor)return;var u=c.name,D=c.columnindex;if(c.editor.type&&h.editors[c.editor.type]){var n=b._getValueByName(e,u),d={record:e,value:n,column:c,rowindex:w};if(c.textField)d.text=b._getValueByName(e,c.textField);if(b.trigger("beforeEdit",[d])==false)return false;b.lastEditRow=e;liger.lastEditGrid=b;var g=h.editors[c.editor.type],o=a(f),E=a(f).offset(),z=a(f).width(),j=a(f).height(),m=a("<div class='l-grid-editor'></div>").appendTo(b.grid),l=0,k=0,r=o.position(),q=b.gridbody.position(),s=b.gridview2.position(),t=(h.toolbar?b.topbar.parent().outerHeight():0)+(h.title?b.header.outerHeight():0),l=r.left+q.left+s.left,k=r.top+q.top+s.top+t;o.html("");b.setCellEditing(e,c,true);var A=!!window.ActiveXObject||"ActiveXObject"in window?true:false,x=a.browser.version.indexOf("8")==0;if(A){j-=x?1:2;k-=1;l-=1}else if(a.browser.mozilla){j-=1;k-=1;l-=1}else if(a.browser.safari)k-=1;else j-=1;l+=h.editorLeftDiff||0;k+=h.editorTopDiff||0;j+=h.editorHeightDiff||0;m.css({left:l,top:k}).show();if(c.textField)d.text=b._getValueByName(e,c.textField);var i=b._createEditor(g,m,d,z,j-1);b.editor={editing:true,editor:g,input:i,editParm:d,container:m};b.unbind("sysEndEdit");b.bind("sysEndEdit",function(){var e=g.getValue(i,d);if(c.textField&&g.getText)d.text=g.getText(i,d);if(g.getSelected)d.selected=g.getSelected(i,d);if(e!=n){a(f).addClass("l-grid-row-cell-edited");b.changedCells[y+"_"+c.__id]=true;d.value=e}c.editor.onChange&&c.editor.onChange.call(i,d);if(b._checkEditAndUpdateCell(d))c.editor.onChanged&&c.editor.onChanged.call(i,d)})}},_checkEditAndUpdateCell:function(a){var b=this,d=this.options;if(b.trigger("beforeSubmitEdit",[a])==false)return false;var c=a.column;a.text&&c.textField&&b._setValueByName(a.record,c.textField,a.text);b.updateCell(c,a.value,a.record);(c.render||b.enabledTotal())&&b.reRender({column:c});b.reRender({rowdata:a.record});return true},_getCurrentPageData:function(b){var d=this,a=this.options,c={};c[a.root]=[];if(!b||!b[a.root]||!b[a.root].length){c[a.record]=0;return c}c[a.record]=b[a.root].length;if(!a.newPage)a.newPage=1;for(i=(a.newPage-1)*a.pageSize;i<b[a.root].length&&i<a.newPage*a.pageSize;i++)c[a.root].push(b[a.root][i]);return c},_compareData:function(f,g,c,d){var h=this,e=this.options,a=f[c],b=g[c];return a==null&&b!=null?1:a==null&&b==null?0:a!=null&&b==null?-1:e.sorters[d]?e.sorters[d].call(h,a,b):a<b?-1:a>b?1:0},_getTotalInfo:function(c,b){var m=this,j=this.options;try{var k=[];if(!c.totalSummary)return null;var g=0,h=0,i=0,e=0,d=0;if(b&&b.length){d=parseFloat(b[0][c.name]);e=parseFloat(b[0][c.name]);for(var f=0;f<b.length;f++){if(b[f][j.statusName]=="delete")continue;h+=1;var a=b[f][c.name];if(typeof a=="string")a=a.replace(/\$|\,/g,"");a=parseFloat(a);if(!a)continue;g+=a;if(a>d)d=a;if(a<e)e=a}i=g*1/b.length}return{sum:g,count:h,avg:i,min:e,max:d}}catch(l){return{}}},_getTotalCellContent:function(b,h){var f=this,i=this.options,a=[];if(b.totalSummary){var d=function(b){for(var a=0;a<e.length;a++)if(e[a].toLowerCase()==b.toLowerCase())return true;return false},c=f._getTotalInfo(b,h);if(b.totalSummary.render){var g=b.totalSummary.render(c,b,f.data);a.push(g)}else if(b.totalSummary.type&&c){var e=b.totalSummary.type.split(",");d("sum")&&a.push("<div>Sum="+c.sum.toFixed(2)+"</div>");d("tsum")&&a.push("<div>"+sum.toFixed(0)+"</div>");d("count")&&a.push("<div>Count="+c.count+"</div>");d("max")&&a.push("<div>Max="+c.max.toFixed(2)+"</div>");d("min")&&a.push("<div>Min="+c.min.toFixed(2)+"</div>");d("avg")&&a.push("<div>Avg="+c.avg.toFixed(2)+"</div>")}}return a.join("")},_getTotalSummaryHtml:function(f,d,e){var c=this,g=this.options,b=[];if(d)b.push('<tr class="l-grid-totalsummary '+d+'">');else b.push('<tr class="l-grid-totalsummary">');a(c.columns).each(function(d,a){if(this.frozen!=e)return;if(this.isrownumber){b.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}if(this.ischeckbox){b.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}else if(this.isdetail){b.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}b.push('<td class="l-grid-totalsummary-cell');this.islast&&b.push(" l-grid-totalsummary-cell-last");b.push('" ');b.push('id="'+c.id+"|total"+c.totalNumber+"|"+a.__id+'" ');b.push('width="'+this._width+'" ');columnname=this.columnname;columnname&&b.push('columnname="'+columnname+'" ');b.push('columnindex="'+d+'" ');b.push('><div class="l-grid-totalsummary-cell-inner"');a.align&&b.push(' style="text-Align:'+a.align+';"');b.push(">");b.push(c._getTotalCellContent(a,f));b.push("</div></td>")});b.push("</tr>");if(!e)c.totalNumber++;return b.join("")},_bulidTotalSummary:function(d){var b=this,e=this.options;if(!b.isTotalSummary())return false;if(!b.currentData||b.currentData[e.root].length==0)return false;var c=a(b._getTotalSummaryHtml(b.currentData[e.root],null,d));a("tbody:first",d?b.f.gridbody:b.gridbody).append(c);if(d)b.totalRow1=c;else b.totalRow2=c},updateTotalSummary:function(){var a=this,b=this.options;a.reRender({totalOnly:true})},_buildPager:function(){var c=this,b=this.options;if(b.pagerRender)return;a(".pcontrol input",c.toolbar).val(b.page);if(!b.pageCount)b.pageCount=1;a(".pcontrol span",c.toolbar).html(b.pageCount);var f=parseInt((b.page-1)*b.pageSize)+1,e=parseInt(f)+parseInt(b.pageSize)-1;if(!b.total)b.total=0;if(b.total<e)e=b.total;if(!b.total)f=e=0;if(f<0)f=0;if(e<0)e=0;var d=b.pageStatMessage;d=d.replace(/{from}/,f);d=d.replace(/{to}/,e);d=d.replace(/{total}/,b.total);d=d.replace(/{pagesize}/,b.pageSize);a(".l-bar-text",c.toolbar).html(d);!b.total&&a(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",c.toolbar).addClass("l-disabled");if(b.hideLoadButton){a(".l-bar-btnload:first",c.toolbar).parent().hide();a(".l-bar-btnload:first",c.toolbar).parent().next().hide()}if(b.page==1){a(".l-bar-btnfirst span",c.toolbar).addClass("l-disabled");a(".l-bar-btnprev span",c.toolbar).addClass("l-disabled")}else if(b.page>b.pageCount&&b.pageCount>0){a(".l-bar-btnfirst span",c.toolbar).removeClass("l-disabled");a(".l-bar-btnprev span",c.toolbar).removeClass("l-disabled")}if(b.page==b.pageCount){a(".l-bar-btnlast span",c.toolbar).addClass("l-disabled");a(".l-bar-btnnext span",c.toolbar).addClass("l-disabled")}else if(b.page<b.pageCount&&b.pageCount>0){a(".l-bar-btnlast span",c.toolbar).removeClass("l-disabled");a(".l-bar-btnnext span",c.toolbar).removeClass("l-disabled")}},_getRowIdByDomId:function(a){var c=a.split("|"),b=c[2];return b},_getRowByDomId:function(a){return this.records[this._getRowIdByDomId(a)]},_isEditing:function(b){var d=this;if(b.hasClass("l-box-dateeditor")||b.hasClass("l-box-select"))return true;if(b.hasClass("l-dialog")){var c=[];b.find(".l-dialog").each(function(){var b=a(this).attr("ligeruiid");b&&c.push(b)});if(d._editorIncludeCotrols(c))return true}return false},_getSrcElementByEvent:function(i){var e=this,h=i.target||i.srcElement,d=a(h).parents().add(h),c=function(c){for(var b=0,e=d.length;b<e;b++)if(typeof c=="string"){if(a(d[b]).hasClass(c))return d[b]}else if(typeof c=="object")if(d[b]==c)return d[b];return null};if(c("l-grid-editor"))return{editing:true,editor:c("l-grid-editor")};if(d.index(this.element)==-1)return e._isEditing(d)?{editing:true}:{out:true};var g=false;if(d.hasClass("l-grid-detailpanel")&&e.detailrows)for(var f=0,k=e.detailrows.length;f<k;f++)if(d.index(e.detailrows[f])!=-1){g=true;break}var b={grid:c("l-panel"),indetail:g,frozen:c(e.gridview1[0])?true:false,header:c("l-panel-header"),gridheader:c("l-grid-header"),gridbody:c("l-grid-body"),total:c("l-panel-bar-total"),popup:c("l-grid-popup"),toolbar:c("l-panel-bar")};if(b.gridheader){b.hrow=c("l-grid-hd-row");b.hcell=c("l-grid-hd-cell");b.hcelltext=c("l-grid-hd-cell-text");b.checkboxall=c("l-grid-hd-cell-checkbox");if(b.hcell){var j=b.hcell.id.split("|")[2];b.column=e._columns[j]}}if(b.gridbody){b.row=c("l-grid-row");b.cell=c("l-grid-row-cell");b.checkbox=c("l-grid-row-cell-btn-checkbox");b.groupbtn=c("l-grid-group-togglebtn");b.grouprow=c("l-grid-grouprow");b.detailbtn=c("l-grid-row-cell-detailbtn");b.detailrow=c("l-grid-detailpanel");b.totalrow=c("l-grid-totalsummary");b.totalcell=c("l-grid-totalsummary-cell");b.rownumberscell=a(b.cell).hasClass("l-grid-row-cell-rownumbers")?b.cell:null;b.detailcell=a(b.cell).hasClass("l-grid-row-cell-detail")?b.cell:null;b.checkboxcell=a(b.cell).hasClass("l-grid-row-cell-checkbox")?b.cell:null;b.treelink=c("l-grid-tree-link");b.editor=c("l-grid-editor");if(b.row)b.data=this._getRowByDomId(b.row.id);if(b.cell)b.editing=a(b.cell).hasClass("l-grid-row-cell-editing");if(b.editor)b.editing=true;if(b.editing)b.out=false}if(b.toolbar){b.first=c("l-bar-btnfirst");b.last=c("l-bar-btnlast");b.next=c("l-bar-btnnext");b.prev=c("l-bar-btnprev");b.load=c("l-bar-btnload");b.button=c("l-bar-button")}return b},_editorIncludeCotrols:function(b){var a=this,f=this.options;if(!b||!b.length)return false;if(a.editor&&a.editor.input){if(a._controlIncludeCotrols(a.editor.input,b))return true}else if(a.editors)for(var d in a.editors){if(!a.editors[d])continue;for(var e in a.editors[d]){var c=a.editors[d][e];if(c&&c.input)if(a._controlIncludeCotrols(c.input,b))return true}}return false},_controlIncludeCotrols:function(b,d){var f=this,g=this.options;if(!b||!b.includeControls||!b.includeControls.length)return false;for(var c=0;c<b.includeControls.length;c++){var e=b.includeControls[c];if(a.inArray(e.id,d)!=-1)return true}return false},_getOnePageHeight:function(){var b=this,a=this.options;return(parseFloat(a.rowHeight||24)+1)*parseInt(a.pageSize)},_setEvent:function(){var b=this,c=this.options;b.grid.bind("mousedown.grid",function(a){b._onMouseDown.call(b,a)});b.grid.bind("dblclick.grid",function(a){b._onDblClick.call(b,a)});b.grid.bind("contextmenu.grid",function(a){return b._onContextmenu.call(b,a)});a(document).bind("mouseup.grid",function(a){b._onMouseUp.call(b,a)});a(document).bind("click.grid",function(a){b._onClick.call(b,a)});a(window).bind("resize.grid",function(){b._onResize.call(b)});a(document).bind("keydown.grid",function(a){if(a.ctrlKey)b.ctrlKey=true});a(document).bind("keyup.grid",function(){delete b.ctrlKey});b.gridbody.bind("scroll.grid",function(){var f=b.gridbody.scrollLeft(),a=b.gridbody.scrollTop();if(f!=null)b.gridheader[0].scrollLeft=f;if(a!=null)b.f.gridbody[0].scrollTop=a;if(c.scrollToPage&&c.usePager&&!b.loading){var e=b.gridbody.find(".l-grid-body-inner:first").height(),d=a+b.gridbody.height();if(c.scrollToAppend){if(c.newPage!=c.pageCount)d>=e&&b.reload(c.newPage+1,"scrollappend")}else{var g=d>=e?c.pageCount:Math.ceil(d/b._getOnePageHeight());if(!b.scrollLoading){b.scrollLoading=true;b.lastScrollTop=a;b.unbind("sysScrollLoaded");b.bind("sysScrollLoaded",function(){b.gridbody.scrollTop(a);setTimeout(function(){b.scrollLoading=false},500)});b.scrollLoading=true;b.reload(g,"scroll")}}}b.trigger("SysGridHeightChanged")});a("select",b.toolbar).change(function(){if(b.isDataChanged&&c.dataAction!="local"&&!confirm(c.isContinueByDataChanged))return false;c.newPage=1;c.pageSize=this.value;b.loadData(c.dataAction!="local"?c.where:false)});a("span.pcontrol :text",b.toolbar).blur(function(){b.changePage("input")});a("div.l-bar-button",b.toolbar).hover(function(){a(this).addClass("l-bar-button-over")},function(){a(this).removeClass("l-bar-button-over")});if(a.fn.ligerDrag&&c.colDraggable){b.colDroptip=a("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");b.gridheader.add(b.f.gridheader).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(g,f){var c=b._getSrcElementByEvent(f);if(c.hcell&&c.column){var e=a(".l-grid-hd-cell-text:first",c.hcell).html(),d=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");d.append(e);return d}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");b.children[this.id]=this},onStartDrag:function(f,e){if(e.button==2)return false;if(b.colresizing)return false;this.set("cursor","default");var c=b._getSrcElementByEvent(e);if(!c.hcell||!c.column||c.column.issystem||c.hcelltext)return false;if(a(c.hcell).css("cursor").indexOf("resize")!=-1)return false;this.draggingColumn=c.column;b.coldragging=true;var d=b.grid.offset();this.validRange={top:d.top,bottom:d.top+b.gridheader.height(),left:d.left-10,right:d.left+b.grid.width()+10}},onDrag:function(t,q){this.set("cursor","default");var g=this.draggingColumn;if(!g)return false;if(b.colresizing)return false;if(b.colDropIn==null)b.colDropIn=-1;var i=q.pageX,j=q.pageY,p=false,s=b.grid.offset(),f=this.validRange;if(i<f.left||i>f.right||j>f.bottom||j<f.top){b.colDropIn=-1;b.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");return}for(var l in b._columns){var e=b._columns[l];if(g==e){p=true;continue}if(e.issystem)continue;var r=e.__level==g.__level,k=!r?false:p?true:false;if(g.frozen!=e.frozen)k=e.frozen?false:true;if(b.colDropIn!=-1&&b.colDropIn!=l)continue;var m=document.getElementById(e.__domid),h=a(m).offset(),d={top:h.top,bottom:h.top+a(m).height(),left:h.left-10,right:h.left+10};if(k){var n=a(m).width();d.left+=n;d.right+=n}if(i>d.left&&i<d.right&&j>d.top&&j<d.bottom){var o=c.headerRowHeight;if(e.__rowSpan)o*=e.__rowSpan;b.colDroptip.css({left:d.left+5,top:d.top-9,height:o+9*2}).show();b.colDropIn=l;b.colDropDir=k?"right":"left";this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}else if(b.colDropIn!=-1){b.colDropIn=-1;b.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no")}}},onStopDrag:function(){var a=this.draggingColumn;b.coldragging=false;if(b.colDropIn!=-1){b.changeCol.ligerDefer(b,0,[a,b.colDropIn,b.colDropDir=="right"]);b.colDropIn=-1}b.colDroptip.hide();this.set("cursor","default")}})}if(a.fn.ligerDrag&&c.rowDraggable){b.rowDroptip=a("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body");b.gridbody.add(b.f.gridbody).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(d,h){var g=b._getSrcElementByEvent(h);if(g.row){var e=c.draggingMessage.replace(/{count}/,d.draggingRows?d.draggingRows.length:1);if(c.rowDraggingRender)e=c.rowDraggingRender(d.draggingRows,d,b);var f=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+e+"</div>").appendTo("body");return f}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");b.children[this.id]=this},onStartDrag:function(f,d){if(d.button==2)return false;if(b.colresizing)return false;if(!b.columns.length)return false;this.set("cursor","default");var a=b._getSrcElementByEvent(d);if(!a.cell||!a.data||a.checkbox)return false;var c=a.cell.id.split("|"),e=b._columns[c[c.length-1]];if(a.rownumberscell||a.detailcell||a.checkboxcell||e==b.columns[0]){if(b.enabledCheckbox()){this.draggingRows=b.getSelecteds();if(!this.draggingRows||!this.draggingRows.length)return false}else this.draggingRows=[a.data];this.draggingRow=a.data;this.set("cursor","move");b.rowdragging=true;this.validRange={top:b.gridbody.offset().top,bottom:b.gridbody.offset().top+b.gridbody.height(),left:b.grid.offset().left-10,right:b.grid.offset().left+b.grid.width()+10}}else return false},onDrag:function(s,p){var h=this.draggingRow;if(!h)return false;var q=this.draggingRows?this.draggingRows:[h];if(b.colresizing)return false;if(b.rowDropIn==null)b.rowDropIn=-1;var g=p.pageX,e=p.pageY,o=false,f=this.validRange;if(g<f.left||g>f.right||e>f.bottom||e<f.top){b.rowDropIn=-1;b.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var r in b.rows){var l=b.rows[r],k=l.__id;if(h==l)o=true;if(a.inArray(l,q)!=-1)continue;var m=o?true:false;if(b.rowDropIn!=-1&&b.rowDropIn!=k)continue;var j=b.getRowObj(k),i=a(j).offset(),d={top:i.top-4,bottom:i.top+a(j).height()+4,left:b.grid.offset().left,right:b.grid.offset().left+b.grid.width()};if(g>d.left&&g<d.right&&e>d.top&&e<d.bottom){var n=i.top;if(m)n+=a(j).height();b.rowDroptip.css({left:d.left,top:n,width:d.right-d.left}).show();b.rowDropIn=k;b.rowDropDir=m?"bottom":"top";if(c.tree&&e>d.top+5&&e<d.bottom-5){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");b.rowDroptip.hide();b.rowDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");b.rowDroptip.show();b.rowDropInParent=false}break}else if(b.rowDropIn!=-1){b.rowDropIn=-1;b.rowDropInParent=false;b.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}},onStopDrag:function(){var d=this.draggingRows;b.rowdragging=false;for(var g=0;g<d.length;g++){var h=d[g].children;if(h)d=a.grep(d,function(c){return a.inArray(c,h)==-1})}if(b.rowDropIn!=-1){if(c.tree){var f,e;if(b.rowDropInParent)e=b.getRow(b.rowDropIn);else{f=b.getRow(b.rowDropIn);e=b.getParent(f)}b.appendRange(d,e,f,b.rowDropDir!="bottom");b.trigger("rowDragDrop",{rows:d,parent:e,near:f,after:b.rowDropDir=="bottom"})}else{b.moveRange(d,b.rowDropIn,b.rowDropDir=="bottom");b.trigger("rowDragDrop",{rows:d,parent:e,near:b.getRow(b.rowDropIn),after:b.rowDropDir=="bottom"})}b.rowDropIn=-1}b.rowDroptip.hide();this.set("cursor","default")}})}},_onRowOver:function(h,g){if(c.draggable.dragging)return;var b=this,d=this.options,f=b.getRow(h),e=g?"addClass":"removeClass";g&&b.editor.editing&&a("tr."+d.mouseoverRowCssClass,b.gridview).removeClass(d.mouseoverRowCssClass);b.enabledFrozen()&&a(b.getRowObj(f,true))[e](d.mouseoverRowCssClass);a(b.getRowObj(f,false))[e](d.mouseoverRowCssClass)},_onMouseUp:function(b){var d=this,e=this.options;if(c.draggable.dragging){var a=d._getSrcElementByEvent(b);if(a.hcell&&a.column)d.trigger("dragdrop",[{type:"header",column:a.column,cell:a.hcell},b]);else a.row&&d.trigger("dragdrop",[{type:"row",record:a.data,row:a.row},b])}},_onMouseDown:function(){var b=this,c=this.options},_onContextmenu:function(d){var b=this,g=this.options,c=b._getSrcElementByEvent(d);if(c.row){g.whenRClickToSelect&&b.select(c.data);if(b.hasBind("contextmenu"))return b.trigger("contextmenu",[{data:c.data,rowindex:c.data.__index,row:c.row},d])}else if(c.hcell){if(!g.allowHideColumn)return true;var e=a(c.hcell).attr("columnindex");if(e==undefined)return true;var f=d.pageX-b.body.offset().left+parseInt(b.body[0].scrollLeft);if(e==b.columns.length-1)f-=50;b.popup.css({left:f,top:b.gridheader.height()+1});b.popup.toggle();return false}},_onDblClick:function(c){var b=this,d=this.options,a=b._getSrcElementByEvent(c);a.row&&b.trigger("dblClickRow",[a.data,a.data.__id,a.row])},_onClick:function(u){var y=u.target||u.srcElement,b=this,d=this.options,c=b._getSrcElementByEvent(u);if(c.out){b.editor.editing&&!a.ligerui.win.masking&&b.endEdit();d.allowHideColumn&&b.popup.hide();return}if(c.indetail||c.editing)return;b.editor.editing&&b.endEdit();if(d.allowHideColumn)!c.popup&&b.popup.hide();if(c.checkboxall){var e=a(c.hrow),h=e.hasClass("l-checked");if(b.trigger("beforeCheckAllRow",[!h,b.element])==false)return false;if(h)e.removeClass("l-checked");else e.addClass("l-checked");b.selected=[];for(var t in b.records)if(h)b.unselect(b.records[t]);else b.select(b.records[t]);b.trigger("checkAllRow",[!h,b.element])}else if(c.hcelltext){var n=a(c.hcelltext).parent().parent();if(!d.enabledSort||!c.column)return;if(c.column.isSort==false)return;if(d.url&&d.dataAction!="local"&&b.isDataChanged&&!confirm(d.isContinueByDataChanged))return;var o=a(".l-grid-hd-cell-sort:first",n),g=c.column.name;if(!g)return;if(o.length>0){if(o.hasClass("l-grid-hd-cell-sort-asc")){o.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc");n.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc");b.trigger("ChangeSort",[g,"desc"]);b.changeSort(g,"desc")}else if(o.hasClass("l-grid-hd-cell-sort-desc")){o.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc");n.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");b.trigger("ChangeSort",[g,"asc"]);b.changeSort(g,"asc")}}else{n.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");a(c.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>");b.trigger("ChangeSort",[g,"asc"]);b.changeSort(g,"asc")}a(".l-grid-hd-cell-sort",b.gridheader).add(a(".l-grid-hd-cell-sort",b.f.gridheader)).not(a(".l-grid-hd-cell-sort:first",n)).remove()}else if(c.detailbtn&&d.detail){var i=c.data,e=a([b.getRowObj(i,false)]);if(b.enabledFrozen())e=e.add(b.getRowObj(i,true));var t=i.__id;if(a(c.detailbtn).hasClass("l-open")){if(d.detail.onCollapse)d.detail.onCollapse(i,a(".l-grid-detailpanel-inner:first",r)[0]);e.next("tr.l-grid-detailpanel").hide();a(c.detailbtn).removeClass("l-open")}else{var r=e.next("tr.l-grid-detailpanel");if(r.length>0){r.show();if(d.detail.onExtend)d.detail.onExtend(i,a(".l-grid-detailpanel-inner:first",r)[0]);a(c.detailbtn).addClass("l-open");b.trigger("SysGridHeightChanged");return}a(c.detailbtn).addClass("l-open");for(var q=0,j=0;j<b.columns.length;j++)if(b.columns[j].frozen)q++;var l=a("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>"),p=a("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");l.find("div:first").width(b.gridheader.find("div:first").width()-50);l.attr("id",b.id+"|detail|"+t);b.detailrows=b.detailrows||[];b.detailrows.push(l[0]);b.detailrows.push(p[0]);var k=a("div:first",l);k.parent().attr("colSpan",b.columns.length-q);e.eq(0).after(l);if(q>0){p.find("td:first").attr("colSpan",q);e.eq(1).after(p)}if(d.detail.onShowDetail){d.detail.onShowDetail(i,k[0],function(){b.trigger("SysGridHeightChanged")});a("div:first",p).add(k).show().height(d.detail.height||d.detailHeight)}else if(d.detail.render){k.append(d.detail.render());k.show()}b.trigger("SysGridHeightChanged")}}else if(c.groupbtn){var m=a(c.grouprow),s=true;if(a(c.groupbtn).hasClass("l-grid-group-togglebtn-close")){a(c.groupbtn).removeClass("l-grid-group-togglebtn-close");m.hasClass("l-grid-grouprow-last")&&a("td:first",m).width("auto")}else{s=false;a(c.groupbtn).addClass("l-grid-group-togglebtn-close");m.hasClass("l-grid-grouprow-last")&&a("td:first",m).width(b.gridtablewidth)}var f=m.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");while(true){if(f.length==0)break;if(s){f.show();f.hasClass("l-grid-detailpanel")&&!f.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")&&f.hide()}else f.hide();f=f.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}b.trigger(s?"groupExtend":"groupCollapse");b.trigger("SysGridHeightChanged")}else if(c.treelink)b.toggle(c.data);else if(c.row&&b.enabledCheckbox()){var v=d.selectRowButtonOnly?true:false;if(d.enabledEdit)v=true;if(y.tagName.toLowerCase()=="a")return;if((c.checkbox||!v)&&d.selectable!=false){var e=a(c.row),h=e.hasClass("l-selected");if(b.trigger("beforeCheckRow",[!h,c.data,c.data.__id,c.row])==false)return false;var x=h?"unselect":"select";b[x](c.data);if(d.tree&&d.autoCheckChildren)for(var w=b.getChildren(c.data,true),j=0,z=w.length;j<z;j++)b[x](w[j]);b.trigger("checkRow",[!h,c.data,c.data.__id,c.row])}!c.checkbox&&c.cell&&d.enabledEdit&&d.clickToEdit&&b._applyEditor(c.cell)}else if(c.row&&!b.enabledCheckbox()&&d.selectable!=false){c.cell&&d.enabledEdit&&d.clickToEdit&&b._applyEditor(c.cell);if(a(c.row).hasClass("l-selected")){if(!d.allowUnSelectRow){a(c.row).addClass("l-selected-again");return}b.unselect(c.data)}else b.select(c.data)}else if(c.toolbar)if(c.first){if(b.trigger("toFirst",[b.element])==false)return false;b.changePage("first")}else if(c.prev){if(b.trigger("toPrev",[b.element])==false)return false;b.changePage("prev")}else if(c.next){if(b.trigger("toNext",[b.element])==false)return false;b.changePage("next")}else if(c.last){if(b.trigger("toLast",[b.element])==false)return false;b.changePage("last")}else if(c.load){if(a("span",c.load).hasClass("l-disabled"))return false;if(b.trigger("reload",[b.element])==false)return false;if(d.url&&b.isDataChanged&&!confirm(d.isContinueByDataChanged))return false;b.loadData(d.where)}},select:function(i){var b=this,h=this.options,c=b.getRow(i),e=c.__id,d=b.getRowObj(e);if(!h.rowSelectable||b.trigger("beforeSelectRow",[c,e,d])==false)return;var g=b.getRowObj(e,true);if(!b.enabledCheckbox()&&!b.ctrlKey||h.isSingleCheck){for(var j in b.selected){var f=b.selected[j];if(f.__id in b.records){a(b.getRowObj(f)).removeClass("l-selected l-selected-again");b.enabledFrozen()&&a(b.getRowObj(f,true)).removeClass("l-selected l-selected-again")}}b.selected=[]}d&&a(d).addClass("l-selected");g&&a(g).addClass("l-selected");b.selected[b.selected.length]=c;b.trigger("selectRow",[c,e,d])},unselect:function(g){var b=this,h=this.options,c=b.getRow(g),d=c.__id,e=b.getRowObj(d),f=b.getRowObj(d,true);a(e).removeClass("l-selected l-selected-again");b.enabledFrozen()&&a(f).removeClass("l-selected l-selected-again");b._removeSelected(c);b.trigger("unSelectRow",[c,d,e])},isSelected:function(c){var a=this,e=this.options,b=a.getRow(c);for(var d in a.selected)if(a.selected[d]==b)return true;return false},arrayToTree:function(b,n,m){var o=this,l=this.options,c="children";if(l.tree)c=l.tree.childrenName;if(!b||!b.length)return[];for(var g=[],h={},f=b.length,a=0;a<f;a++){var k=b[a],j=i(k[n]);h[j]=k}for(var a=0;a<f;a++){var e=b[a],j=i(e[m]),d=h[j];if(!d){g.push(e);continue}d[c]=d[c]||[];d[c].push(e)}return g;function i(a){if(typeof a=="string")a=a.replace(/[.]/g,"").toLowerCase();return a}},_onResize:function(){var b=this,c=this.options;if(c.height&&c.height!="auto"){var h=a(window).height(),e=0,d=null;if(typeof c.height=="string"&&c.height.indexOf("%")>0){var i=b.grid.parent();if(c.inWindow){d=h;d-=parseInt(a("body").css("paddingTop"));d-=parseInt(a("body").css("paddingBottom"))}else d=i.height();e=d*parseInt(c.height)*.01;if(c.inWindow||i[0].tagName.toLowerCase()=="body")e-=b.grid.offset().top-parseInt(a("body").css("paddingTop"))}else e=parseInt(c.height);e+=c.heightDiff;b.windowHeight=h;b._setHeight(e)}else b._updateHorizontalScrollStatus.ligerDefer(b,10);if(b.enabledFrozen()){var f=b.gridview1.width(),g=b.gridview.width();if(g-f<=0)b.gridview2.css({width:"auto"});else b.gridview2.css({width:g-f})}b.trigger("SysGridHeightChanged")},_f_gridLayout_autoAdapt:function(f){for(var b=this,j=1;j<=b._columnMaxLevel;j++){var m=b.getColumns(j),i=m.length;a(m).each(function(b,a){if(a.isrownumber||a.hide||a.ischeckbox||a._hide)i=i-1});var g=parseInt((f-12)/i);jQuery(".l-grid-header2 .l-grid-hd-cell").css({width:g});if(b.gridview2!=undefined){var k=b.gridview2[0].children[0].children[0];k!=undefined&&jQuery("."+k.className).css({width:f-12})}var e=b.gridbody[0].children[0];if(e!=undefined){var n="."+e.className;jQuery(n).css({width:f-12});var l=e.children[0];if(l!=undefined){var h=l.children[0].children;if(h!=undefined){var d=h[0].children[0].className,c=h[0].children[0].children[0].className;d!=null&&d!=""&&jQuery(".l-grid-body2 ."+d).css({width:g});c!=null&&c!=""&&jQuery(".l-grid-body2 ."+c).css({width:g-10})}}}}},showFilter:function(){var b=this,i=this.options;if(b.winfilter){b.winfilter.show();return}var d=a('<div id="'+b.id+'_filtercontainer"></div>').width(380).height(120).hide(),c=d.ligerFilter({fields:g()});c.addRule(a(c.element.firstChild));return b.winfilter=a.ligerDialog.open({width:420,height:208,target:d,isResize:true,top:50,buttons:[{text:"\u786e\u5b9a",onclick:function(b,a){h();a.hide()}},{text:"\u53d6\u6d88",onclick:function(b,a){a.hide()}}]});function g(){var c=[];a(b.columns).each(function(){var a={name:this.name,display:this.display},b=this.type=="int"||this.type=="number"||this.type=="float",d=this.type=="date";if(b)a.type="number";if(d)a.type="date";if(this.editor)a.editor=this.editor;c.push(a)});return c}function h(){var a=c.getData();if(b.options.dataType=="server")f(a);else e(a)}function f(a){if(a&&a.rules&&a.rules.length)b.setParm("where",JSON.stringify(a));else b.removeParm("where");b.loadData()}function e(c){b.loadData(a.ligerFilter.getFilterFunction(c))}}});a.ligerui.controls.Grid.prototype.enabledTotal=a.ligerui.controls.Grid.prototype.isTotalSummary;a.ligerui.controls.Grid.prototype.add=a.ligerui.controls.Grid.prototype.addRow;a.ligerui.controls.Grid.prototype.update=a.ligerui.controls.Grid.prototype.updateRow;a.ligerui.controls.Grid.prototype.append=a.ligerui.controls.Grid.prototype.appendRow;a.ligerui.controls.Grid.prototype.getSelected=a.ligerui.controls.Grid.prototype.getSelectedRow;a.ligerui.controls.Grid.prototype.getSelecteds=a.ligerui.controls.Grid.prototype.getSelectedRows;a.ligerui.controls.Grid.prototype.getCheckedRows=a.ligerui.controls.Grid.prototype.getSelectedRows;a.ligerui.controls.Grid.prototype.getCheckedRowObjs=a.ligerui.controls.Grid.prototype.getSelectedRowObjs;a.ligerui.controls.Grid.prototype.setOptions=a.ligerui.controls.Grid.prototype.set;a.ligerui.controls.Grid.prototype.reload=a.ligerui.controls.Grid.prototype.loadData;a.ligerui.controls.Grid.prototype.refreshSize=a.ligerui.controls.Grid.prototype._onResize;a.ligerui.controls.Grid.prototype.append=a.ligerui.controls.Grid.prototype.appendRange;function b(b,c){for(var a=b.length-1;a>=0;a--)c(b[a])&&b.splice(a,1)}})(jQuery);(function(a){a.fn.ligerLayout=function(){return a.ligerui.run.call(this,"ligerLayout",arguments)};a.fn.ligerGetLayoutManager=function(){return a.ligerui.run.call(this,"ligerGetLayoutManager",arguments)};a.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,centerBottomHeight:100,allowCenterBottomResize:true,inWindow:true,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:false,isRightCollapse:false,allowLeftCollapse:true,allowRightCollapse:true,allowLeftResize:true,allowRightResize:true,allowTopResize:true,allowBottomResize:true,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80,onLeftToggle:null,onRightToggle:null};a.ligerMethos.Layout={};a.ligerui.controls.Layout=function(b,c){a.ligerui.controls.Layout.base.constructor.call(this,b,c)};a.ligerui.controls.Layout.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return a.ligerMethos.Layout},_init:function(){a.ligerui.controls.Layout.base._init.call(this);var c=this,b=this.options;if(b.InWindow!=null&&b.inWindow==null)b.inWindow=b.InWindow},_render:function(){var b=this,c=this.options;b.layout=a(this.element);b.layout.addClass("l-layout");b.width=b.layout.width();if(a("> div[position=top]",b.layout).length>0){b.top=a("> div[position=top]",b.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent();b.top.content=a("> div[position=top]",b.top);!b.top.content.hasClass("l-layout-content")&&b.top.content.addClass("l-layout-content");b.topHeight=c.topHeight;b.topHeight&&b.top.height(b.topHeight)}if(a("> div[position=bottom]",b.layout).length>0){b.bottom=a("> div[position=bottom]",b.layout).wrap('<div class="l-layout-bottom"></div>').parent();b.bottom.content=a("> div[position=bottom]",b.bottom);!b.bottom.content.hasClass("l-layout-content")&&b.bottom.content.addClass("l-layout-content");b.bottomHeight=c.bottomHeight;b.bottomHeight&&b.bottom.height(b.bottomHeight);var e=b.bottom.content.attr("title");if(e){b.bottom.header=a('<div class="l-layout-header"></div>');b.bottom.prepend(b.bottom.header);b.bottom.header.html(e);b.bottom.content.attr("title","")}}if(a("> div[position=left]",b.layout).length>0){b.left=a("> div[position=left]",b.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent();b.left.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');b.left.prepend(b.left.header);b.left.header.toggle=a(".l-layout-header-toggle",b.left.header);b.left.content=a("> div[position=left]",b.left);!b.left.content.hasClass("l-layout-content")&&b.left.content.addClass("l-layout-content");!c.allowLeftCollapse&&a(".l-layout-header-toggle",b.left.header).remove();var g=b.left.content.attr("title");if(g){b.left.content.attr("title","");a(".l-layout-header-inner",b.left.header).html(g)}if(b.left.content.attr("hidetitle")){b.left.content.attr("title","");b.left.header.remove()}b.leftWidth=c.leftWidth;b.leftWidth&&b.left.width(b.leftWidth)}if(a("> div[position=center]",b.layout).length>0){b.center=a("> div[position=center]",b.layout).wrap('<div class="l-layout-center" ></div>').parent();b.center.content=a("> div[position=center]",b.center);b.center.content.addClass("l-layout-content");var d=b.center.content.attr("title");if(d){b.center.content.attr("title","");b.center.header=a('<div class="l-layout-header"></div>');b.center.prepend(b.center.header);b.center.header.html(d)}if(b.center.content.attr("hidetitle")){b.center.content.attr("title","");b.center.header.remove()}b.centerWidth=c.centerWidth;b.centerWidth&&b.center.width(b.centerWidth);if(a("> div[position=centerbottom]",b.layout).length>0){b.centerBottom=a("> div[position=centerbottom]",b.layout).wrap('<div class="l-layout-centerbottom" ></div>').parent();b.centerBottom.content=a("> div[position=centerbottom]",b.centerBottom);b.centerBottom.content.addClass("l-layout-content");var d=b.centerBottom.content.attr("title");if(d){b.centerBottom.content.attr("title","");b.centerBottom.header=a('<div class="l-layout-header"></div>');b.centerBottom.prepend(b.centerBottom.header);b.centerBottom.header.html(d)}if(b.centerBottom.content.attr("hidetitle")){b.centerBottom.content.attr("title","");b.centerBottom.header&&b.centerBottom.header.remove()}b.centerWidth&&b.centerBottom.width(b.centerWidth)}}if(a("> div[position=right]",b.layout).length>0){b.right=a("> div[position=right]",b.layout).wrap('<div class="l-layout-right"></div>').parent();b.right.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');b.right.prepend(b.right.header);b.right.header.toggle=a(".l-layout-header-toggle",b.right.header);!c.allowRightCollapse&&a(".l-layout-header-toggle",b.right.header).remove();b.right.content=a("> div[position=right]",b.right);!b.right.content.hasClass("l-layout-content")&&b.right.content.addClass("l-layout-content");var f=b.right.content.attr("title");if(f){b.right.content.attr("title","");a(".l-layout-header-inner",b.right.header).html(f)}if(b.right.content.attr("hidetitle")){b.right.content.attr("title","");b.right.header.remove()}b.rightWidth=c.rightWidth;b.rightWidth&&b.right.width(b.rightWidth)}b.layout.lock=a("<div class='l-layout-lock'></div>");b.layout.append(b.layout.lock);b._addDropHandle();b.isLeftCollapse=c.isLeftCollapse;b.isRightCollapse=c.isRightCollapse;b.leftCollapse=a('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>');b.rightCollapse=a('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>');b.layout.append(b.leftCollapse).append(b.rightCollapse);b.leftCollapse.toggle=a("> .l-layout-collapse-left-toggle",b.leftCollapse);b.rightCollapse.toggle=a("> .l-layout-collapse-right-toggle",b.rightCollapse);b._setCollapse();b._bulid();a(window).resize(function(){b._onResize()});b.set(c);b.mask.height(b.layout.height())},setLeftCollapse:function(b){var a=this,c=this.options;if(!a.left)return false;a.isLeftCollapse=b;if(a.isLeftCollapse){a.leftCollapse.show();a.leftDropHandle&&a.leftDropHandle.hide();a.left.hide()}else{a.leftCollapse.hide();a.leftDropHandle&&a.leftDropHandle.show();a.left.show()}a._onResize();a.trigger("leftToggle",[b])},setRightCollapse:function(b){var a=this,c=this.options;if(!a.right)return false;a.isRightCollapse=b;a._onResize();if(a.isRightCollapse){a.rightCollapse.show();a.rightDropHandle&&a.rightDropHandle.hide();a.right.hide()}else{a.rightCollapse.hide();a.rightDropHandle&&a.rightDropHandle.show();a.right.show()}a._onResize();a.trigger("rightToggle",[b])},_bulid:function(){var b=this,c=this.options;a("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",b.layout).hover(function(){a(this).addClass("l-layout-header-over")},function(){a(this).removeClass("l-layout-header-over")});a(".l-layout-header-toggle",b.layout).hover(function(){a(this).addClass("l-layout-header-toggle-over")},function(){a(this).removeClass("l-layout-header-toggle-over")});a(".l-layout-header-toggle",b.left).click(function(){b.setLeftCollapse(true)});a(".l-layout-header-toggle",b.right).click(function(){b.setRightCollapse(true)});b.middleTop=0;if(b.top){b.middleTop+=b.top.height();b.middleTop+=parseInt(b.top.css("borderTopWidth"));b.middleTop+=parseInt(b.top.css("borderBottomWidth"));b.middleTop+=c.space}if(b.left){b.left.css({top:b.middleTop});b.leftCollapse.css({top:b.middleTop})}b.center&&b.center.css({top:b.middleTop});if(b.right){b.right.css({top:b.middleTop});b.rightCollapse.css({top:b.middleTop})}b.left&&b.left.css({left:0});b._onResize();b._onResize()},_setCollapse:function(){var b=this,c=this.options;b.leftCollapse.hover(function(){a(this).addClass("l-layout-collapse-left-over")},function(){a(this).removeClass("l-layout-collapse-left-over")});b.leftCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-left-toggle-over")},function(){a(this).removeClass("l-layout-collapse-left-toggle-over")});b.rightCollapse.hover(function(){a(this).addClass("l-layout-collapse-right-over")},function(){a(this).removeClass("l-layout-collapse-right-over")});b.rightCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-right-toggle-over")},function(){a(this).removeClass("l-layout-collapse-right-toggle-over")});b.leftCollapse.toggle.click(function(){b.setLeftCollapse(false)});b.rightCollapse.toggle.click(function(){b.setRightCollapse(false)});if(b.left&&b.isLeftCollapse){b.leftCollapse.show();b.leftDropHandle&&b.leftDropHandle.hide();b.left.hide()}if(b.right&&b.isRightCollapse){b.rightCollapse.show();b.rightDropHandle&&b.rightDropHandle.hide();b.right.hide()}},_addDropHandle:function(){var b=this,c=this.options;if(b.left&&c.allowLeftResize){b.leftDropHandle=a("<div class='l-layout-drophandle-left'></div>");b.layout.append(b.leftDropHandle);b.leftDropHandle&&b.leftDropHandle.show();b.leftDropHandle.mousedown(function(a){b._start("leftresize",a)})}if(b.right&&c.allowRightResize){b.rightDropHandle=a("<div class='l-layout-drophandle-right'></div>");b.layout.append(b.rightDropHandle);b.rightDropHandle&&b.rightDropHandle.show();b.rightDropHandle.mousedown(function(a){b._start("rightresize",a)})}if(b.top&&c.allowTopResize){b.topDropHandle=a("<div class='l-layout-drophandle-top'></div>");b.layout.append(b.topDropHandle);b.topDropHandle.show();b.topDropHandle.mousedown(function(a){b._start("topresize",a)})}if(b.bottom&&c.allowBottomResize){b.bottomDropHandle=a("<div class='l-layout-drophandle-bottom'></div>");b.layout.append(b.bottomDropHandle);b.bottomDropHandle.show();b.bottomDropHandle.mousedown(function(a){b._start("bottomresize",a)})}if(b.centerBottom&&c.allowCenterBottomResize){b.centerBottomDropHandle=a("<div class='l-layout-drophandle-centerbottom'></div>");b.layout.append(b.centerBottomDropHandle);b.centerBottomDropHandle.show();b.centerBottomDropHandle.mousedown(function(a){b._start("centerbottomresize",a)})}b.draggingxline=a("<div class='l-layout-dragging-xline'></div>");b.draggingyline=a("<div class='l-layout-dragging-yline'></div>");b.mask=a("<div class='l-dragging-mask'></div>");b.layout.append(b.draggingxline).append(b.draggingyline).append(b.mask)},_setDropHandlePosition:function(){var a=this,b=this.options;a.leftDropHandle&&a.leftDropHandle.css({left:a.left.width()+parseInt(a.left.css("left")),height:a.middleHeight,top:a.middleTop});a.rightDropHandle&&a.rightDropHandle.css({left:parseInt(a.right.css("left"))-b.space,height:a.middleHeight,top:a.middleTop});a.topDropHandle&&a.topDropHandle.css({top:a.top.height()+parseInt(a.top.css("top")),width:a.top.width()});a.bottomDropHandle&&a.bottomDropHandle.css({top:parseInt(a.bottom.css("top"))-b.space,width:a.bottom.width()});a.centerBottomDropHandle&&a.centerBottomDropHandle.css({top:parseInt(a.centerBottom.css("top"))-b.space,left:parseInt(a.center.css("left")),width:a.center.width()})},_onResize:function(){var b=this,c=this.options,h=b.layout.height(),e=0,i=a(window).height(),d=null;if(typeof c.height=="string"&&c.height.indexOf("%")>0){var g=b.layout.parent();if(c.inWindow||g[0].tagName.toLowerCase()=="body"){d=i;d-=parseInt(a("body").css("paddingTop"));d-=parseInt(a("body").css("paddingBottom"))}else d=g.height();e=d*parseFloat(c.height)*.01;if(c.inWindow||g[0].tagName.toLowerCase()=="body")e-=b.layout.offset().top-parseInt(a("body").css("paddingTop"))}else e=parseInt(c.height);e+=c.heightDiff;b.layout.height(e);b.layoutHeight=b.layout.height();b.middleWidth=b.layout.width();b.middleHeight=b.layout.height();if(b.top){b.middleHeight-=b.top.height();b.middleHeight-=parseInt(b.top.css("borderTopWidth"));b.middleHeight-=parseInt(b.top.css("borderBottomWidth"));b.middleHeight-=c.space}if(b.bottom){b.middleHeight-=b.bottom.height();b.middleHeight-=parseInt(b.bottom.css("borderTopWidth"));b.middleHeight-=parseInt(b.bottom.css("borderBottomWidth"));b.middleHeight-=c.space}b.middleHeight-=2;b.hasBind("heightChanged")&&b.layoutHeight!=h&&b.trigger("heightChanged",[{layoutHeight:b.layoutHeight,diff:b.layoutHeight-h,middleHeight:b.middleHeight}]);if(b.center){b.centerWidth=b.middleWidth;if(b.left)if(b.isLeftCollapse){b.centerWidth-=b.leftCollapse.width();b.centerWidth-=parseInt(b.leftCollapse.css("borderLeftWidth"));b.centerWidth-=parseInt(b.leftCollapse.css("borderRightWidth"));b.centerWidth-=parseInt(b.leftCollapse.css("left"));b.centerWidth-=c.space}else{b.centerWidth-=b.leftWidth;b.centerWidth-=parseInt(b.left.css("borderLeftWidth"));b.centerWidth-=parseInt(b.left.css("borderRightWidth"));b.centerWidth-=parseInt(b.left.css("left"));b.centerWidth-=c.space}if(b.right)if(b.isRightCollapse){b.centerWidth-=b.rightCollapse.width();b.centerWidth-=parseInt(b.rightCollapse.css("borderLeftWidth"));b.centerWidth-=parseInt(b.rightCollapse.css("borderRightWidth"));b.centerWidth-=parseInt(b.rightCollapse.css("right"));b.centerWidth-=c.space}else{b.centerWidth-=b.rightWidth;b.centerWidth-=parseInt(b.right.css("borderLeftWidth"));b.centerWidth-=parseInt(b.right.css("borderRightWidth"));b.centerWidth-=c.space}b.centerLeft=0;if(b.left)if(b.isLeftCollapse){b.centerLeft+=b.leftCollapse.width();b.centerLeft+=parseInt(b.leftCollapse.css("borderLeftWidth"));b.centerLeft+=parseInt(b.leftCollapse.css("borderRightWidth"));b.centerLeft+=parseInt(b.leftCollapse.css("left"));b.centerLeft+=c.space}else{b.centerLeft+=b.left.width();b.centerLeft+=parseInt(b.left.css("borderLeftWidth"));b.centerLeft+=parseInt(b.left.css("borderRightWidth"));b.centerLeft+=c.space}b.center.css({left:b.centerLeft});b.centerWidth>=0&&b.center.width(b.centerWidth);b.middleHeight>=0&&b.center.height(b.middleHeight);var f=b.middleHeight;if(b.center.header)f-=b.center.header.height();f>=0&&b.center.content.height(f);b._updateCenterBottom(true)}if(b.left){b.leftCollapse.height(b.middleHeight);b.left.height(b.middleHeight)}if(b.right){b.rightCollapse.height(b.middleHeight);b.right.height(b.middleHeight);b.rightLeft=0;if(b.left)if(b.isLeftCollapse){b.rightLeft+=b.leftCollapse.width();b.rightLeft+=parseInt(b.leftCollapse.css("borderLeftWidth"));b.rightLeft+=parseInt(b.leftCollapse.css("borderRightWidth"));b.rightLeft+=c.space}else{b.rightLeft+=b.left.width();b.rightLeft+=parseInt(b.left.css("borderLeftWidth"));b.rightLeft+=parseInt(b.left.css("borderRightWidth"));b.rightLeft+=parseInt(b.left.css("left"));b.rightLeft+=c.space}if(b.center){b.rightLeft+=b.center.width();b.rightLeft+=parseInt(b.center.css("borderLeftWidth"));b.rightLeft+=parseInt(b.center.css("borderRightWidth"));b.rightLeft+=c.space}b.right.css({left:b.rightLeft})}if(b.bottom){b.bottomTop=b.layoutHeight-b.bottom.height()-2;b.bottom.css({top:b.bottomTop})}b._setDropHandlePosition()},_updateCenterBottom:function(d){var a=this,g=this.options;if(a.centerBottom){if(d){var b=a.centerBottomHeight||g.centerBottomHeight;a.centerBottom.css({left:a.centerLeft});a.centerWidth>=0&&a.centerBottom.width(a.centerWidth);var c=a.center.height(),f=parseInt(a.center.css("top"));a.centerBottom.height(b);a.centerBottom.css({top:f+c-b+2});a.center.height(c-b-2)}var e=parseInt(a.center.css("left"));a.centerBottom.width(a.center.width()).css({left:e})}},_start:function(c,d){var b=this,e=this.options;b.dragtype=c;if(c=="leftresize"||c=="rightresize"){b.xresize={startX:d.pageX};b.draggingyline.css({left:d.pageX-b.layout.offset().left,height:b.middleHeight,top:b.middleTop}).show();a("body").css("cursor","col-resize");b.mask.height(b.layout.height()).removeClass("l-layout-ymask").addClass("l-layout-xmask").show()}else if(c=="topresize"||c=="bottomresize"){b.yresize={startY:d.pageY};b.draggingxline.css({top:d.pageY-b.layout.offset().top,width:b.layout.width()}).show();a("body").css("cursor","row-resize");b.mask.height(b.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show()}else if(c=="centerbottomresize"){b.yresize={startY:d.pageY};b.draggingxline.css({top:d.pageY-b.layout.offset().top,width:b.layout.width()}).show();a("body").css("cursor","row-resize");b.mask.height(b.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show()}else return;b.layout.lock.width(b.layout.width());b.layout.lock.height(b.layout.height());b.layout.lock.show();(a.browser.msie||a.browser.safari)&&a("body").bind("selectstart",function(){return false});a(document).bind("mouseup",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove",function(){b._drag.apply(b,arguments)})},_drag:function(c){var b=this,d=this.options;if(b.xresize){b.xresize.diff=c.pageX-b.xresize.startX;b.draggingyline.css({left:c.pageX-b.layout.offset().left});a("body").css("cursor","col-resize")}else if(b.yresize){b.yresize.diff=c.pageY-b.yresize.startY;b.draggingxline.css({top:c.pageY-b.layout.offset().top});a("body").css("cursor","row-resize")}},_stop:function(f){var b=this,c=this.options,d;if(b.xresize&&b.xresize.diff!=undefined){d=b.xresize.diff;if(b.dragtype=="leftresize"){if(c.minLeftWidth)if(b.leftWidth+b.xresize.diff<c.minLeftWidth)return;b.leftWidth+=b.xresize.diff;b.left.width(b.leftWidth);if(b.center)b.center.width(b.center.width()-b.xresize.diff).css({left:parseInt(b.center.css("left"))+b.xresize.diff});else b.right&&b.right.width(b.left.width()-b.xresize.diff).css({left:parseInt(b.right.css("left"))+b.xresize.diff})}else if(b.dragtype=="rightresize"){if(c.minRightWidth)if(b.rightWidth-b.xresize.diff<c.minRightWidth)return;b.rightWidth-=b.xresize.diff;b.right.width(b.rightWidth).css({left:parseInt(b.right.css("left"))+b.xresize.diff});if(b.center)b.center.width(b.center.width()+b.xresize.diff);else b.left&&b.left.width(b.left.width()+b.xresize.diff)}b._updateCenterBottom()}else if(b.yresize&&b.yresize.diff!=undefined){d=b.yresize.diff;if(b.dragtype=="topresize"){b.top.height(b.top.height()+b.yresize.diff);b.middleTop+=b.yresize.diff;b.middleHeight-=b.yresize.diff;if(b.left){b.left.css({top:b.middleTop}).height(b.middleHeight);b.leftCollapse.css({top:b.middleTop}).height(b.middleHeight)}b.center&&b.center.css({top:b.middleTop}).height(b.middleHeight);if(b.right){b.right.css({top:b.middleTop}).height(b.middleHeight);b.rightCollapse.css({top:b.middleTop}).height(b.middleHeight)}b._updateCenterBottom(true)}else if(b.dragtype=="bottomresize"){b.bottom.height(b.bottom.height()-b.yresize.diff);b.middleHeight+=b.yresize.diff;b.bottomTop+=b.yresize.diff;b.bottom.css({top:b.bottomTop});if(b.left){b.left.height(b.middleHeight);b.leftCollapse.height(b.middleHeight)}b.center&&b.center.height(b.middleHeight);if(b.right){b.right.height(b.middleHeight);b.rightCollapse.height(b.middleHeight)}b._updateCenterBottom(true)}else if(b.dragtype=="centerbottomresize"){b.centerBottomHeight=b.centerBottomHeight||c.centerBottomHeight;b.centerBottomHeight-=b.yresize.diff;var e=parseInt(b.centerBottom.css("top"));b.centerBottom.css("top",e+b.yresize.diff);b.centerBottom.height(b.centerBottom.height()-b.yresize.diff);b.center.height(b.center.height()+b.yresize.diff)}}b.trigger("endResize",[{direction:b.dragtype?b.dragtype.replace(/resize/,""):"",diff:d},f]);b._setDropHandlePosition();b.draggingxline.hide();b.draggingyline.hide();b.mask.hide();b.xresize=b.yresize=b.dragtype=false;b.layout.lock.hide();(a.browser.msie||a.browser.safari)&&a("body").unbind("selectstart");a(document).unbind("mousemove",b._drag);a(document).unbind("mouseup",b._stop);a("body").css("cursor","")}})})(jQuery);(function(a){a.fn.ligerListBox=function(){return a.ligerui.run.call(this,"ligerListBox",arguments)};a.ligerDefaults.ListBox={isMultiSelect:false,isShowCheckBox:false,columns:null,width:150,height:100,onSelect:false,onSelected:null,valueField:"id",textField:"text",valueFieldID:null,split:";",data:null,parms:null,url:null,urlParms:null,ajaxContentType:null,ajaxType:"post",onSuccess:null,onError:null,render:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.ListBox=a.ligerMethos.ListBox||{};a.ligerui.controls.ListBox=function(b,c){a.ligerui.controls.ListBox.base.constructor.call(this,b,c)};a.ligerui.controls.ListBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"ListBox"},_extendMethods:function(){return a.ligerMethos.ListBox},_init:function(){a.ligerui.controls.ListBox.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(a(this.element).is(":hidden")||a(this.element).is(":text")){b.valueField=a(this.element);a(this.element).is(":text")&&b.valueField.hide()}else if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0)b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null)b.valueField[0].name=b.valueField[0].id;c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass);b.valueField.attr("data-ligerid",b.id);if(a(this.element).is(":hidden")||a(this.element).is(":text"))b.selectBox=a("<div></div>").insertBefore(this.element);else b.selectBox=a(this.element);b.selectBox.html('<div class="l-listbox-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-listbox-table"></table></div>').addClass("l-listbox").append(b.valueField);b.selectBox.table=a("table:first",b.selectBox);b.set(c);b._addClickEven()},destroy:function(){this.selectBox&&this.selectBox.remove();this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setIsShowCheckBox:function(b){if(b)a("table",this.selectBox).addClass("l-table-checkbox");else a("table",this.selectBox).addClass("l-table-nocheckbox")},_setCss:function(a){a&&this.selectBox.addClass(a)},_setDisabled:function(a){if(a)this.selectBox.addClass("l-text-disabled");else this.selectBox.removeClass("l-text-disabled")},_setWidth:function(a){this.selectBox.width(a)},_setHeight:function(a){this.selectBox.height(a)},getText:function(){var a=this.getValue();return this.findTextByValue(a)},findTextByValue:function(c){var f=this,b=this.options;if(c==null||c=="")return"";var d=[],e=function(e){for(var d=c.toString().split(b.split),a=0;a<d.length;a++)if(d[a]==e)return true;return false};a(f.data).each(function(g,a){var f=a[b.valueField],c=a[b.textField];e(f)&&d.push(c)});return d.join(b.split)},getDataByValue:function(c){for(var b=this,e=this.options,a=0,d=b.data.length;a<d;a++)if(b.data[a][e.valueField]==c)return b.data[a];return null},indexOf:function(c){var b=this,d=this.options;if(!b.data)return-1;for(var e=typeof c=="object",a=0,f=b.data.length;a<f;a++)if(e){if(b.data[a]==c)return a}else if(b.data[a][d.valueField]&&b.data[a][d.valueField].toString()==c.toString())return a;return-1},removeItems:function(c){var b=this;if(!b.data)return;a(c).each(function(d,c){var a=b.indexOf(c);if(a==-1)return;b.data.splice(a,1)});b.refresh()},removeItem:function(b){if(!this.data)return;var a=this.indexOf(b);if(a==-1)return;this.data.splice(a,1);this.refresh()},insertItem:function(c,b){var a=this;if(!a.data)a.data=[];a.data.splice(b,0,c);a.refresh()},addItems:function(c){var b=this;if(!b.data)b.data=[];a(c).each(function(c,a){b.data.push(a)});b.refresh()},addItem:function(b){var a=this;if(!a.data)a.data=[];a.data.push(b);a.refresh()},getSelectedItems:function(){var b=this,e=this.options;if(!b.data)return null;var d=b.getValue();if(!d)return null;var c=[];a(d.split(e.split)).each(function(){var a=b.indexOf(this.toString());a!=-1&&c.push(b.data[a])});return c},_setValue:function(a){var c=this,b=this.options;b.value=a;this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(c){if(!c)return;var e=this,b=this.options,f=a.isFunction(b.urlParms)?b.urlParms.call(e):b.urlParms;if(f)for(name in f){c+=c.indexOf("?")==-1?"?":"&";c+=name+"="+f[name]}var d=a.isFunction(b.parms)?b.parms():b.parms;if(b.ajaxContentType=="application/json"&&typeof d!="string")d=liger.toJSON(d);var g={type:b.ajaxType||"post",url:c,data:d,cache:false,dataType:"json",success:function(a){e.setData(a);e.trigger("success",[a])},error:function(a,b){e.trigger("error",[a,b])}};if(b.ajaxContentType)g.contentType=b.ajaxContentType;a.ajax(g)},reload:function(){this.set("url",this.options.url)},setUrl:function(a){return this._setUrl(a)},setParm:function(b,d){if(!b)return;var c=this,a=c.get("parms");if(!a)a={};a[b]=d;c.set("parms",a)},clearContent:function(){var b=this,c=this.options;a("table",b.selectBox).html("")},_setColumns:function(a){var b=this,c=this.options;c.columns=a;b.refresh()},_setData:function(a){this.setData(a)},setData:function(a){var b=this,c=this.options;if(!a||!a.length)return;b.data=a;b.refresh();b.updateStyle()},refresh:function(){var g=this,b=this.options,f=this.data;this.clearContent();if(!f)return;if(b.columns){g.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px' class='l-checkboxrow'></td></tr>");g.selectBox.table.append(g.selectBox.table.headrow);g.selectBox.table.addClass("l-listbox-grid");for(var c=0;c<b.columns.length;c++){var j=a("<td columnindex='"+c+"' columnname='"+b.columns[c].name+"'>"+b.columns[c].header+"</td>");b.columns[c].width&&j.width(b.columns[c].width);g.selectBox.table.headrow.append(j)}}for(var d=[],e=0;e<f.length;e++){var l=f[e][b.valueField],k=f[e][b.textField],h=" value='"+l+"' index='"+e+"'";if(!b.columns){d.push("<tr "+h+">");d.push("<td style='width:18px;' class='l-checkboxrow'><input type='checkbox'"+h+"/></td>");var i=k;if(b.render)i=b.render({data:f[e],value:l,text:k});d.push("<td align='left'>"+i+"</td></tr>")}else{d.push("<tr "+h+"><td style='width:18px;' class='l-checkboxrow'><input type='checkbox' "+h+"/></td>");for(var c=0;c<b.columns.length;c++){var m=b.columns[c].name;d.push("<td>"+f[e][m]+"</td>")}d.push("</tr>")}}g.selectBox.table.append(d.join(""))},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},selectAll:function(){var b=this,d=this.options,c=[];a("tr",b.selectBox).each(function(){var b=a(this);c.push(b.attr("value"))});a("tr",b.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=true});b.valueField.val(c.join(d.split))},_dataInit:function(){var b=this,d=this.options,c=d.value;if(c!=null)b._changeValue(c);else if(b.valueField.val()!="")d.value=b.valueField.val();var e=(c||"").toString().split(d.split);a("tr.l-selected",b.selectBox).removeClass("l-selected").find(":checkbox").each(function(){this.checked=false});a(e).each(function(d,c){a("tr[value='"+c+"']",b.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=true})})},_changeValue:function(a){var b=this,c=this.options;b.valueField.val(a);b.selectedValue=a},_updateValue:function(){var c=this,d=this.options,b=[];a("tr",c.selectBox).each(function(){var c=a(this);c.hasClass("l-selected")&&b.push(c.attr("value"))});c._changeValue(b.join(d.split))},_addClickEven:function(){var b=this,c=this.options;b.selectBox.click(function(h){var i=h.target||h.srcElement,d=a(i).parents("tr:first");if(!d.length)return;var e=d.attr("value"),g=b.findTextByValue(e),f=b.getDataByValue(e);if(b.hasBind("select"))if(b.trigger("select",[e,g,f])==false)return false;!c.isMultiSelect&&a("tr.l-selected",b.selectBox).not(d).removeClass("l-selected").find(":checkbox").each(function(){this.checked=false});if(d.hasClass("l-selected"))d.removeClass("l-selected");else d.addClass("l-selected");d.find(":checkbox").each(function(){this.checked=d.hasClass("l-selected")});b._updateValue();b.trigger("selected",[e,g,f])})}})})(jQuery);(function(a){a.ligerMenu=function(){return a.ligerui.run.call(null,"ligerMenu",arguments)};a.ligerDefaults.Menu={width:120,top:0,left:0,cls:null,items:null,shadow:true};a.ligerMethos.Menu={};a.ligerui.controls.Menu=function(b){a.ligerui.controls.Menu.base.constructor.call(this,null,b)};a.ligerui.controls.Menu.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return a.ligerMethos.Menu},_render:function(){var b=this,c=this.options;b.menuItemCount=0;b.menus={};b.menu=b.createMenu();b.element=b.menu[0];b.menu.css({top:c.top,left:c.left,width:c.width});c.cls&&b.menu.addClass(c.cls);c.items&&a(c.items).each(function(c,a){b.addItem(a)});a(document).bind("click.menu",function(){for(var c in b.menus){var a=b.menus[c];if(!a)return;a.hide();a.shadow&&a.shadow.hide()}});b.set(c)},show:function(a,b){var c=this,d=this.options;if(b==undefined)b=c.menu;a&&a.left!=undefined&&b.css({left:a.left});a&&a.top!=undefined&&b.css({top:a.top});b.show();c.updateShadow(b)},updateShadow:function(a){var c=this,b=this.options;if(!b.shadow)return;a.shadow.css({left:a.css("left"),top:a.css("top"),width:a.outerWidth(),height:a.outerHeight()});if(a.is(":visible"))a.shadow.show();else a.shadow.hide()},hide:function(a){var b=this,c=this.options;if(a==undefined)a=b.menu;b.hideAllSubMenu(a);a.hide();b.updateShadow(a)},toggle:function(){var a=this,b=this.options;a.menu.toggle();a.updateShadow(a.menu)},removeItem:function(b){var c=this,d=this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).remove()},setEnabled:function(b){var c=this,d=this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).removeClass("l-menu-item-disable")},setMenuText:function(b,c){var d=this,e=this.options;a("> .l-menu-item[menuitemid="+b+"] >.l-menu-item-text:first",d.menu.items).html(c)},setDisabled:function(b){var c=this,d=this.options;a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).addClass("l-menu-item-disable")},isEnable:function(b){var c=this,d=this.options;return!a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var b=this,c=this.options;return a("> .l-menu-item",b.menu.items).length},addItem:function(b,e){var d=this,i=this.options;if(!b)return;if(e==undefined)e=d.menu;if(b.line){e.items.append('<div class="l-menu-item-line"></div>');return}var c=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>'),g=a("> .l-menu-item",e.items).length;e.items.append(c);c.attr("ligeruimenutemid",++d.menuItemCount);b.id&&c.attr("menuitemid",b.id);b.text&&a(">.l-menu-item-text:first",c).html(b.text);b.icon&&c.prepend('<div class="l-menu-item-icon l-icon-'+b.icon+'"></div>');b.img&&c.prepend('<div class="l-menu-item-icon"><img style="width:16px;height:16px;margin:2px;" src="'+b.img+'" /></div>');(b.disable||b.disabled)&&c.addClass("l-menu-item-disable");if(b.children){c.append('<div class="l-menu-item-arrow"></div>');var f=d.createMenu(c.attr("ligeruimenutemid"));d.menus[c.attr("ligeruimenutemid")]=f;f.width(i.width);f.hover(null,function(){!f.showedSubMenu&&d.hide(f)});a(b.children).each(function(){d.addItem(this,f)})}b.click&&c.click(function(){if(a(this).hasClass("l-menu-item-disable"))return;b.click(b,g)});b.dblclick&&c.dblclick(function(){if(a(this).hasClass("l-menu-item-disable"))return;b.dblclick(b,g)});var h=a("> .l-menu-over:first",e);c.hover(function(){if(a(this).hasClass("l-menu-item-disable"))return;var f=a(this).offset().top,g=f-e.offset().top;h.css({top:g});d.hideAllSubMenu(e);if(b.children){var c=a(this).attr("ligeruimenutemid");if(!c)return;if(d.menus[c]){d.show({top:f,left:a(this).offset().left+a(this).width()-5},d.menus[c]);e.showedSubMenu=true}}},function(){if(a(this).hasClass("l-menu-item-disable"))return;var c=a(this).attr("ligeruimenutemid");if(b.children){var c=a(this).attr("ligeruimenutemid");if(!c)return}})},hideAllSubMenu:function(b){var c=this,d=this.options;if(b==undefined)b=c.menu;a("> .l-menu-item",b.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var b=a(this).attr("ligeruimenutemid");if(!b)return;c.menus[b]&&c.hide(c.menus[b])}});b.showedSubMenu=false},createMenu:function(c){var d=this,e=this.options,b=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');c&&b.attr("ligeruiparentmenuitemid",c);b.items=a("> .l-menu-inner:first",b);b.appendTo("body");if(e.shadow){b.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(b);d.updateShadow(b)}b.hover(null,function(){!b.showedSubMenu&&a("> .l-menu-over:first",b).css({top:-24})});if(c)d.menus[c]=b;else d.menus[0]=b;return b}});a.ligerui.controls.Menu.prototype.setEnable=a.ligerui.controls.Menu.prototype.setEnabled;a.ligerui.controls.Menu.prototype.setDisable=a.ligerui.controls.Menu.prototype.setDisabled})(jQuery);(function(a){a.fn.ligerMenuBar=function(){return a.ligerui.run.call(this,"ligerMenuBar",arguments)};a.fn.ligerGetMenuBarManager=function(){return a.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)};a.ligerDefaults.MenuBar={};a.ligerMethos.MenuBar={};a.ligerui.controls.MenuBar=function(b,c){a.ligerui.controls.MenuBar.base.constructor.call(this,b,c)};a.ligerui.controls.MenuBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return a.ligerMethos.MenuBar},_render:function(){var b=this,c=this.options;b.menubar=a(this.element);!b.menubar.hasClass("l-menubar")&&b.menubar.addClass("l-menubar");c&&c.items&&a(c.items).each(function(c,a){b.addItem(a)});a(document).click(function(){a(".l-panel-btn-selected",b.menubar).removeClass("l-panel-btn-selected")});b.set(c)},addItem:function(b){var d=this,f=this.options,c=a('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>');d.menubar.append(c);b.id&&c.attr("menubarid",b.id);b.text&&a("span:first",c).html(b.text);b.disable&&c.addClass("l-menubar-item-disable");b.click&&c.click(function(){b.click(b)});if(b.menu){var e=a.ligerMenu(b.menu);c.hover(function(){d.actionMenu&&d.actionMenu.hide();var b=a(this).offset().left,c=a(this).offset().top+a(this).height();e.show({top:c,left:b});d.actionMenu=e;a(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){a(this).removeClass("l-panel-btn-over")})}else{c.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")});a(".l-menubar-item-down",c).remove()}}})})(jQuery);(function(a){a.ligerMessageBox=function(){return a.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:true})};a.ligerDefaults.MessageBox={isDrag:true};a.ligerMethos.MessageBox={};a.ligerui.controls.MessageBox=function(b){a.ligerui.controls.MessageBox.base.constructor.call(this,null,b)};a.ligerui.controls.MessageBox.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return a.ligerMethos.MessageBox},_render:function(){var b=this,c=this.options,d="";d+='<div class="l-messagebox">';d+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>';d+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ';d+='        <div class="l-messagebox-image"></div>';d+='        <div class="l-messagebox-title">';d+='            <div class="l-messagebox-title-inner"></div>';d+='            <div class="l-messagebox-close"></div>';d+="        </div>";d+='        <div class="l-messagebox-content">';d+="        </div>";d+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">';d+="        </div></div>";d+="    </div>";b.messageBox=a(d);a("body").append(b.messageBox);b.messageBox.close=function(){b._removeWindowMask();b.messageBox.remove()};c.width&&b.messageBox.width(c.width);c.title&&a(".l-messagebox-title-inner",b.messageBox).html(c.title);c.content&&a(".l-messagebox-content",b.messageBox).html(c.content);if(c.buttons){a(c.buttons).each(function(e,c){var d=a('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');a(".l-messagebox-btn-inner",d).html(c.text);a(".l-messagebox-buttons-inner",b.messageBox).append(d);c.width&&d.width(c.width);c.onclick&&d.click(function(){c.onclick(c,e,b.messageBox)})});a(".l-messagebox-buttons-inner",b.messageBox).append("<div class='l-clear'></div>")}var h=b.messageBox.width(),g=0;a(".l-messagebox-buttons-inner .l-messagebox-btn",b.messageBox).each(function(){g+=a(this).width()});a(".l-messagebox-buttons-inner",b.messageBox).css({marginLeft:parseInt((h-g)*.5)});b._applyWindowMask();b._applyDrag();b._setImage();var e=0,f=0,i=c.width||b.messageBox.width();if(c.left!=null)e=c.left;else c.left=e=.5*(a(window).width()-i);if(c.top!=null)f=c.top;else c.top=f=.5*(a(window).height()-b.messageBox.height())+a(window).scrollTop()-10;if(e<0)c.left=e=0;if(f<0)c.top=f=0;b.messageBox.css({left:e,top:f});a(".l-messagebox-btn",b.messageBox).hover(function(){a(this).addClass("l-messagebox-btn-over")},function(){a(this).removeClass("l-messagebox-btn-over")});a(".l-messagebox-close",b.messageBox).hover(function(){a(this).addClass("l-messagebox-close-over")},function(){a(this).removeClass("l-messagebox-close-over")}).click(function(){b.messageBox.close()});b.set(c)},close:function(){var a=this,b=this.options;this.g._removeWindowMask();this.messageBox.remove()},_applyWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove();a("<div class='l-window-mask' style='display: block;'></div>").appendTo(a("body"))},_removeWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove()},_applyDrag:function(){var b=this,c=this.options;c.isDrag&&a.fn.ligerDrag&&b.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:false})},_setImage:function(){var b=this,c=this.options;if(c.type)if(c.type=="success"||c.type=="donne"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-donne").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else if(c.type=="error"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-error").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else if(c.type=="warn"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-warn").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else if(c.type=="question"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-question").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:40})}}});a.ligerMessageBox.show=function(b){return a.ligerMessageBox(b)};a.ligerMessageBox.alert=function(b,c,e,d){b=b||"";c=c||b;var f=function(c,b,a){a.close();d&&d(c,b,a)};p={title:b,content:c,buttons:[{text:"\u786e\u5b9a",onclick:f}]};if(e)p.type=e;return a.ligerMessageBox(p)};a.ligerMessageBox.confirm=function(e,d,b){var c=function(d,c,a){a.close();b&&b(c==0)};p={type:"question",title:e,content:d,buttons:[{text:"\u662f",onclick:c},{text:"\u5426",onclick:c}]};return a.ligerMessageBox(p)};a.ligerMessageBox.success=function(d,c,b){return a.ligerMessageBox.alert(d,c,"success",b)};a.ligerMessageBox.error=function(d,c,b){return a.ligerMessageBox.alert(d,c,"error",b)};a.ligerMessageBox.warn=function(d,c,b){return a.ligerMessageBox.alert(d,c,"warn",b)};a.ligerMessageBox.question=function(c,b){return a.ligerMessageBox.alert(c,b,"question")}})(jQuery);(function(a){a.fn.ligerPanel=function(){return a.ligerui.run.call(this,"ligerPanel",arguments)};a.ligerDefaults.Panel={width:400,height:300,title:"Panel",content:null,url:null,urlParms:null,frameName:null,data:null,showClose:false,showToggle:true,showRefresh:false,icon:null,onClose:null,onClosed:null,onLoaded:null,onToggle:null};a.ligerDefaults.PanelString={refreshMessage:"\u5237\u65b0",closeMessage:"\u5173\u95ed",expandMessage:"\u5c55\u5f00",collapseMessage:"\u6536\u8d77"};a.ligerMethos.Panel={};a.ligerui.controls.Panel=function(b,c){a.ligerui.controls.Panel.base.constructor.call(this,b,c)};a.ligerui.controls.Panel.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return a.ligerMethos.Panel},_init:function(){var c=this,b=this.options;a.ligerui.controls.Panel.base._init.call(this);b.content=b.content||a(c.element).html()},_render:function(){var b=this,c=this.options;b.panel=a(b.element).addClass("l-panel").html("");b.panel.append('<div class="l-panel-header"><span></span><div class="icons"></div></div><div class="l-panel-content"></div>');b.set(c);b.panel.find(".l-panel-header").hover(function(){a(this).addClass("l-panel-header-hover")},function(){a(this).removeClass("l-panel-header-hover")});b.panel.bind("click.panel",function(d){var f=d.target||d.srcElement,c=a(f);if(c.hasClass("l-panel-header-toggle")){var e=!b.panel.find(".l-panel-header .l-panel-header-toggle:first").hasClass("l-panel-header-toggle-hide");b.toggle();b.trigger("toggle",[e])}else if(c.hasClass("l-panel-header-close"))b.close();else c.hasClass("l-panel-header-refresh")&&b.refresh()})},_setChildren:function(b){var l=this,m=this.options,j={input:["textbox","combobox","select"]},i={grid:"ligerGrid",toolbar:"ligerToolBar",tree:"ligerTree",form:"ligerForm",menu:"ligerMenu",menubar:"ligerMenuBar",portal:"ligerPortal",combobox:"ligerComboBox",textbox:"ligerTextBox",spinner:"ligerSpinner",listbox:"ligerListBox",checkbox:"ligerCheckBox",radio:"ligerRadio",checkboxlist:"ligerCheckBoxList",radiolist:"ligerRadioList",popupedit:"ligerPopupEdit",button:"ligerButton",dateeditor:"ligerDateEditor",dialog:"ligerDialog",panel:"ligerPanel",layout:"ligerLayout",accordion:"ligerAccordion",tab:"ligerTab"};if(!b||!b.length)return;for(var c=0;c<b.length;c++){var g=b[c],h=g.type,k=j[h]||"div",f=i[h];if(!f)continue;var e=document.createElement(k);l.panel.find(".l-panel-content").append(e);var d=a.extend({},g);d.type=null;a(e)[f](d)}},collapse:function(){var a=this,c=this.options,b=a.panel.find(".l-panel-header .l-panel-header-toggle:first");if(b.hasClass("l-panel-header-toggle-hide"))return;a.toggle()},expand:function(){var a=this,c=this.options,b=a.panel.find(".l-panel-header .l-panel-header-toggle:first");if(!b.hasClass("l-panel-header-toggle-hide"))return;a.toggle()},toggle:function(){var b=this,c=this.options,a=b.panel.find(".l-panel-header .l-panel-header-toggle:first");if(a.hasClass("l-panel-header-toggle-hide")){a.removeClass("l-panel-header-toggle-hide");a.attr("title",c.collapseMessage)}else{a.addClass("l-panel-header-toggle-hide");a.attr("title",c.expandMessage)}b.panel.find(".l-panel-content:first").toggle()},refresh:function(){var a=this,b=this.options;a.set("url",b.url)},_setShowToggle:function(f){var d=this,e=this.options,b=d.panel.find(".l-panel-header:first");if(f){var c=a("<a class='l-panel-icon l-panel-header-toggle'></a>");c.appendTo(b.find(".icons"));c.attr("title",e.collapseMessage)}else b.find(".l-panel-header-toggle").remove()},_setContent:function(a){var c=this,d=this.options,b=c.panel.find(".l-panel-content:first");a&&b.html(a)},_setUrl:function(c){var b=this,d=this.options,e=b.panel.find(".l-panel-content:first");if(c){var f=a.isFunction(d.urlParms)?d.urlParms.call(b):d.urlParms;if(f)for(name in f){c+=c.indexOf("?")==-1?"?":"&";c+=name+"="+f[name]}if(!b.jiframe){b.jiframe=a("<iframe frameborder='0'></iframe>");var g=d.frameName?d.frameName:"ligerpanel"+(new Date).getTime();b.jiframe.attr("name",g);b.jiframe.attr("id",g);e.prepend(b.jiframe);b.jiframe[0].panel=b;b.frame=window.frames[b.jiframe.attr("name")]}setTimeout(function(){e.find(".l-panel-loading:first").length==0&&e.append("<div class='l-panel-loading' style='display:block;'></div>");var d=a(".l-panel-loading:first",e);b.jiframe.attr("src",c).bind("load.panel",function(){d.hide();b.trigger("loaded")})},0)}},_setShowClose:function(f){var d=this,e=this.options,b=d.panel.find(".l-panel-header:first");if(f){var c=a("<a class='l-panel-icon l-panel-header-close'></a>");c.appendTo(b.find(".icons"));c.attr("title",e.closeMessage)}else b.find(".l-panel-header-close").remove()},_setShowRefresh:function(f){var d=this,e=this.options,b=d.panel.find(".l-panel-header:first");if(f){var c=a("<a class='l-panel-icon l-panel-header-refresh'></a>");c.appendTo(b.find(".icons"));c.attr("title",e.refreshMessage)}else b.find(".l-panel-header-refresh").remove()},close:function(){var a=this,b=this.options;if(a.trigger("close")==false)return;a.panel.remove();a.trigger("closed")},show:function(){this.panel.show()},_setIcon:function(b){var a=this;if(!b){a.panel.removeClass("l-panel-hasicon");a.panel.find("img").remove()}else{a.panel.addClass("l-panel-hasicon");a.panel.append('<img src="'+b+'" />')}},_setWidth:function(a){if(typeof a=="string")if(a.indexOf("%")>-1)this.panel.width(a);else this.panel.width(parseInt(a));else this.panel.width(a)},_setHeight:function(b){var c=this,d=this.options,a=c.panel.find(".l-panel-header:first");this.panel.find(".l-panel-content:first").height(b-a.height())},_setTitle:function(a){this.panel.find(".l-panel-header span:first").text(a)}})})(jQuery);(function(a){a.fn.ligerPopupEdit=function(){return a.ligerui.run.call(this,"ligerPopupEdit",arguments)};a.fn.ligerGetPopupEditManager=function(){return a.ligerui.run.call(this,"ligerGetPopupEditManager",arguments)};a.ligerDefaults.PopupEdit={valueFieldID:null,css:null,onButtonClick:null,nullText:null,disabled:false,method:"post",async:true,cancelable:true,width:200,heigth:null,render:null,split:";",data:[],grid:null,condition:null,valueField:"id",textField:"text",parms:null,onSelect:null,onSelected:null,valueFieldCssClass:null,searchClick:null};a.ligerMethos.PopupEdit=a.ligerMethos.PopupEdit||{};a.ligerui.controls.PopupEdit=function(b,c){a.ligerui.controls.PopupEdit.base.constructor.call(this,b,c)};a.ligerui.controls.PopupEdit.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"PopupEdit"},_extendMethods:function(){return a.ligerMethos.PopupEdit},_init:function(){a.ligerui.controls.PopupEdit.base._init.call(this)},_render:function(){var b=this,c=this.options;b.inputText=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}if(b.inputText[0].name==undefined)b.inputText[0].name=b.textFieldID;b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input");if(b.valueField.length==0)b.valueField=a('<input type="hidden"/>');if(b.valueField[0].name==undefined)b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"}if(b.valueField[0].name==undefined)b.valueField[0].name=b.valueField[0].id;c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass);b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text l-text-popup"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.wrapper.append(b.valueField);b.valueField.attr("data-ligerid",b.id);b.inputText.addClass("l-text-field");b.link.hover(function(){if(c.disabled)return;this.className="l-trigger-hover"},function(){if(c.disabled)return;this.className="l-trigger"}).mousedown(function(){if(c.disabled)return;this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled)return;this.className="l-trigger-hover"}).click(function(){return c.disabled?void 0:b.trigger("buttonClick")==false?false:void 0});b.inputText.click(function(){if(c.disabled)return void 0}).blur(function(){if(c.disabled)return;b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled)return;b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(c.disabled)return;b.wrapper.addClass("l-text-over")},function(){if(c.disabled)return;b.wrapper.removeClass("l-text-over")});b.set(c);b.setTextByVal(b.getValue())},destroy:function(){this.wrapper&&this.wrapper.remove();this.options=null;a.ligerui.remove(this)},clear:function(){var a=this,b=this.options;a.inputText.val("");a.valueField.val("")},_setCss:function(a){a&&this.wrapper.addClass(a)},_setCancelable:function(c){var b=this,d=this.options;if(!c&&b.unselect){b.unselect.remove();b.unselect=null}if(!c&&!b.unselect)return;b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.wrapper.hover(function(){b.unselect.show()},function(){b.unselect.hide()});!d.disabled&&d.cancelable&&b.wrapper.append(b.unselect);b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){b.clear()})},_setDisabled:function(a){if(a)this.wrapper.addClass("l-text-disabled");else this.wrapper.removeClass("l-text-disabled")},_setWidth:function(a){var b=this;if(a>20){b.wrapper.css({width:a});b.inputText.css({width:a-20})}},_setHeight:function(a){var b=this;if(a>10){b.wrapper.height(a);b.inputText.height(a-2)}},getData:function(){var e=this,b=this.options,d=[],g=a(e.valueField).val(),f=a(e.inputText).val(),c=g?g.split(b.split):null,h=f?f.split(b.split):null;a(c).each(function(e){var a={};a[b.textField]=h[e];a[b.valueField]=c[e];d.push(a)});return d},_getText:function(){return a(this.inputText).val()},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},getText:function(){return this._getText()},setValue:function(a,c){if(a=="")return;var b=this,d=this.options;if(arguments.length>=2){b.setValue(a);b.setText(c);return}b.valueField.val(a)},setTextByVal:function(b){b=typeof b!="string"?b.toString:b;if(b=="")return;var f=this,e=[],c=this.options,h=[];f.valueField.val()!=b&&f.valueField.val(b);var d=c.grid;if(a.isFunction(d))d=d();var g=a.extend({parms:c.parms},d);if(c.data.length>0)h=c.data.Rows;else if(g.url){f.loadServerData(g.url,b);return}else h=g.data.Rows;var i=b.split(c.split);a(h).each(function(d,b){a.inArray(b[c.valueField],i)!=-1&&e.push(b[c.textField])});e=e.join(c.split);f.setText(e)},loadServerData:function(c,e){var f=this,b=this.options,g=[];if(a.isFunction(c))c=c();var d={type:b.method,url:c,async:b.async,dataType:"json",success:function(d){gridData=a.extend(true,{},d);b.data=gridData;gridData=d.Rows;var g=e.split(b.split),c=[];a(gridData).each(function(e,d){a.inArray(d[b.valueField],g)!=-1&&c.push(d[b.textField])});c=c.join(b.split);f.setText(c);return},error:function(){return}};a.ajax(d)},setText:function(a){var b=this,c=this.options;if(c.render)b.inputText.val(c.render(a));else b.inputText.val(a)},addValue:function(c,g){var d=this,b=this.options;if(!c)return;var h=d.getValue(),l=d.getText();if(!h){d.setValue(c);d.setText(g)}else{for(var f=[],i=[],j=h.split(b.split),c=c.split(b.split),g=g.split(b.split),e=0,k=c.length;e<k;e++)if(a.inArray(c[e],j)==-1){f.push(c[e]);i.push(g[e])}if(f.length){d.setValue(h+b.split+f.join(b.split));d.setText(l+b.split+i.join(b.split))}}},removeValue:function(c){var d=this,b=this.options;if(!c)return;var i=d.getValue(),k=d.getText();if(!i)return;for(var f=i.split(b.split),h=k.split(b.split),c=c.split(b.split),g=0,e=-1,j=c.length;g<j;g++)if((e=a.inArray(c[g],f))!=-1){f.splice(e,1);h.splice(e,1)}d.setValue(f.join(b.split));d.setText(h.join(b.split))},_setGrid:function(e){if(!e)return;var b=this,c=this.options,d=a.extend({parms:c.parms},c.grid);this.bind("buttonClick",function(){function e(){try{return b.getData()}catch(a){return null}}if(!b.popupFn){var f={grid:d,condition:c.condition,valueField:c.valueField,textField:c.textField,split:c.split,searchClick:c.searchClick,lastSelected:e(),onSelect:function(a){if(b.trigger("select",a)==false)return;if(c.grid.checkbox){b.addValue(a.value,a.text);b.removeValue(a.remvoeValue,a.remvoeText)}else{b.setValue(a.value);b.setText(a.text)}b.trigger("selected",a)},selectInit:function(d){var e=b.getValue();return!e?false:!c.valueField||!d[c.valueField]?false:a.inArray(d[c.valueField].toString(),e.split(c.split))!=-1}};b.popupFn=a.ligerui.getPopupFn(f,b)}b.popupFn()})}});a.ligerui.getPopupFn=function(b,d){b=a.extend({title:"\u9009\u62e9\u6570\u636e",width:700,height:320,top:null,left:null,split:";",valueField:null,textField:null,grid:null,condition:null,onSelect:function(){},searchClick:b.searchClick,selectInit:function(){return false}},b);if(!b.grid)return;var e,c,g,f=b.lastSelected||[];return function(){j();return false};function j(){function j(a){a=a||b.height;a-=h.height();return a}if(e){c._showData();e.show();c.refreshSize();f=c.selected.concat();return}var l=a("<div></div>"),h=a("<div></div>"),k=a("<div></div>");l.append(h).append(k);if(b.condition){var m=a.extend({labelWidth:60,space:20},b.condition);setTimeout(function(){g=h.ligerForm(m)},50)}else h.remove();var n=a.extend({columnWidth:120,alternatingRow:false,frozen:true,rownumbers:true},b.grid,{width:"100%",height:j(),isChecked:b.selectInit,isSelected:b.selectInit,inWindow:false});c=k.ligerGrid(n);b.condition&&setTimeout(function(){var d=a('<li style="margin-right:9px"><div></div></li>');a("ul:first",h).append(d).after('<div class="l-clear"></div>');a("div",d).ligerButton({text:"\u641c\u7d22",click:function(){var d=g.toConditions();if(b.searchClick)b.searchClick({grid:c,rules:d});else if(c.get("url")){c.setParm(c.conditionParmName||"condition",a.ligerui.toJSON(d));c.reload()}else c.loadData(a.ligerFilter.getFilterFunction(d))}})},100);e=a.ligerDialog.open({title:b.title,width:b.width,height:"auto",top:b.top,left:b.left,target:l,isResize:true,cls:"l-selectorwin",onContentHeightChange:function(a){c.set("height",j(a));return false},onStopResize:function(){c.refreshSize()},buttons:[{text:"\u9009\u62e9",onclick:function(b,a){i();a.hide()}},{text:"\u53d6\u6d88",onclick:function(b,a){a.hide()}}]});if(d){d.includeControls=d.includeControls||[];d.includeControls.push(e)}c.refreshSize()}function h(d,a){for(var c=0;a&&a[c];c++){var e=a[c];if(e[b.valueField]==d)return true}return false}function i(){var j=c.selected||[],k=[],m=[],l=[];a(j).each(function(f,d){b.valueField&&k.push(d[b.valueField]);b.textField&&m.push(d[b.textField]);var e=a.extend(true,{},this);c.formatRecord(e,true);l.push(e)});var i=[];a(f).each(function(d,a){!h(a[b.valueField],j)&&h(a[b.valueField],c.rows)&&i.push(a)});var d=[],g=[],e=[];a(i).each(function(i,f){b.valueField&&d.push(f[b.valueField]);b.textField&&g.push(f[b.textField]);var h=a.extend(true,{},this);c.formatRecord(h,true);e.push(h)});b.onSelect({value:k.join(b.split),text:m.join(b.split),data:l,remvoeValue:d.join(b.split),remvoeText:g.join(b.split),removeData:e})}}})(jQuery);(function(a){a.fn.ligerPortal=function(){return a.ligerui.run.call(this,"ligerPortal",arguments)};a.ligerDefaults.Portal={width:null,rows:null,columns:null,url:null,method:"get",parms:null,draggable:false,onLoaded:null};a.ligerDefaults.Portal_rows={width:null,height:null};a.ligerDefaults.Portal_columns={width:null,height:null};a.ligerMethos.Portal={};a.ligerui.controls.Portal=function(b,c){a.ligerui.controls.Portal.base.constructor.call(this,b,c)};a.ligerui.controls.Portal.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Portal"},__idPrev:function(){return"Portal"},_extendMethods:function(){return a.ligerMethos.Portal},_init:function(){var c=this,b=this.options;a.ligerui.controls.Portal.base._init.call(this);if(a(">div",c.element).length){b.columns=[];a(">div",c.element).each(function(a){b.columns[a]={panels:[]}});c.tempInitPanels=a("<div></div>");a(">div",c.element).appendTo(c.tempInitPanels)}if(!b.rows&&b.columns)b.rows=[{columns:b.columns}]},_render:function(){var b=this,c=this.options;b.portal=a(b.element).addClass("l-portal").html("");b.set(c)},_setRows:function(c){var d=this,g=this.options;d.rows=[];if(c&&c.length)for(var b=0;b<c.length;b++){var f=c[b],e=a('<div class="l-row"></div>').appendTo(d.portal);d.rows[b]=d._renderRow({row:f,rowIndex:b,jrow:e});e.append('<div class="l-clear"></div>')}},_renderRow:function(f){var b=f.row,g=f.rowIndex,c=f.jrow,j=this,k=this.options,e={element:c[0]};if(b.width)if(typeof b.width=="string")if(b.width.indexOf("%")>-1)c.width(b.width);else c.width(parseInt(b.width));else c.width(b.width);b.height&&c.height(b.height);if(b.columns)e.columns=[];if(b.columns&&b.columns.length)for(var d=0;d<b.columns.length;d++){var i=b.columns[d],h=a('<div class="l-column"></div>').appendTo(c);e.columns[d]=j._renderColumn({column:i,columnIndex:d,jcolumn:h,rowIndex:g})}return e},remove:function(e){var a=this,g=this.options,b=e.rowIndex,d=e.columnIndex,c=e.index;if(c==null)c=-1;if(c>=0&&a.rows[b]&&a.rows[b].columns&&a.rows[b].columns[d]&&a.rows[b].columns[d].panels){var f=a.rows[b].columns[d].panels[c];f&&f.close();a._updatePortal()}},add:function(g){var d=this,l=this.options,f=g.rowIndex,h=g.columnIndex,c=g.index,j=g.panel;if(c==null)c=-1;if(!(d.rows[f]&&d.rows[f].columns&&d.rows[f].columns[h]))return;var b=d.rows[f].columns[h],i=l.rows[f].columns[h],e,m=a(b.element);i.panels=i.panels||[];b.panels=b.panels||[];i.panels.splice(c,0,j);if(c<0){var k=a("<div></div>").insertBefore(b.jplace);e=k.ligerPanel(j)}else if(b.panels[c]){var k=a("<div></div>").insertBefore(b.panels[c].panel);e=k.ligerPanel(j)}if(e){e.bind("closed",d._createPanelClosed());d.setPanelEvent({panel:e});b.panels.splice(c,0,e)}d._updatePortal()},_createPanelClosed:function(){var b=this,c=this.options;return function(){var h=this,g=b.getPanels(),e,d,f;a(g).each(function(){if(this.panel==h){e=this.rowIndex;d=this.columnIndex;f=this.index}});c.rows[e].columns[d].panels.splice(f,1);b.rows[e].columns[d].panels.splice(f,1)}},_renderColumn:function(g){var c=g.column,k=g.columnIndex,d=g.jcolumn,n=g.rowIndex,e=this,o=this.options,b={element:d[0]};c.width&&d.width(c.width);c.height&&d.height(c.height);if(c.panels)b.panels=[];if(c.panels&&c.panels.length)for(var f=0;f<c.panels.length;f++){var m=c.panels[f],l=a("<div></div>").appendTo(d);b.panels[f]=l.ligerPanel(m);b.panels[f].bind("closed",e._createPanelClosed());e.setPanelEvent({panel:b.panels[f]})}else if(e.tempInitPanels){var i=e.tempInitPanels.find(">div:eq("+k+")");if(i.length){b.panels=[];var h={},j=i.clone();if(liger.inject&&liger.inject.getOptions)h=liger.inject.getOptions({jelement:j,defaults:a.ligerDefaults.Panel,config:liger.inject.config.Panel});b.panels[0]=j.appendTo(d).ligerPanel(h);b.panels[0].bind("closed",e._createPanelClosed());e.setPanelEvent({panel:b.panels[0]})}}b.jplace=a('<div class="l-column-place"></div>').appendTo(d);return b},setPanelEvent:function(f){var d=f.panel,b=d.panel,c=this,e=this.options;a.fn.ligerDrag&&e.draggable&&b.addClass("l-panel-draggable").ligerDrag({proxy:false,revert:true,handler:".l-panel-header span:first",onRendered:function(){},onStartDrag:function(){c.portal.find(">.l-row").addClass("l-row-dragging");this.jplace=a('<div class="l-panel-place"></div>');this.jplace.height(b.height());b.width(b.width());b.addClass("l-panel-dragging");b.css("position","absolute");b.after(this.jplace);c._updatePortal()},onDrag:function(p,e){var r=e.pageX||e.screenX,s=e.pageY||e.screenY,q=b.height(),o=b.width(),g=b.offset(),k=g.left+o/2,m=g.top+10,n=c.getPanels(),j=c.getEmptyColumns(),a=h(n,j,k,m);if(a){if(this.placeStatus){if(this.placeStatus.panel&&a.panel)if(this.placeStatus.panel.rowIndex==a.panel.rowIndex&&this.placeStatus.panel.columnIndex==a.panel.columnIndex&&this.placeStatus.panel.index==a.panel.index&&this.placeStatus.position==a.position)return;if(this.placeStatus.column&&a.column)if(this.placeStatus.column.rowIndex==a.column.rowIndex&&this.placeStatus.column.columnIndex==a.column.columnIndex&&this.placeStatus.position==a.position)return}if(a.position=="top"){this.jplace.insertBefore(a.panel?a.panel.jpanel:a.column.jplace);this.savedPosition=a.panel?a.panel:a.column;this.savedPosition.inTop=true}else if(a.position=="bottom"){this.jplace.insertAfter(a.panel.jpanel);this.savedPosition=a.panel;this.savedPosition.inTop=false}this.placeStatus=a}else this.placeStatus=null;function h(c,b,g,h){for(i=0,l=c.length;i<l;i++){var e=c[i];if(e.panel==d)continue;var a=f(e,null,g,h);if(a)return a}for(i=0,l=b.length;i<l;i++){var j=b[i],a=f(null,j,g,h);if(a)return a}return null}function f(c,f,i,e){var b=c?c.jpanel:f.jplace;if(!b)return null;var g=b.height(),j=b.width(),h=b.offset().left,d=b.offset().top,a=3;if(i>h-a&&i<h+j+a){if(e>d-a&&e<d+g/2+a)return{panel:c,column:f,position:"top"};if(e>d+g/2-a&&e<d+g+a)return{panel:c,column:f,position:c?"bottom":"top"}}return null}},onStopDrag:function(){c.portal.find(">.l-row").removeClass("l-row-dragging");d.set("width",d.get("width"));b.removeClass("l-panel-dragging");if(this.jplace){b.css({position:"relative",left:null,top:null});b.insertAfter(this.jplace);c.portal.find(">.l-row > .l-column >.l-panel-place").remove();if(this.savedPosition){var k=c.getPanels(),g,f,h;a(k).each(function(){if(this.panel==d){g=this.rowIndex;f=this.columnIndex;h=this.index}});var i=e.rows[g].columns[f].panels[h],j=c.rows[g].columns[f].panels[h];e.rows[g].columns[f].panels.splice(h,1);c.rows[g].columns[f].panels.splice(h,1);if(this.savedPosition.panel){e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,i);c.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,j)}else{e.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[i];c.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[j]}}}c._updatePortal();return false}})},_updatePortal:function(){var b=this,c=this.options;a(b.rows).each(function(){a(this.columns).each(function(){if(this.panels&&this.panels.length)a(this.element).removeClass("l-column-empty");else a(this.element).addClass("l-column-empty")})})},getPanels:function(){var c=this,d=this.options,b=[];a(c.rows).each(function(c){a(this.columns).each(function(d){a(this.panels).each(function(a){b.push({rowIndex:c,columnIndex:d,index:a,panel:this,jpanel:this.panel})})})});return b},getPanel:function(b){var d=this,e=this.options;b=a.extend({rowIndex:0,columnIndex:0,index:0},b);var c=null;a(d.rows).each(function(d){a(this.columns).each(function(e){a(this.panels).each(function(a){if(c)return;if(d==b.rowIndex&&e==b.columnIndex&&a==b.index)c=this})})});return c},getEmptyColumns:function(){var c=this,d=this.options,b=[];a(c.rows).each(function(c){a(this.columns).each(function(a){(!this.panels||!this.panels.length)&&b.push({rowIndex:c,columnIndex:a,jplace:this.jplace})})});return b},_setUrl:function(b){var d=this,c=this.options;if(!b)return;a.ajax({url:b,data:c.parms,type:c.method,dataType:"json",success:function(a){d.set("rows",a)}})},_setWidth:function(a){a&&this.portal.width(a)},collapseAll:function(){var c=this,d=this.options,b=c.getPanels();a(b).each(function(c,b){var a=b.panel;a.collapse()})},expandAll:function(){var c=this,d=this.options,b=c.getPanels();a(b).each(function(c,b){var a=b.panel;a.expand()})}})})(jQuery);(function(a){a.fn.ligerRadio=function(){return a.ligerui.run.call(this,"ligerRadio",arguments)};a.fn.ligerGetRadioManager=function(){return a.ligerui.run.call(this,"ligerGetRadioManager",arguments)};a.ligerDefaults.Radio={disabled:false};a.ligerMethos.Radio={};a.ligerui.controls.Radio=function(b,c){a.ligerui.controls.Radio.base.constructor.call(this,b,c)};a.ligerui.controls.Radio.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return a.ligerMethos.Radio},_render:function(){var b=this,c=this.options;b.input=a(this.element);b.link=a('<a href="javascript:void(0)" class="l-radio"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.input.change(function(){if(this.checked)b.link.addClass("l-radio-checked");else b.link.removeClass("l-radio-checked");return true});b.link.click(function(){b._doclick()});b.wrapper.hover(function(){!c.disabled&&a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});this.element.checked&&b.link.addClass("l-radio-checked");this.element.id&&a("label[for="+this.element.id+"]").click(function(){b._doclick()});b.set(c)},setValue:function(b){var a=this,c=this.options;if(!b){a.input[0].checked=false;a.link.removeClass("l-radio-checked")}else{a.input[0].checked=true;a.link.addClass("l-radio-checked")}},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled");this.options.disabled=false},setDisabled:function(){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled");this.options.disabled=true},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked)this.link.addClass("l-checkbox-checked");else this.link.removeClass("l-checkbox-checked")},_doclick:function(){var b=this,d=this.options;if(b.input.attr("disabled"))return false;b.input.trigger("click").trigger("change");var c;if(b.input[0].form)c=b.input[0].form;else c=document;a("input:radio[name="+b.input[0].name+"]",c).not(b.input).trigger("change");return false}})})(jQuery);(function(a){a.fn.ligerRadioList=function(){return a.ligerui.run.call(this,"ligerRadioList",arguments)};a.ligerDefaults.RadioList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,data:null,parms:null,url:null,urlParms:null,ajaxContentType:null,ajaxType:"post",onSuccess:null,onError:null,onSelect:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.RadioList=a.ligerMethos.RadioList||{};a.ligerui.controls.RadioList=function(b,c){a.ligerui.controls.RadioList.base.constructor.call(this,b,c)};a.ligerui.controls.RadioList.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"RadioList"},_extendMethods:function(){return a.ligerMethos.RadioList},_init:function(){a.ligerui.controls.RadioList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(a(this.element).is(":hidden")||a(this.element).is(":text")){b.valueField=a(this.element);a(this.element).is(":text")&&b.valueField.hide()}else if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0)b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null)b.valueField[0].name=b.valueField[0].id;c.valueFieldCssClass&&b.valueField.addClass(c.valueFieldCssClass);b.valueField.attr("data-ligerid",b.id);if(a(this.element).is(":hidden")||a(this.element).is(":text"))b.radioList=a("<div></div>").insertBefore(this.element);else b.radioList=a(this.element);b.radioList.html('<div class="l-radiolist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-radiolist-table"></table></div>').addClass("l-radiolist").append(b.valueField);b.radioList.table=a("table:first",b.radioList);c.value=b.valueField.val()||c.value;b.set(c);b._addClickEven()},destroy:function(){this.radioList&&this.radioList.remove();this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(a){a&&this.radioList.addClass(a)},_setDisabled:function(b){if(b){this.radioList.addClass("l-radiolist-disabled");a("input:radio",this.radioList).attr("disabled",true)}else{this.radioList.removeClass("l-radiolist-disabled");a("input:radio",this.radioList).removeAttr("disabled")}},_setWidth:function(a){this.radioList.width(a)},_setHeight:function(a){this.radioList.height(a)},indexOf:function(c){var b=this,e=this.options;if(!b.data)return-1;for(var a=0,d=b.data.length;a<d;a++)if(typeof c=="object"){if(b.data[a]==c)return a}else if(b.data[a][e.valueField].toString()==c.toString())return a;return-1},removeItems:function(c){var b=this;if(!b.data)return;a(c).each(function(d,c){var a=b.indexOf(c);if(a==-1)return;b.data.splice(a,1)});b.refresh()},removeItem:function(b){if(!this.data)return;var a=this.indexOf(b);if(a==-1)return;this.data.splice(a,1);this.refresh()},insertItem:function(c,b){var a=this;if(!a.data)a.data=[];a.data.splice(b,0,c);a.refresh()},addItems:function(c){var b=this;if(!b.data)b.data=[];a(c).each(function(c,a){b.data.push(a)});b.refresh()},addItem:function(b){var a=this;if(!a.data)a.data=[];a.data.push(b);a.refresh()},_setValue:function(a){var b=this,c=this.options;b.valueField.val(a);c.value=a;this._dataInit()},setValue:function(a){this._setValue(a)},_setUrl:function(c){var e=this,b=this.options;if(!c)return;var f=a.isFunction(b.urlParms)?b.urlParms.call(e):b.urlParms;if(f)for(name in f){c+=c.indexOf("?")==-1?"?":"&";c+=name+"="+f[name]}var d=a.isFunction(b.parms)?b.parms():b.parms;if(b.ajaxContentType=="application/json"&&typeof d!="string")d=liger.toJSON(d);a.ajax({type:"post",url:c,data:d,cache:false,dataType:"json",contentType:b.ajaxContentType,success:function(a){e.setData(a);e.trigger("success",[a])},error:function(a,b){e.trigger("error",[a,b])}})},setUrl:function(a){return this._setUrl(a)},setParm:function(b,d){if(!b)return;var c=this,a=c.get("parms");if(!a)a={};a[b]=d;c.set("parms",a)},clearContent:function(){var b=this,c=this.options;a("table",b.radioList).html("")},_setData:function(a){this.setData(a)},setData:function(a){var b=this,c=this.options;if(!a||!a.length)return;b.data=a;b.refresh();b.updateStyle()},refresh:function(){var f=this,d=this.options,c=this.data;this.clearContent();if(!c)return;for(var b=[],h=d.rowSize,e=false,j=d.name||f.id,a=0;a<c.length;a++){var l=c[a][d.valueField],k=c[a][d.textField],g=f.id+"-"+a,i=a%h==0;if(i){e&&b.push("</tr>");b.push("<tr>");e=true}b.push("<td><input type='radio' name='"+j+"' value='"+l+"' id='"+g+"'/><label for='"+g+"'>"+k+"</label></td>")}e&&b.push("</tr>");f.radioList.table.append(b.join(""))},_getValue:function(){var c=this,d=this.options,b=d.name||c.id;return a('input:radio[name="'+b+'"]:checked').val()},getValue:function(){return this._getValue()},updateStyle:function(){var b=this,c=this.options;b._dataInit();a(":radio",b.element).change(function(){var a=b.getValue();b.trigger("select",[{value:a}])})},_dataInit:function(){var a=this,c=this.options,b=a.valueField.val()||a._getValue()||c.value;a._changeValue(b)},_changeValue:function(c){var b=this,e=this.options,d=e.name||b.id;a("input:radio[name='"+d+"']",b.radioList).each(function(){this.checked=this.value==c});b.valueField.val(c);b.selectedValue=c},_addClickEven:function(){var a=this,b=this.options;a.radioList.click(function(){var b=a.getValue();b&&a.valueField.val(b)})}})})(jQuery);(function(a){a.fn.ligerResizable=function(){return a.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};a.fn.ligerGetResizableManager=function(){return a.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};a.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2e3,maxHeight:2e3,minWidth:20,minHeight:20,scope:3,animate:false,onStartResize:function(){},onResize:function(){},onStopResize:function(){},onEndResize:null};a.ligerui.controls.Resizable=function(b){a.ligerui.controls.Resizable.base.constructor.call(this,null,b)};a.ligerui.controls.Resizable.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var b=this,c=this.options;b.target=a(c.target);b.set(c);b.target.mousemove(function(e){if(c.disabled)return;b.dir=b._getDir(e);if(b.dir)b.target.css("cursor",b.dir+"-resize");else b.target.css("cursor").indexOf("-resize")>0&&b.target.css("cursor","default");if(c.target.ligeruidragid){var d=a.ligerui.get(c.target.ligeruidragid);if(d&&b.dir)d.set("disabled",true);else d&&d.set("disabled",false)}}).mousedown(function(a){if(c.disabled)return;b.dir&&b._start(a)})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(g){var h=this,k=this.options,b="",c=h.target.offset(),j=h.target.width(),i=h.target.height(),f=k.scope,d=g.pageX||g.screenX,e=g.pageY||g.screenY;if(e>=c.top&&e<c.top+f)b+="n";else if(e<=c.top+i&&e>c.top+i-f)b+="s";if(d>=c.left&&d<c.left+f)b+="w";else if(d<=c.left+j&&d>c.left+j-f)b+="e";return k.handles=="all"||b==""?b:a.inArray(b,h.handles)!=-1?b:""},_setHandles:function(a){if(!a)return;this.handles=a.replace(/(\s*)/g,"").split(",")},_createProxy:function(){var b=this;b.proxy=a('<div class="l-resizable"></div>');b.proxy.width(b.target.width()).height(b.target.height());b.proxy.attr("resizableid",b.id).appendTo("body")},_removeProxy:function(){var a=this;if(a.proxy){a.proxy.remove();a.proxy=null}},_start:function(c){var b=this,d=this.options;b._createProxy();b.proxy.css({left:b.target.offset().left,top:b.target.offset().top,position:"absolute"});b.current={dir:b.dir,left:b.target.offset().left,top:b.target.offset().top,startX:c.pageX||c.screenX,startY:c.pageY||c.clientY,width:b.target.width(),height:b.target.height()};a(document).bind("selectstart.resizable",function(){return false});a(document).bind("mouseup.resizable",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove.resizable",function(){b._drag.apply(b,arguments)});b.proxy.show();b.trigger("startResize",[b.current,c])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(b){var a=this,e=this.options;if(!a.current)return;if(!a.proxy)return;a.proxy.css("cursor",a.current.dir==""?"default":a.current.dir+"-resize");var c=b.pageX||b.screenX,d=b.pageY||b.screenY;a.current.diffX=c-a.current.startX;a.current.diffY=d-a.current.startY;a._applyResize(a.proxy);a.trigger("resize",[a.current,b])},_stop:function(c){var b=this,d=this.options;if(b.hasBind("stopResize"))b.trigger("stopResize",[b.current,c])!=false&&b._applyResize();else b._applyResize();b._removeProxy();b.trigger("endResize",[b.current,c]);a(document).unbind("selectstart.resizable");a(document).unbind("mousemove.resizable");a(document).unbind("mouseup.resizable")},_applyResize:function(e){var b=this,f=this.options,c={left:b.current.left,top:b.current.top,width:b.current.width,height:b.current.height},d=false;if(!e){e=b.target;d=true;if(!isNaN(parseInt(b.target.css("top"))))c.top=parseInt(b.target.css("top"));else c.top=0;if(!isNaN(parseInt(b.target.css("left"))))c.left=parseInt(b.target.css("left"));else c.left=0}if(a.inArray(b.current.dir,b.changeBy.l)>-1){c.left+=b.current.diffX;b.current.diffLeft=b.current.diffX}else if(d)delete c.left;if(a.inArray(b.current.dir,b.changeBy.t)>-1){c.top+=b.current.diffY;b.current.diffTop=b.current.diffY}else if(d)delete c.top;if(a.inArray(b.current.dir,b.changeBy.w)>-1){c.width+=(b.current.dir.indexOf("w")==-1?1:-1)*b.current.diffX;b.current.newWidth=c.width}else if(d)delete c.width;if(a.inArray(b.current.dir,b.changeBy.h)>-1){c.height+=(b.current.dir.indexOf("n")==-1?1:-1)*b.current.diffY;b.current.newHeight=c.height}else if(d)delete c.height;if(d&&f.animate)e.animate(c);else e.css(c)}})})(jQuery);(function(a){a.fn.ligerSpinner=function(){return a.ligerui.run.call(this,"ligerSpinner",arguments)};a.fn.ligerGetSpinnerManager=function(){return a.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)};a.ligerDefaults.Spinner={type:"float",isNegative:true,decimalplace:2,step:.1,interval:50,value:null,onChangeValue:false,minValue:null,maxValue:null,disabled:false,readonly:false};a.ligerMethos.Spinner={};a.ligerui.controls.Spinner=function(b,c){a.ligerui.controls.Spinner.base.constructor.call(this,b,c)};a.ligerui.controls.Spinner.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return a.ligerMethos.Spinner},_init:function(){a.ligerui.controls.Spinner.base._init.call(this);var b=this.options;if(b.type=="float"){b.step=.1;b.interval=50}else if(b.type=="int"){b.step=1;b.interval=100}else if(b.type=="time"){b.step=1;b.interval=100}else{b.type="int";b.step=1;b.interval=100}},_render:function(){var b=this,c=this.options;b.interval=null;b.inputText=null;b.value=null;b.textFieldID="";if(this.element.tagName.toLowerCase()=="input"&&this.element.type&&this.element.type=="text"){b.inputText=a(this.element);if(this.element.id)b.textFieldID=this.element.id}else{b.inputText=a('<input type="text"/>');b.inputText.appendTo(a(this.element))}if(b.textFieldID==""&&c.textFieldID)b.textFieldID=c.textFieldID;b.link=a('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link).after(b.selectBox).after(b.valueField);b.link.up=a(".l-spinner-up",b.link);b.link.down=a(".l-spinner-down",b.link);b.inputText.addClass("l-text-field");c.disabled&&b.wrapper.addClass("l-text-disabled");if(!b._isVerify(b.inputText.val())){b.value=b._getDefaultValue();b._showValue(b.value)}b.link.up.hover(function(){!c.disabled&&a(this).addClass("l-spinner-up-over")},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-up-over")}).mousedown(function(){if(!c.disabled){b._uping.call(b);b.interval=setInterval(function(){b._uping.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.link.down.hover(function(){!c.disabled&&a(this).addClass("l-spinner-down-over")},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-down-over")}).mousedown(function(){if(!c.disabled){b.interval=setInterval(function(){b._downing.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.inputText.change(function(){var a=b.inputText.val();b.value=b._getVerifyValue(a);b.trigger("changeValue",[b.value]);b._showValue(b.value)}).blur(function(){b.wrapper.removeClass("l-text-focus")}).focus(function(){b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){!c.disabled&&b.wrapper.addClass("l-text-over")},function(){b.wrapper.removeClass("l-text-over")});b.set(c)},_setValue:function(a){a!=null&&this.inputText.val(a)},_setWidth:function(a){var b=this;if(a>20){b.wrapper.css({width:a});b.inputText.css({width:a-20})}},_setHeight:function(a){var b=this;if(a>10){b.wrapper.height(a);b.inputText.height(a-2);b.link.height(a-4)}},_setDisabled:function(a){if(a)this.wrapper.addClass("l-text-disabled");else this.wrapper.removeClass("l-text-disabled")},_showValue:function(a){var c=this,b=this.options;if(!a||a=="NaN")a=0;if(b.type=="float")a=parseFloat(a).toFixed(b.decimalplace);this.inputText.val(a)},_setValue:function(a){this._showValue(a)},setValue:function(a){this._showValue(a)},getValue:function(){return this.inputText.val()},_round:function(c,a){for(var d=this,e=this.options,b=1;a>0;b*=10,a--);for(;a<0;b/=10,a++);return Math.round(c*b)/b},_isInt:function(a){var d=this,c=this.options,b=c.isNegative?/^-?\d+$/:/^\d+$/;return!b.test(a)?false:parseFloat(a)!=a?false:true},_isFloat:function(a){var d=this,c=this.options,b=c.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;return!b.test(a)?false:parseFloat(a)!=a?false:true},_isTime:function(b){var c=this,d=this.options,a=b.match(/^(\d{1,2}):(\d{1,2})$/);return a==null?false:a[1]>24||a[2]>60?false:true},_isVerify:function(b){var d=this,a=this.options;if(a.type=="float"){if(!d._isFloat(b))return false;var c=parseFloat(b);return a.minValue!=undefined&&a.minValue>c?false:a.maxValue!=undefined&&a.maxValue<c?false:true}else if(a.type=="int"){if(!d._isInt(b))return false;var c=parseInt(b);return a.minValue!=undefined&&a.minValue>c?false:a.maxValue!=undefined&&a.maxValue<c?false:true}else if(a.type=="time")return d._isTime(b);return false},_getVerifyValue:function(c){var d=this,b=this.options,a=null;if(b.type=="float")a=d._round(c,b.decimalplace);else if(b.type=="int")a=parseInt(c);else if(b.type=="time")a=c;return!d._isVerify(a)?d.value:a},_isOverValue:function(b){var c=this,a=this.options;return a.minValue!=null&&a.minValue>b?true:a.maxValue!=null&&a.maxValue<b?true:false},_getDefaultValue:function(){var b=this,a=this.options;return a.type=="float"||a.type=="int"?0:a.type=="time"?"00:00":void 0},_addValue:function(c){var b=this,d=this.options,a=b.inputText.val();a=parseFloat(a)+c;if(b._isOverValue(a))return;b._showValue(a);b.inputText.trigger("change")},_addTime:function(d){var b=this,e=this.options,a=b.inputText.val(),c=a.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(c[2])+d;if(newminute<10)newminute="0"+newminute;a=c[1]+":"+newminute;if(b._isOverValue(a))return;b._showValue(a);b.inputText.trigger("change")},_uping:function(){var b=this,a=this.options;if(a.type=="float"||a.type=="int")b._addValue(a.step);else a.type=="time"&&b._addTime(a.step)},_downing:function(){var b=this,a=this.options;if(a.type=="float"||a.type=="int")b._addValue(-1*a.step);else a.type=="time"&&b._addTime(-1*a.step)},_isDateTime:function(c){var d=this,e=this.options,a=c.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(a==null)return false;var b=new Date(a[1],a[3]-1,a[4]);return b=="NaN"?false:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]},_isLongDateTime:function(c){var e=this,f=this.options,d=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/,a=c.match(d);if(a==null)return false;var b=new Date(a[1],a[3]-1,a[4],a[5],a[6]);return b=="NaN"?false:b.getFullYear()==a[1]&&b.getMonth()+1==a[3]&&b.getDate()==a[4]&&b.getHours()==a[5]&&b.getMinutes()==a[6]}})})(jQuery);(function(a){a.fn.ligerTab=function(){return a.ligerui.run.call(this,"ligerTab",arguments)};a.fn.ligerGetTabManager=function(){return a.ligerui.run.call(this,"ligerGetTabManager",arguments)};a.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:false,contextmenu:true,dblClickToClose:false,dragToMove:false,showSwitch:false,showSwitchInTab:false,data:null,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null,onCloseOther:null,onCloseAll:null,onClose:null,onReload:null,onSwitchRender:null};a.ligerDefaults.TabString={closeMessage:"\u5173\u95ed\u5f53\u524d\u9875",closeOtherMessage:"\u5173\u95ed\u5176\u4ed6",closeAllMessage:"\u5173\u95ed\u6240\u6709",reloadMessage:"\u5237\u65b0"};a.ligerMethos.Tab={};a.ligerui.controls.Tab=function(b,c){a.ligerui.controls.Tab.base.constructor.call(this,b,c)};a.ligerui.controls.Tab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return a.ligerMethos.Tab},_render:function(){var b=this,c=this.options;if(c.height)b.makeFullHeight=true;b.tab=a(this.element);b.tab.addClass("l-tab");if(c.contextmenu&&a.ligerMenu)b.tab.menu=a.ligerMenu({width:100,items:[{text:c.closeMessage,id:"close",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.closeOtherMessage,id:"closeother",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.closeAllMessage,id:"closeall",click:function(){b._menuItemClick.apply(b,arguments)}},{text:c.reloadMessage,id:"reload",click:function(){b._menuItemClick.apply(b,arguments)}}]});b.tab.content=a('<div class="l-tab-content"></div>');a("> div",b.tab).appendTo(b.tab.content);b.tab.content.appendTo(b.tab);b.tab.links=a('<div class="l-tab-links"><ul style="left: 0px; "></ul><div class="l-tab-switch"></div></div>');b.tab.links.prependTo(b.tab);b.tab.links.ul=a("ul",b.tab.links);var e=a("> div[lselected=true]",b.tab.content),f=e.length>0;b.selectedTabId=e.attr("tabid");a("> div",b.tab.content).each(function(j){var e=a('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>'),c=a(this);if(c.attr("title")){a("> a",e).html(c.attr("title"));c.attr("title","")}var d=c.attr("tabid");if(d==undefined){d=b.getNewTabid();c.attr("tabid",d);if(c.attr("lselected"))b.selectedTabId=d}e.attr("tabid",d);if(!f&&j==0)b.selectedTabId=d;var i=c.attr("showClose");i&&e.append("<div class='l-tab-links-item-close'></div>");a("> ul",b.tab.links).append(e);!c.hasClass("l-tab-content-item")&&c.addClass("l-tab-content-item");if(c.find("iframe").length>0){var g=a("iframe:first",c);if(g[0].readyState!="complete"){c.find(".l-tab-loading:first").length==0&&c.prepend("<div class='l-tab-loading' style='display:block;'></div>");var h=a(".l-tab-loading:first",c);g.bind("load.tab",function(){h.hide()})}}});b.selectTabItem(b.selectedTabId);if(c.height)if(typeof c.height=="string"&&c.height.indexOf("%")>0){b.onResize();c.changeHeightOnResize&&a(window).resize(function(){b.onResize.call(b)})}else b.setHeight(c.height);b.makeFullHeight&&b.setContentHeight();a("li",b.tab.links).each(function(){b._addTabItemEvent(a(this))});b.tab.bind("dblclick.tab",function(e){if(!c.dblClickToClose)return;b.dblclicking=true;var d=e.target||e.srcElement,g=d.tagName.toLowerCase();if(g=="a"){var h=a(d).parent().attr("tabid"),f=a(d).parent().find("div.l-tab-links-item-close").length?true:false;f&&b.removeTabItem(h)}b.dblclicking=false});b.set(c);setTimeout(d,100);a(window).resize(function(){d.call(b)});function d(){var a=b.tab.width()-parseInt(b.tab.links.css("marginLeft"),10)-parseInt(b.tab.links.css("marginRight"),10);b.tab.links.width(a)}b.bind("sysWidthChange",function(){d.call(b)})},_setShowSwitch:function(c){var b=this,d=this.options;if(c){!a(".l-tab-switch",b.tab.links).length&&a("<div class='l-tab-switch'></div>").appendTo(b.tab.links);a(b.tab).addClass("l-tab-switchable");a(".l-tab-switch",b.tab).click(function(){b.toggleSwitch(this)})}else{a(b.tab).removeClass("l-tab-switchable");a("body > .l-tab-windowsswitch").remove()}},_setShowSwitchInTab:function(d){var b=this,e=this.options;if(e.showSwitch&&d){a(b.tab).removeClass("l-tab-switchable");a(".l-tab-switch",b.tab).remove();var c=a("<li class='l-tab-itemswitch'><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div></li>");c.appendTo(b.tab.links.ul);c.click(function(){b.toggleSwitch(this)})}else a(".l-tab-itemswitch",b.tab.ul).remove()},toggleSwitch:function(d){var c=this,g=this.options;if(a("body > .l-tab-windowsswitch").length){a("body > .l-tab-windowsswitch").remove();return}if(d==null)return;var b=a("<div class='l-tab-windowsswitch'></div>").appendTo("body"),f=c.tab.links.ul.find(">li"),e=c.getSelectedTabItemID();f.each(function(g,f){var c=a("<a href='javascript:void(0)'></a>");c.text(a(f).find("a").text());var d=a(f).attr("tabid");if(d==null)return;d==e&&c.addClass("selected");c.attr("tabid",d);b.append(c)});b.css({top:a(d).offset().top+a(d).height(),left:a(d).offset().left-b.width()});b.find("a").bind("click",function(){var b=a(this).attr("tabid");if(b==undefined)return;c.selectTabItem(b);c.moveToTabItem(b);a("body > .l-tab-windowsswitch").remove()});c.trigger("switchRender",[b])},_applyDrag:function(c){var b=this,e=this.options;b.droptip=b.droptip||a("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var d=a(c).ligerDrag({revert:true,animate:false,proxy:function(){var c=a(this).find("a").html();b.dragproxy=a("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");b.dragproxy.append(c);return b.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(e,b){if(!a(c).hasClass("l-selected"))return false;if(b.button==2)return false;var d=b.srcElement||b.target;if(a(d).hasClass("l-tab-links-item-close"))return false},onDrag:function(f,c){if(b.dropIn==null)b.dropIn=-1;var e=b.tab.links.ul.find(">li"),d=e.index(f.target);e.each(function(g){if(d==g)return;var j=g>d;if(b.dropIn!=-1&&b.dropIn!=g)return;var f=a(this).offset(),e={top:f.top,bottom:f.top+a(this).height(),left:f.left-10,right:f.left+10};if(j){e.left+=a(this).width();e.right+=a(this).width()}var h=c.pageX||c.screenX,i=c.pageY||c.screenY;if(h>e.left&&h<e.right&&i>e.top&&i<e.bottom){b.droptip.css({left:e.left+5,top:e.top-9}).show();b.dropIn=g;b.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")}else{b.dropIn=-1;b.droptip.hide();b.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no")}})},onStopDrag:function(c){if(b.dropIn>-1){var e=b.tab.links.ul.find(">li:eq("+b.dropIn+")").attr("tabid"),d=a(c.target).attr("tabid");setTimeout(function(){b.moveTabItem(d,e)},0);b.dropIn=-1;b.dragproxy.remove()}b.droptip.hide();this.set("cursor","default")}});return d},_setDragToMove:function(c){if(!a.fn.ligerDrag)return;var b=this,d=this.options;if(c){if(b.drags)return;b.drags=b.drags||[];b.tab.links.ul.find(">li").each(function(){b.drags.push(b._applyDrag(this))})}},moveTabItem:function(d,e){var a=this,b=a.tab.links.ul.find(">li[tabid="+d+"]"),c=a.tab.links.ul.find(">li[tabid="+e+"]"),f=a.tab.links.ul.find(">li").index(b),g=a.tab.links.ul.find(">li").index(c);if(f<g)c.after(b);else c.before(b)},setTabButton:function(){var b=this,e=this.options,c=0;a("li",b.tab.links.ul).each(function(){c+=a(this).width()+2});var d=b.tab.width();if(c>d){if(!a(".l-tab-links-left",b.tab).length){b.tab.links.append('<div class="l-tab-links-left"><span></span></div><div class="l-tab-links-right"><span></span></div>');b.setTabButtonEven()}return true}else{b.tab.links.ul.animate({left:0});a(".l-tab-links-left,.l-tab-links-right",b.tab.links).remove();return false}},setTabButtonEven:function(){var b=this,c=this.options;a(".l-tab-links-left",b.tab.links).hover(function(){a(this).addClass("l-tab-links-left-over")},function(){a(this).removeClass("l-tab-links-left-over")}).click(function(){b.moveToPrevTabItem()});a(".l-tab-links-right",b.tab.links).hover(function(){a(this).addClass("l-tab-links-right-over")},function(){a(this).removeClass("l-tab-links-right-over")}).click(function(){b.moveToNextTabItem()})},moveToPrevTabItem:function(m){var d=this,s=this.options,i=a("> li",d.tab.links.ul),j=a(".l-tab-links-right",d.tab),c=a(".l-tab-links-left",d.tab);if(!j.length||!c.length)return false;for(var r=j.offset(),n=c.offset(),e=null,h=0,f=n.left+c.outerWidth(),g=0,q=i.length;g<q;g++){var b=a(i[g]),k=b.offset(),l=k.left,p=k.left+b.outerWidth();if(m!=null){if(l<f&&b.attr("tabid")==m){e=b;break}}else if(l<f&&p>=f){e=b;break}h+=b.outerWidth()+parseInt(b.css("marginLeft"))+parseInt(b.css("marginRight"))}if(e==null)return false;var o=h-c.outerWidth();d.tab.links.ul.animate({left:-1*o});return true},moveToNextTabItem:function(l){var e=this,r=this.options,h=a("> li",e.tab.links.ul),i=a(".l-tab-links-right",e.tab),j=a(".l-tab-links-left",e.tab);if(!i.length||!j.length)return false;for(var d=i.offset(),n=j.offset(),c=null,g=0,f=0,q=h.length;f<q;f++){var b=a(h[f]);g+=b.outerWidth()+parseInt(b.css("marginLeft"))+parseInt(b.css("marginRight"));var k=b.offset(),o=k.left,m=k.left+b.outerWidth();if(l!=null){if(m>d.left&&b.attr("tabid")==l){c=b;break}}else if(o<=d.left&&m>d.left){c=b;break}}if(c==null)return false;var p=g-(d.left-n.left)+parseInt(c.css("marginLeft"))+parseInt(c.css("marginRight"));e.tab.links.ul.animate({left:-1*p});return true},moveToTabItem:function(a){var b=this,c=this.options;!b.moveToPrevTabItem(a)&&b.moveToNextTabItem(a)},getTabItemCount:function(){var b=this,c=this.options;return a("li",b.tab.links.ul).length},getSelectedTabItemID:function(){var b=this,c=this.options;return a("li.l-selected",b.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var a=this,b=this.options;a.removeTabItem(a.getSelectedTabItemID())},overrideSelectedTabItem:function(b){var a=this,c=this.options;a.overrideTabItem(a.getSelectedTabItemID(),b)},overrideTabItem:function(g,c){var f=this,n=this.options;if(f.trigger("beforeOverrideTabItem",[g])==false)return false;var d=c.tabid;if(d==undefined)d=f.getNewTabid();var l=c.url,j=c.content,m=c.target,i=c.text,h=c.showClose,k=c.height;if(f.isTabItemExist(d))return;var e=a("li[tabid="+g+"]",f.tab.links.ul),b=a(".l-tab-content-item[tabid="+g+"]",f.tab.content);if(!e||!b)return;e.attr("tabid",d);b.attr("tabid",d);if(a("iframe",b).length==0&&l)b.html("<iframe frameborder='0'></iframe>");else j&&b.html(j);a("iframe",b).attr("name",d);if(h==undefined)h=true;if(h==false)a(".l-tab-links-item-close",e).remove();else a(".l-tab-links-item-close",e).length==0&&e.append("<div class='l-tab-links-item-close'></div>");if(i==undefined)i=d;k&&b.height(k);a("a",e).text(i);a("iframe",b).attr("src",l);f.trigger("afterOverrideTabItem",[g])},setHeader:function(c,b){a("li[tabid="+c+"] a",this.tab.links.ul).text(b)},selectTabItem:function(b){var c=this,d=this.options;if(c.trigger("beforeSelectTabItem",[b])==false)return false;c.selectedTabId=b;a("> .l-tab-content-item[tabid="+b+"]",c.tab.content).show().siblings().hide();a("li[tabid="+b+"]",c.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected");c.trigger("afterSelectTabItem",[b])},moveToLastTabItem:function(){var b=this,f=this.options,c=0;a("li",b.tab.links.ul).each(function(){c+=a(this).width()+2});var d=b.tab.width();if(c>d){var e=a(".l-tab-links-right",b.tab.links).width();b.tab.links.ul.animate({left:-1*(c-d+e+2)})}},getTabItemTitle:function(b){var c=this,d=this.options;return a("li[tabid="+b+"] a",c.tab.links.ul).text()},setTabItemTitle:function(b,c){var d=this,e=this.options;a("li[tabid="+b+"] a",d.tab.links.ul).text(c)},getTabItemSrc:function(b){var c=this,d=this.options;return a(".l-tab-content-item[tabid="+b+"] iframe",c.tab.content).attr("src")},setTabItemSrc:function(c,g){var d=this,h=this.options,e=a(".l-tab-content-item[tabid="+c+"]",d.tab.content),b=a(".l-tab-loading:first",e),f=a(".l-tab-content-item[tabid="+c+"] iframe",d.tab.content);b.show();f.attr("src",g).unbind("load.tab").bind("load.tab",function(){b.hide()})},isTabItemExist:function(b){var c=this,d=this.options;return a("li[tabid="+b+"] a",c.tab.links.ul).length>0},addTabItem:function(c){var b=this,o=this.options;if(b.trigger("beforeAddTabItem",[c])==false)return false;var d=c.tabid;if(d==undefined)d=b.getNewTabid();var m=c.url,k=c.content,i=c.text,h=c.showClose,l=c.height;if(b.isTabItemExist(d)){b.selectTabItem(d);return}var f=a("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>"),e=a("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>"),j=a("div:first",e),g=a("iframe:first",e);if(b.makeFullHeight){var n=b.tab.height()-b.tab.links.height();e.height(n)}f.attr("tabid",d);e.attr("tabid",d);if(m){g[0].tab=b;if(c.data)g[0].openerData=c.data;g.attr("name",d).attr("id",d).attr("src",m).bind("load.tab",function(){j.hide();c.callback&&c.callback()})}else{g.remove();j.remove()}if(k){e.html(k);c.callback&&c.callback()}else if(c.target){e.append(c.target);c.callback&&c.callback()}if(h==undefined)h=true;h==false&&a(".l-tab-links-item-close",f).remove();if(i==undefined)i=d;l&&e.height(l);a("a",f).text(i);if(a(".l-tab-itemswitch",b.tab.links.ul).length)f.insertBefore(a(".l-tab-itemswitch",b.tab.links.ul));else b.tab.links.ul.append(f);b.tab.content.append(e);b.selectTabItem(d);b.setTabButton()&&b.moveToTabItem(d);b._addTabItemEvent(f);if(o.dragToMove&&a.fn.ligerDrag){b.drags=b.drags||[];f.each(function(){b.drags.push(b._applyDrag(this))})}b.toggleSwitch();b.trigger("afterAddTabItem",[c])},_addTabItemEvent:function(c){var b=this,d=this.options;c.click(function(){var c=a(this).attr("tabid");b.selectTabItem(c)});b.tab.menu&&b._addTabItemContextMenuEven(c);a(".l-tab-links-item-close",c).hover(function(){a(this).addClass("l-tab-links-item-close-over")},function(){a(this).removeClass("l-tab-links-item-close-over")}).click(function(){var c=a(this).parent().attr("tabid");b.removeTabItem(c)})},removeTabItem:function(c){var b=this,i=this.options;if(b.trigger("beforeRemoveTabItem",[c])==false)return false;var g=a("li[tabid="+c+"]",b.tab.links.ul).hasClass("l-selected");if(g){a(".l-tab-content-item[tabid="+c+"]",b.tab.content).prev().show();a("li[tabid="+c+"]",b.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")}var e=a(".l-tab-content-item[tabid="+c+"]",b.tab.content),d=a("iframe",e);if(d.length){var f=d[0];f.src="about:blank";try{f.contentWindow.document.write("")}catch(h){}a.browser.msie&&CollectGarbage();d.remove()}e.remove();a("li[tabid="+c+"]",b.tab.links.ul).remove();b.setTabButton();b.trigger("afterRemoveTabItem",[c])},hideTabItem:function(b){var c=this,e=this.options,d=a("li[tabid="+b+"]",c.tab.links.ul).hasClass("l-selected");if(d){a(".l-tab-content-item[tabid="+b+"]",c.tab.content).prev().show();a("li[tabid="+b+"]",c.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")}a("li[tabid="+b+"]",c.tab.links.ul).hide();a(".l-tab-content-item[tabid="+b+"]",c.tab.content).hide()},showTabItem:function(b){var c=this,d=this.options;a("li[tabid="+b+"]",c.tab.links.ul).show()},addHeight:function(b){var a=this,d=this.options,c=a.tab.height()+b;a.setHeight(c)},setHeight:function(b){var a=this,c=this.options;a.tab.height(b);a.setContentHeight()},setContentHeight:function(){var b=this,d=this.options,c=b.tab.height()-b.tab.links.height();b.tab.content.height(c);a("> .l-tab-content-item",b.tab.content).height(c)},getNewTabid:function(){var a=this,b=this.options;a.getnewidcount=a.getnewidcount||0;return"tabitem"+ ++a.getnewidcount},getTabidList:function(d,c){var e=this,f=this.options,b=[];a("> li",e.tab.links.ul).each(function(){a(this).attr("tabid")&&a(this).attr("tabid")!=d&&(!c||a(".l-tab-links-item-close",this).length>0)&&b.push(a(this).attr("tabid"))});return b},removeOther:function(d){var b=this,f=this.options,c=b.getTabidList(d,true);a(c).each(function(){b.removeTabItem(this)})},reload:function(e){var g=this,h=this.options,c=a(".l-tab-content-item[tabid="+e+"]"),b=a(".l-tab-loading:first",c),d=a("iframe:first",c),f=a(d).attr("src");b.show();d.attr("src",f).unbind("load.tab").bind("load.tab",function(){b.hide()})},removeAll:function(){var b=this,e=this.options,c=b.getTabidList(null,true);a(c).each(function(){b.removeTabItem(this)})},onResize:function(){var b=this,c=this.options;if(!c.height||typeof c.height!="string"||c.height.indexOf("%")==-1)return false;if(b.tab.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.tab.parent().css("paddingTop"));d-=parseInt(b.tab.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*.01}else b.height=c.heightDiff+b.tab.parent().height()*parseFloat(c.height)*.01;b.tab.height(b.height);b.setContentHeight()},_menuItemClick:function(b){var a=this,c=this.options;if(!b.id||!a.actionTabid)return;switch(b.id){case"close":if(a.trigger("close")==false)return;a.removeTabItem(a.actionTabid);a.actionTabid=null;break;case"closeother":if(a.trigger("closeother")==false)return;a.removeOther(a.actionTabid);break;case"closeall":if(a.trigger("closeall")==false)return;a.removeAll();a.actionTabid=null;break;case"reload":if(a.trigger("reload",[{tabid:a.actionTabid}])==false)return;a.selectTabItem(a.actionTabid);a.reload(a.actionTabid)}},_addTabItemContextMenuEven:function(c){var b=this,d=this.options;c.bind("contextmenu",function(d){if(!b.tab.menu)return;b.actionTabid=c.attr("tabid");b.tab.menu.show({top:d.pageY,left:d.pageX});if(a(".l-tab-links-item-close",this).length==0)b.tab.menu.setDisabled("close");else b.tab.menu.setEnabled("close");return false})}})})(jQuery);(function(a){a.fn.ligerTextBox=function(){return a.ligerui.run.call(this,"ligerTextBox",arguments)};a.fn.ligerGetTextBoxManager=function(){return a.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)};a.ligerDefaults.TextBox={onChangeValue:null,onMouseOver:null,onMouseOut:null,onBlur:null,onFocus:null,width:null,disabled:false,initSelect:false,value:null,precision:2,nullText:null,digits:false,number:false,currency:false,readonly:false};a.ligerui.controls.TextBox=function(b,c){a.ligerui.controls.TextBox.base.constructor.call(this,b,c)};a.ligerui.controls.TextBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){a.ligerui.controls.TextBox.base._init.call(this);var c=this,b=this.options;if(!b.width)b.width=a(c.element).width();if(a(this.element).attr("readonly"))b.readonly=true;else b.readonly&&a(this.element).attr("readonly",true)},_render:function(){var b=this,c=this.options;b.inputText=a(this.element);b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');!b.inputText.hasClass("l-text-field")&&b.inputText.addClass("l-text-field");this._setEvent();(c.digits||c.number||c.currency)&&b.inputText.addClass("l-text-field-number");b.set(c);b.formatValue()},destroy:function(){var a=this;a.wrapper&&a.wrapper.remove();a.options=null;liger.remove(this)},_getValue:function(){var a=this,b=this.options;return a.inputText.hasClass("l-text-field-null")?"":b.digits||b.number||b.currency?a.parseNumber():a.inputText.val()},_setNullText:function(){this.checkNotNull()},formatValue:function(){var c=this,a=this.options,d=c.inputText.val()||"";if(d=="")return"";if(a.currency)c.inputText.val(b(d,a.precision));else if(a.number&&a.precision&&d){var e=parseFloat(c.inputText.val()).toFixed(a.precision);c.inputText.val(e)}},checkNotNull:function(){var b=this,a=this.options;if(a.nullText&&a.nullText!="null"&&!a.disabled&&!a.readonly){if(!b.inputText.val()){b.inputText.addClass("l-text-field-null").val(a.nullText);return}}else b.inputText.removeClass("l-text-field-null")},_setEvent:function(){var b=this,c=this.options;function e(){var a=b.inputText.val();if(!a||a=="-")return true;var d=(c.digits?/^-?\d+$/:/^(-?\d+)(\.)?(\d+)?$/).test(a);return d}function d(){!e()&&b.inputText.val(b.parseNumber())}(c.digits||c.number||c.currency)&&b.inputText.keyup(d).bind("paste",d);b.inputText.bind("blur.textBox",function(){b.trigger("blur");b.checkNotNull();b.formatValue();b.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){if(c.readonly)return;b.trigger("focus");if(c.nullText)a(this).hasClass("l-text-field-null")&&a(this).removeClass("l-text-field-null").val("");b.wrapper.addClass("l-text-focus");if(c.digits||c.number||c.currency){a(this).val(b.parseNumber());c.initSelect&&setTimeout(function(){b.inputText.select()},150)}}).change(function(){b.trigger("changeValue",[this.value])});b.wrapper.hover(function(){b.trigger("mouseOver");b.wrapper.addClass("l-text-over")},function(){b.trigger("mouseOut");b.wrapper.removeClass("l-text-over")})},parseNumber:function(a){var e=this,b=this.options,c=b.digits?true:false;a=a||e.inputText.val();if(a==null||a=="")return"";if(!(b.digits||b.number||b.currency))return a;if(typeof a!="string")a=(a||"").toString();var d=/^\-/.test(a);if(c){if(a=="0")return a;a=a.replace(/\D+|^[0]+/g,"")}else{a=a.replace(/[^0-9.]/g,"");if(/^[0]+[1-9]+/.test(a))a=a.replace(/^[0]+/,"")}if(!c&&b.precision){a=parseFloat(a).toFixed(b.precision);if(a=="NaN")return"0"}if(d)a="-"+a;return a},_setDisabled:function(a){var c=this,b=this.options;if(a){this.inputText.attr("readonly","readonly");this.wrapper.addClass("l-text-disabled")}else if(!b.readonly){this.inputText.removeAttr("readonly");this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(a){if(a>20){this.wrapper.css({width:a});this.inputText.css({width:a-4})}},_setHeight:function(a){if(a>10){this.wrapper.height(a);this.inputText.height(a-2)}},_setValue:function(a){a!=null&&this.inputText.val(a);this.checkNotNull()},_setLabel:function(e){var b=this,c=this.options;if(!b.labelwrapper){b.labelwrapper=b.wrapper.wrap('<div class="l-labeltext"></div>').parent();var d=a('<div class="l-text-label" style="float:left;">'+e+":&nbsp</div>");b.labelwrapper.prepend(d);b.wrapper.css("float","left");if(!c.labelWidth)c.labelWidth=d.width();else b._setLabelWidth(c.labelWidth);d.height(b.wrapper.height());c.labelAlign&&b._setLabelAlign(c.labelAlign);b.labelwrapper.append('<br style="clear:both;" />');b.labelwrapper.width(c.labelWidth+c.width+2)}else b.labelwrapper.find(".l-text-label").html(e+":&nbsp")},_setLabelWidth:function(b){var a=this,c=this.options;if(!a.labelwrapper)return;a.labelwrapper.find(".l-text-label").width(b)},_setLabelAlign:function(b){var a=this,c=this.options;if(!a.labelwrapper)return;a.labelwrapper.find(".l-text-label").css("text-align",b)},updateStyle:function(){var a=this,b=this.options;if(a.inputText.attr("readonly")){a.wrapper.addClass("l-text-readonly");b.disabled=true}else{a.wrapper.removeClass("l-text-readonly");b.disabled=false}if(a.inputText.attr("disabled")){a.wrapper.addClass("l-text-disabled");b.disabled=true}else{a.wrapper.removeClass("l-text-disabled");b.disabled=false}a.inputText.hasClass("l-text-field-null")&&a.inputText.val()!=b.nullText&&a.inputText.removeClass("l-text-field-null");a.formatValue()},setValue:function(a){this._setValue(a);this.trigger("changeValue",[a])}});function b(a,c){var b,f;if(!a)a=0;a=a.toString().replace(/\$|\,/g,"").replace(/[a-zA-Z]+/g,"");if(a.indexOf(".")>-1)a=a.replace(/[0]+$/g,"");if(isNaN(a))a=0;f=a==(a=Math.abs(a));if(c==null){a=a.toString();b=a.indexOf(".")!=-1?a.substr(a.indexOf(".")+1):"";if(b){a=Math.floor(a*1);a=a.toString()}}else{c=parseInt(c);var g=Math.pow(10,c);a=Math.floor(a*g+.50000000001);b=a%100;a=Math.floor(a/g).toString();while(b.toString().length<c)b="0"+b}for(var d=0;d<Math.floor((a.length-(1+d))/3);d++)a=a.substring(0,a.length-(4*d+3))+","+a.substring(a.length-(4*d+3));var e=""+((f?"":"-")+""+a);if(b)e+="."+b;return e}})(jQuery);(function(a){a.ligerTip=function(){return a.ligerui.run.call(null,"ligerTip",arguments)};a.fn.ligerTip=function(b){this.each(function(){var c=a.extend({},a.ligerDefaults.ElementTip,b||{});c.target=c.target||this;if(c.auto||b==undefined){if(!c.content){c.content=this.title;c.removeTitle&&a(this).removeAttr("title")}c.content=c.content||this.title;a(this).bind("mouseover.tip",function(){c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);a.ligerTip(c)}).bind("mouseout.tip",function(){var b=a.ligerui.managers[this.ligeruitipid];b&&b.remove()})}else{if(c.target.ligeruitipid)return;c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);c.x=c.x||0;c.y=c.y||0;a.ligerTip(c)}});return a.ligerui.get(this,"ligeruitipid")};a.fn.ligerHideTip=function(b){return this.each(function(){var c=b||{};if(c.isLabel==undefined)c.isLabel=this.tagName.toLowerCase()=="label"&&a(this).attr("for")!=null;var f=this;if(c.isLabel){var e=a("#"+a(this).attr("for"));if(e.length==0)return;f=e[0]}var d=a.ligerui.managers[f.ligeruitipid];d&&d.remove()}).unbind("mouseover.tip").unbind("mouseout.tip")};a.fn.ligerGetTipManager=function(){return a.ligerui.get(this)};a.ligerDefaults=a.ligerDefaults||{};a.ligerDefaults.HideTip={};a.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:true};a.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:true};a.ligerMethos.Tip={};a.ligerui.controls.Tip=function(b){a.ligerui.controls.Tip.base.constructor.call(this,null,b)};a.ligerui.controls.Tip.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return a.ligerMethos.Tip},_render:function(){var d=this,b=this.options,c=a('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');d.tip=c;d.tip.attr("id",d.id);if(b.content){a("> .l-verify-tip-content:first",c).html(b.content);c.appendTo("body")}else return;c.css({left:b.x,top:b.y}).show();b.width&&a("> .l-verify-tip-content:first",c).width(b.width-8);b.height&&a("> .l-verify-tip-content:first",c).width(b.height);eee=b.appendIdTo;b.appendIdTo&&b.appendIdTo.attr("ligerTipId",d.id);if(b.target){a(b.target).attr("ligerTipId",d.id);b.target.ligeruitipid=d.id}b.callback&&b.callback(c);d.set(b)},_setContent:function(b){a("> .l-verify-tip-content:first",this.tip).html(b)},remove:function(){this.options.appendIdTo&&this.options.appendIdTo.removeAttr("ligerTipId");if(this.options.target){a(this.options.target).removeAttr("ligerTipId");this.options.target.ligeruitipid=null}this.tip.remove()}})})(jQuery);(function(a){a.fn.ligerToolBar=function(){return a.ligerui.run.call(this,"ligerToolBar",arguments)};a.fn.ligerGetToolBarManager=function(){return a.ligerui.run.call(this,"ligerGetToolBarManager",arguments)};a.ligerDefaults.ToolBar={};a.ligerMethos.ToolBar={};a.ligerui.controls.ToolBar=function(b,c){a.ligerui.controls.ToolBar.base.constructor.call(this,b,c)};a.ligerui.controls.ToolBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return a.ligerMethos.ToolBar},_render:function(){var b=this,c=this.options;b.toolbarItemCount=0;b.toolBar=a(this.element);b.toolBar.addClass("l-toolbar");b.set(c)},_setItems:function(c){var b=this;b.toolBar.html("");a(c).each(function(c,a){b.addItem(a)})},removeItem:function(b){var c=this,d=this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).remove()},setEnabled:function(b){var c=this,d=this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).removeClass("l-toolbar-item-disable")},setDisabled:function(b){var c=this,d=this.options;a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).addClass("l-toolbar-item-disable")},isEnable:function(b){var c=this,d=this.options;return!a("> .l-toolbar-item[toolbarid="+b+"]",c.toolBar).hasClass("l-toolbar-item-disable")},addItem:function(b){var d=this,e=this.options;if(b.line||b.type=="line"){d.toolBar.append('<div class="l-bar-separator"></div>');return}if(b.type=="text"){d.toolBar.append('<div class="l-toolbar-item l-toolbar-text"><span>'+b.text||"</span></div>");return}var c=a('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');d.toolBar.append(c);if(!b.id)b.id="item-"+ ++d.toolbarItemCount;c.attr("toolbarid",b.id);if(b.img){c.append("<img src='"+b.img+"' />");c.addClass("l-toolbar-item-hasicon")}else if(b.icon){c.append("<div class='l-icon l-icon-"+b.icon+"'></div>");c.addClass("l-toolbar-item-hasicon")}else if(b.color){c.append("<div class='l-toolbar-item-color' style='background:"+b.color+"'></div>");c.addClass("l-toolbar-item-hasicon")}b.text&&a("span:first",c).html(b.text);b.disable&&c.addClass("l-toolbar-item-disable");b.click&&c.click(function(){if(a(this).hasClass("l-toolbar-item-disable"))return;b.click(b)});if(b.menu){b.menu=a.ligerMenu(b.menu);c.hover(function(){if(a(this).hasClass("l-toolbar-item-disable"))return;d.actionMenu&&d.actionMenu.hide();var c=a(this).offset().left,e=a(this).offset().top+a(this).height();b.menu.show({top:e,left:c});d.actionMenu=b.menu;a(this).addClass("l-panel-btn-over")},function(){if(a(this).hasClass("l-toolbar-item-disable"))return;a(this).removeClass("l-panel-btn-over")})}else c.hover(function(){if(a(this).hasClass("l-toolbar-item-disable"))return;a(this).addClass("l-panel-btn-over")},function(){if(a(this).hasClass("l-toolbar-item-disable"))return;a(this).removeClass("l-panel-btn-over")})}});a.ligerui.controls.ToolBar.prototype.setEnable=a.ligerui.controls.ToolBar.prototype.setEnabled;a.ligerui.controls.ToolBar.prototype.setDisable=a.ligerui.controls.ToolBar.prototype.setDisabled})(jQuery);(function(a){a.fn.ligerTree=function(){return a.ligerui.run.call(this,"ligerTree",arguments)};a.fn.ligerGetTreeManager=function(){return a.ligerui.run.call(this,"ligerGetTreeManager",arguments)};a.ligerDefaults.Tree={url:null,urlParms:null,data:null,checkbox:true,autoCheckboxEven:true,enabledCompleteCheckbox:true,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:true,nodeWidth:90,statusName:"__status",isLeaf:null,single:false,needCancel:true,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:true,iconFieldName:"icon",nodeDraggable:false,nodeDraggingRender:null,btnClickToToggleOnly:true,ajaxType:"post",ajaxContentType:null,render:null,selectable:null,isExpand:null,delay:null,idField:null,parentIDField:null,iconClsFieldName:null};a.ligerui.controls.Tree=function(b,c){a.ligerui.controls.Tree.base.constructor.call(this,b,c)};a.ligerui.controls.Tree.ligerExtend(a.ligerui.core.UIComponent,{_init:function(){a.ligerui.controls.Tree.base._init.call(this);var c=this,b=this.options;if(b.single)b.autoCheckboxEven=false},_render:function(){var b=this,c=this.options;b.set(c,true);b.tree=a(b.element);b.tree.addClass("l-tree");b.toggleNodeCallbacks=[];b.sysAttribute=["isexpand","ischecked","href","style","delay"];b.loading=a("<div class='l-tree-loading'></div>");b.tree.after(b.loading);b.data=[];b.maxOutlineLevel=1;b.treedataindex=0;b._applyTree();b._setTreeEven();b.set(c,false)},_setTreeLine:function(a){if(a)this.tree.removeClass("l-tree-noline");else this.tree.addClass("l-tree-noline")},_setParms:function(){var c=this,b=this.options;if(a.isFunction(b.parms))b.parms=b.parms()},reload:function(b){var a=this,c=this.options;a.clear();a.loadData(null,c.url,null,{success:b})},reloadNode:function(d,a,e){var b=this,c=this.options;b.clear(d);if(typeof a=="string")b.loadData(d,a,null,{success:e});else{if(!a)return;if(c.idField&&c.parentIDField)a=b.arrayToTree(a,c.idField,c.parentIDField);b.append(d,a)}},_setUrl:function(a){var b=this,c=this.options;if(a){b.clear();b.loadData(null,a)}},_setData:function(a){if(a){this.clear();this.append(null,a)}},setData:function(a){this.set("data",a)},getData:function(){return this.data},hasChildren:function(a){return this.options.isLeaf?!this.options.isLeaf(a):a.children?true:false},getParent:function(c,f){var b=this;c=b.getNodeDom(c);var d=b.getParentTreeItem(c,f);if(!d)return null;var e=a(d).attr("treedataindex");return b._getDataNodeByTreeDataIndex(b.data,e)},getParentTreeItem:function(d,e){var h=this;d=h.getNodeDom(d);var b=a(d);if(b.parent().hasClass("l-tree"))return null;if(e==undefined)return b.parent().parent("li").length==0?null:b.parent().parent("li")[0];for(var g=parseInt(b.attr("outlinelevel")),c=b,f=g-1;f>=e;f--)c=c.parent().parent("li");return c[0]},getChecked:function(){var b=this,d=this.options;if(!this.options.checkbox)return null;var c=[];a(".l-checkbox-checked",b.tree).parent().parent("li").each(function(){var d=parseInt(a(this).attr("treedataindex"));c.push({target:this,data:b._getDataNodeByTreeDataIndex(b.data,d)})});return c},getCheckedData:function(){var b=this,d=this.options;if(!this.options.checkbox)return null;var c=[];a(".l-checkbox-checked",b.tree).parent().parent("li").each(function(){var d=parseInt(a(this).attr("treedataindex"));c.push(b._getDataNodeByTreeDataIndex(b.data,d))});return c},refreshTree:function(){var b=this,c=this.options;a.each(this.getChecked(),function(d,c){b._setParentCheckboxStatus(a(c.target))})},getSelected:function(){var c=this,e=this.options,b={};b.target=a(".l-selected",c.tree).parent("li")[0];if(b.target){var d=parseInt(a(b.target).attr("treedataindex"));b.data=c._getDataNodeByTreeDataIndex(c.data,d);return b}return null},upgrade:function(b){var c=this,d=this.options;a(".l-note",b).each(function(){a(this).removeClass("l-note").addClass("l-expandable-open")});a(".l-note-last",b).each(function(){a(this).removeClass("l-note-last").addClass("l-expandable-open")});a("."+c._getChildNodeClassName(),b).each(function(){a(this).removeClass(c._getChildNodeClassName()).addClass(c._getParentNodeClassName(true))})},demotion:function(b){var c=this,e=this.options;if(!b&&b[0].tagName.toLowerCase()!="li")return;var d=a(b).hasClass("l-last");a(".l-expandable-open",b).each(function(){a(this).removeClass("l-expandable-open").addClass(d?"l-note-last":"l-note")});a(".l-expandable-close",b).each(function(){a(this).removeClass("l-expandable-close").addClass(d?"l-note-last":"l-note")});a("."+c._getParentNodeClassName(true),b).each(function(){a(this).removeClass(c._getParentNodeClassName(true)).addClass(c._getChildNodeClassName())})},collapseAll:function(){var b=this,c=this.options;a(".l-expandable-open",b.tree).click()},expandAll:function(){var b=this,c=this.options;a(".l-expandable-close",b.tree).click()},arrayToTree:function(b,m,l){var n=this,o=this.options,d="children";if(!b||!b.length)return[];for(var g=[],h={},f=b.length,a=0;a<f;a++){var k=b[a],j=i(k[m]);h[j]=k}for(var a=0;a<f;a++){var e=b[a],j=i(e[l]),c=h[j];if(!c){g.push(e);continue}c[d]=c[d]||[];c[d].push(e)}return g;function i(a){if(typeof a=="string")a=a.replace(/[.]/g,"").toLowerCase();return a}},loadData:function(j,f,e,c){var d=this,b=this.options;c=a.extend({showLoading:function(){d.loading.show()},success:function(){},error:function(){},hideLoading:function(){d.loading.hide()}},c||{});var i=b.ajaxType;e=a.extend(a.isFunction(b.parms)?b.parms():b.parms,e);if(b.ajaxContentType=="application/json"&&typeof e!="string")e=liger.toJSON(e);var g=a.isFunction(b.urlParms)?b.urlParms.call(d):b.urlParms;if(g)for(name in g){f+=f.indexOf("?")==-1?"?":"&";f+=name+"="+g[name]}var h={type:i,url:f,data:e,dataType:"json",beforeSend:function(){c.showLoading()},success:function(a){if(!a)return;if(b.idField&&b.parentIDField)a=d.arrayToTree(a,b.idField,b.parentIDField);c.hideLoading();d.append(j,a);d.trigger("success",[a]);c.success(a)},error:function(a,e,b){try{c.hideLoading();d.trigger("error",[a,e,b]);c.error(a,e,b)}catch(c){}}};if(b.ajaxContentType)h.contentType=b.ajaxContentType;a.ajax(h)},clear:function(e){var b=this,f=this.options;if(!e){b.toggleNodeCallbacks=[];b.data=null;b.data=[];b.nodes=null;b.tree.html("")}else{var d=b.getNodeDom(e),c=b._getDataNodeByTreeDataIndex(b.data,a(d).attr("treedataindex"));a(d).find("ul.l-children").remove();if(c)c.children=[]}},getNodeDom:function(b){var c=this,d=this.options;return b==null?b:typeof b=="string"||typeof b=="number"?a("li[treedataindex="+b+"]",c.tree).get(0):typeof b=="object"&&"treedataindex"in b?c.getNodeDom(b.treedataindex):b.target&&b.data?b.target:b},hide:function(b){var c=this,d=this.options;b=c.getNodeDom(b);b&&a(b).hide()},show:function(b){var c=this,d=this.options;b=c.getNodeDom(b);b&&a(b).show()},remove:function(c){var b=this,g=this.options;c=b.getNodeDom(c);var f=parseInt(a(c).attr("treedataindex")),d=b._getDataNodeByTreeDataIndex(b.data,f);d&&b._setTreeDataStatus([d],"delete");var e=b.getParentTreeItem(c);g.checkbox&&b._setParentCheckboxStatus(a(c));a(c).remove();b._updateStyle(e?a("ul:first",e):b.tree)},_updateStyle:function(d){var e=this,f=this.options,c=a(" > li",d),b=c.length;if(!b)return;c.each(function(c){c==0&&!a(this).hasClass("l-first")&&a(this).addClass("l-first");c==b-1&&!a(this).hasClass("l-last")&&a(this).addClass("l-last");c==0&&c==b-1&&a(this).addClass("l-onlychild");a("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(c==b-1?"l-note-last":"l-note");e._setTreeItem(this,{isLast:c==b-1})})},update:function(b,d){var e=this,g=this.options;b=e.getNodeDom(b);var f=parseInt(a(b).attr("treedataindex"));nodedata=e._getDataNodeByTreeDataIndex(e.data,f);for(var c in d){nodedata[c]=d[c];c==g.textFieldName&&a("> .l-body > span",b).text(d[c])}},append:function(c,d,f,l){var b=this,h=this.options;c=b.getNodeDom(c);if(b.trigger("beforeAppend",[c,d])==false)return false;if(!d||!d.length)return false;if(h.idFieldName&&h.parentIDFieldName)d=b.arrayToTree(d,h.idFieldName,h.parentIDFieldName);b._addTreeDataIndexToData(d);b._setTreeDataStatus(d,"add");if(f!=null)f=b.getNodeDom(f);b.trigger("append",[c,d]);b._appendData(c,d);if(c==null){var e=b._getTreeHTMLByData(d,1,[],true);e[e.length-1]=e[0]="";if(f!=null){a(f)[l?"after":"before"](e.join(""));b._updateStyle(c?a("ul:first",c):b.tree)}else{a("> li:last",b.tree).length>0&&b._setTreeItem(a("> li:last",b.tree)[0],{isLast:false});b.tree.append(e.join(""))}a(".l-body",b.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});b._upadteTreeWidth();b.trigger("afterAppend",[c,d]);return}var g=a(c),k=parseInt(g.attr("outlinelevel")),n=a("> ul",g).length>0;if(!n){g.append("<ul class='l-children'></ul>");b.upgrade(c)}for(var i=[],j=1;j<=k-1;j++){var m=a(b.getParentTreeItem(c,j));i.push(m.hasClass("l-last"))}i.push(g.hasClass("l-last"));var e=b._getTreeHTMLByData(d,k+1,i,true);e[e.length-1]=e[0]="";if(f!=null){a(f)[l?"after":"before"](e.join(""));b._updateStyle(c?a("ul:first",c):b.tree)}else{a("> .l-children > li:last",g).length>0&&b._setTreeItem(a("> .l-children > li:last",g)[0],{isLast:false});a(">.l-children",c).append(e.join(""))}b._upadteTreeWidth();a(">.l-children .l-body",c).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});b.trigger("afterAppend",[c,d])},cancelSelect:function(h,e){var b=this,j=this.options,i=b.getNodeDom(h),c=a(i),f=parseInt(c.attr("treedataindex")),g=b._getDataNodeByTreeDataIndex(b.data,f),d=a(">div:first",c);if(j.checkbox)a(".l-checkbox",d).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");else d.removeClass("l-selected");e!=false&&b.trigger("cancelSelect",[{data:g,target:c[0]}])},selectNode:function(d,g){var c=this,f=this.options,h=null;if(typeof d=="function")h=d;else if(typeof d=="object"){var j=a(d),i=parseInt(j.attr("treedataindex")),k=c._getDataNodeByTreeDataIndex(c.data,i),e=a(">div:first",j);if(!e.length)e=a("li[treedataindex="+i+"] >div:first",c.tree);if(f.checkbox)a(".l-checkbox",e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");else{a("div.l-selected",c.tree).removeClass("l-selected");e.addClass("l-selected")}g!=false&&c.trigger("select",[{data:k,target:e.parent().get(0)}]);return}else h=function(a){return!a[f.idFieldName]&&a[f.idFieldName]!=0?false:b(a[f.idFieldName].toString())==b(d.toString())};a("li",c.tree).each(function(){var e=a(this),b=parseInt(e.attr("treedataindex")),d=c._getDataNodeByTreeDataIndex(c.data,b);if(h(d,b))c.selectNode(this,g);else!c.options.checkbox&&c.cancelSelect(this,g)})},getTextByID:function(b){var c=this,d=this.options,a=c.getDataByID(b);return!a?null:a[d.textFieldName]},getDataByID:function(e){var b=this,f=this.options,c=null;if(b.data&&b.data.length)return d(b.data);function d(c){for(var b=0;b<c.length;b++){var a=c[b];if(a[f.idFieldName]==e)return a;if(a.children&&a.children.length){var g=d(a.children);if(g)return g}}return null}a("li",b.tree).each(function(){if(c)return;var h=a(this),g=parseInt(h.attr("treedataindex")),d=b._getDataNodeByTreeDataIndex(b.data,g);if(d[f.idFieldName].toString()==e.toString())c=d});return c},arrayToTree:function(b,j,i){if(!b||!b.length)return[];for(var f=[],g={},e=b.length,a=0;a<e;a++){var h=b[a];g[h[j]]=h}for(var a=0;a<e;a++){var d=b[a],c=g[d[i]];if(!c){f.push(d);continue}c.children=c.children||[];c.children.push(d)}return f},_getDataNodeByTreeDataIndex:function(b,c){for(var e=this,f=this.options,a=0;a<b.length;a++){if(b[a].treedataindex==c)return b[a];if(b[a].children){var d=e._getDataNodeByTreeDataIndex(b[a].children,c);if(d)return d}}return null},_setTreeDataStatus:function(c,b){var d=this,e=this.options;a(c).each(function(){this[e.statusName]=b;this.children&&d._setTreeDataStatus(this.children,b)})},_addTreeDataIndexToData:function(c){var b=this,d=this.options;a(c).each(function(){if(this.treedataindex!=undefined)return;this.treedataindex=b.treedataindex++;this.children&&b._addTreeDataIndexToData(this.children)})},_addToNodes:function(c){var b=this,d=this.options;b.nodes=b.nodes||[];b.nodes.push(c);if(!c.children)return;a(c.children).each(function(c,a){b._addToNodes(a)})},_appendData:function(e,f){var b=this,g=this.options,d=parseInt(a(e).attr("treedataindex")),c=b._getDataNodeByTreeDataIndex(b.data,d);if(b.treedataindex==undefined)b.treedataindex=0;if(c&&c.children==undefined)c.children=[];a(f).each(function(d,a){if(c)c.children[c.children.length]=a;else b.data[b.data.length]=a;b._addToNodes(a)})},_setTreeItem:function(d,c){var f=this,g=this.options;if(!c)return;d=f.getNodeDom(d);var b=a(d),e=parseInt(b.attr("outlinelevel"));if(c.isLast!=undefined)if(c.isLast==true){b.removeClass("l-last").addClass("l-last");a("> div .l-note",b).removeClass("l-note").addClass("l-note-last");a(".l-children li",b).find(".l-box:eq("+(e-1)+")").removeClass("l-line")}else if(c.isLast==false){b.removeClass("l-last");a("> div .l-note-last",b).removeClass("l-note-last").addClass("l-note");a(".l-children li",b).find(".l-box:eq("+(e-1)+")").removeClass("l-line").addClass("l-line")}},_upadteTreeWidth:function(){var c=this,b=this.options,a=c.maxOutlineLevel*22;if(b.checkbox)a+=22;if(b.parentIcon||b.childIcon)a+=22;a+=b.nodeWidth;c.tree.width(a)},_getChildNodeClassName:function(){var b=this,a=this.options;return"l-tree-icon-"+a.childIcon},_getParentNodeClassName:function(b){var d=this,c=this.options,a="l-tree-icon-"+c.parentIcon;if(b)a+="-open";return a},_isExpand:function(b,c){var e=this,d=this.options,a=b.isExpand!=null?b.isExpand:b.isexpand!=null?b.isexpand:d.isExpand;if(a==null)return true;if(typeof a=="function")a=d.isExpand({data:b,level:c});return typeof a=="boolean"?a:typeof a=="string"?a=="true":typeof a=="number"?a>c:true},_getDelay:function(c,d){var f=this,e=this.options,b=c.delay!=null?c.delay:e.delay;if(b==null)return false;if(typeof b=="function")b=b({data:c,level:d});if(typeof b=="boolean")return b;if(typeof b=="string")return{url:b};if(typeof b=="number")b=[b];return a.isArray(b)?a.inArray(d,b)!=-1:typeof b=="object"&&b.url?b:false},_getTreeHTMLByData:function(o,f,k,q){var e=this,c=this.options;if(e.maxOutlineLevel<f)e.maxOutlineLevel=f;k=k||[];f=f||1;var b=[];if(!q)b.push('<ul class="l-children" style="display:none">');else b.push("<ul class='l-children'>");for(var l=0;l<o.length;l++){var d=o[l],p=l==0,m=l==o.length-1,h=e._getDelay(d,f),j=h?false:e._isExpand(d,f);b.push("<li ");d.treedataindex!=undefined&&b.push('treedataindex="'+d.treedataindex+'" ');j&&b.push("isexpand="+d.isexpand+" ");b.push("outlinelevel="+f+" ");for(var g=0;g<e.sysAttribute.length;g++)if(a(this).attr(e.sysAttribute[g]))o[dataindex][e.sysAttribute[g]]=a(this).attr(e.sysAttribute[g]);for(var g=0;g<c.attribute.length;g++)d[c.attribute[g]]&&b.push(c.attribute[g]+'="'+d[c.attribute[g]]+'" ');b.push('class="');p&&b.push("l-first ");m&&b.push("l-last ");p&&m&&b.push("l-onlychild ");b.push('"');b.push(">");b.push('<div class="l-body');c.selectable&&c.selectable(d)==false&&b.push(" l-unselectable");b.push('">');for(var i=0;i<=f-2;i++)if(k[i])b.push('<div class="l-box"></div>');else b.push('<div class="l-box l-line"></div>');if(e.hasChildren(d)){if(j)b.push('<div class="l-box l-expandable-open"></div>');else b.push('<div class="l-box l-expandable-close"></div>');if(c.checkbox)if(d.ischecked)b.push('<div class="l-box l-checkbox l-checkbox-checked"></div>');else b.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>');if(c.parentIcon){b.push('<div class="l-box l-tree-icon ');b.push(e._getParentNodeClassName(j?true:false)+" ");if(c.iconFieldName&&d[c.iconFieldName])b.push("l-tree-icon-none");else c.iconClsFieldName&&d[c.iconClsFieldName]&&b.push("l-tree-icon-"+d[c.iconClsFieldName]+" ");b.push('">');c.iconFieldName&&d[c.iconFieldName]&&b.push('<img src="'+d[c.iconFieldName]+'" />');b.push("</div>")}}else{if(m)b.push('<div class="l-box l-note-last"></div>');else b.push('<div class="l-box l-note"></div>');if(c.checkbox)if(d.ischecked)b.push('<div class="l-box l-checkbox l-checkbox-checked"></div>');else b.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>');if(c.childIcon){b.push('<div class="l-box l-tree-icon ');b.push(e._getChildNodeClassName()+" ");if(c.iconFieldName&&d[c.iconFieldName])b.push("l-tree-icon-none");else c.iconClsFieldName&&d[c.iconClsFieldName]&&b.push("l-tree-icon-"+d[c.iconClsFieldName]+" ");b.push('">');c.iconFieldName&&d[c.iconFieldName]&&b.push('<img src="'+d[c.iconFieldName]+'" />');b.push("</div>")}}if(c.render)b.push("<span>"+c.render(d,d[c.textFieldName])+"</span>");else b.push("<span>"+d[c.textFieldName]+"</span>");b.push("</div>");if(e.hasChildren(d)){for(var n=[],i=0;i<k.length;i++)n.push(k[i]);n.push(m);if(h)if(h==true)e.toggleNodeCallbacks.push({data:d,callback:function(b,c){var d=e._getTreeHTMLByData(c.children,f+1,n,j).join("");a(b).append(d);a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});e._removeToggleNodeCallback(c)}});else h.url&&(function(d,c,b){e.toggleNodeCallbacks.push({data:d,callback:function(d,f){e.loadData(d,c,b,{showLoading:function(){a("div.l-expandable-close:first",d).addClass("l-box-loading")},hideLoading:function(){a("div.l-box-loading:first",d).removeClass("l-box-loading")}});e._removeToggleNodeCallback(f)}})})(d,h.url,h.parms);else b.push(e._getTreeHTMLByData(d.children,f+1,n,j).join(""))}b.push("</li>")}b.push("</ul>");return b},_removeToggleNodeCallback:function(c){for(var b=this,d=this.options,a=0;a<=b.toggleNodeCallbacks.length;a++)if(b.toggleNodeCallbacks[a]&&b.toggleNodeCallbacks[a].data==c){b.toggleNodeCallbacks.splice(a,1);break}},_getDataByTreeHTML:function(e){var c=this,d=this.options,b=[];a("> li",e).each(function(){var f=b.length;b[f]={treedataindex:c.treedataindex++};b[f][d.textFieldName]=a("> span,> a",this).html();for(var e=0;e<c.sysAttribute.length;e++)if(a(this).attr(c.sysAttribute[e]))b[f][c.sysAttribute[e]]=a(this).attr(c.sysAttribute[e]);for(var e=0;e<d.attribute.length;e++)if(a(this).attr(d.attribute[e]))b[f][d.attribute[e]]=a(this).attr(d.attribute[e]);if(a("> ul",this).length>0)b[f].children=c._getDataByTreeHTML(a("> ul",this))});return b},_applyTree:function(){var b=this,d=this.options;b.data=b._getDataByTreeHTML(b.tree);var c=b._getTreeHTMLByData(b.data,1,[],true);c[c.length-1]=c[0]="";b.tree.html(c.join(""));b._upadteTreeWidth();a(".l-body",b.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(f){var g=this,e=f.target||f.srcElement,i=e.tagName.toLowerCase(),b=a(e).parents().add(e),c=function(d){for(var c=b.length-1;c>=0;c--)if(a(b[c]).hasClass(d))return b[c];return null};if(b.index(this.element)==-1)return{out:true};var d={tree:c("l-tree"),node:c("l-body"),checkbox:c("l-checkbox"),icon:c("l-tree-icon"),text:i=="span"};if(d.node){var h=parseInt(a(d.node).parent().attr("treedataindex"));d.data=g._getDataNodeByTreeDataIndex(g.data,h)}return d},_setTreeEven:function(){var b=this,c=this.options;b.hasBind("contextmenu")&&b.tree.bind("contextmenu",function(e){var c=e.target||e.srcElement,d=null;if(c.tagName.toLowerCase()=="a"||c.tagName.toLowerCase()=="span"||a(c).hasClass("l-box"))d=a(c).parent().parent();else if(a(c).hasClass("l-body"))d=a(c).parent();else if(c.tagName.toLowerCase()=="li")d=a(c);if(!d)return;var f=parseInt(d.attr("treedataindex")),g=b._getDataNodeByTreeDataIndex(b.data,f);return b.trigger("contextmenu",[{data:g,target:d[0]},e])});b.tree.click(function(j){var e=j.target||j.srcElement,d=null;if(e.tagName.toLowerCase()=="a"||e.tagName.toLowerCase()=="span"||a(e).hasClass("l-box"))d=a(e).parent().parent();else if(a(e).hasClass("l-body"))d=a(e).parent();else d=a(e);if(!d)return;var k=parseInt(d.attr("treedataindex")),f=b._getDataNodeByTreeDataIndex(b.data,k),g=a("div.l-body:first",d).find("div.l-expandable-open:first,div.l-expandable-close:first"),h=a(e).hasClass("l-expandable-open")||a(e).hasClass("l-expandable-close");if(!a(e).hasClass("l-checkbox")&&!h)if(!d.hasClass("l-unselectable"))if(a(">div:first",d).hasClass("l-selected")&&c.needCancel){if(b.trigger("beforeCancelSelect",[{data:f,target:d[0]}])==false)return false;a(">div:first",d).removeClass("l-selected");b.trigger("cancelSelect",[{data:f,target:d[0]}])}else{if(b.trigger("beforeSelect",[{data:f,target:d[0]}])==false)return false;a(".l-body",b.tree).removeClass("l-selected");a(">div:first",d).addClass("l-selected");b.trigger("select",[{data:f,target:d[0]}])}if(a(e).hasClass("l-checkbox")){if(c.autoCheckboxEven){if(a(e).hasClass("l-checkbox-unchecked")){a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");a(".l-children .l-checkbox",d).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:f,target:d[0]},true])}else if(a(e).hasClass("l-checkbox-checked")){a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");a(".l-children .l-checkbox",d).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:f,target:d[0]},false])}else if(a(e).hasClass("l-checkbox-incomplete")){a(e).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked");a(".l-children .l-checkbox",d).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:f,target:d[0]},true])}b._setParentCheckboxStatus(d)}else if(a(e).hasClass("l-checkbox-unchecked")){a(e).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");c.single&&a(".l-checkbox",b.tree).not(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:f,target:d[0]},true])}else if(a(e).hasClass("l-checkbox-checked")){a(e).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:f,target:d[0]},false])}}else if(g.hasClass("l-expandable-open")&&(!c.btnClickToToggleOnly||h)){if(b.trigger("beforeCollapse",[{data:f,target:d[0]}])==false)return false;g.removeClass("l-expandable-open").addClass("l-expandable-close");if(c.slide)a("> .l-children",d).slideToggle("fast");else a("> .l-children",d).hide();a("> div ."+b._getParentNodeClassName(true),d).removeClass(b._getParentNodeClassName(true)).addClass(b._getParentNodeClassName());b.trigger("collapse",[{data:f,target:d[0]}])}else if(g.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||h)){if(b.trigger("beforeExpand",[{data:f,target:d[0]}])==false)return false;a(b.toggleNodeCallbacks).each(function(){this.data==f&&this.callback(d[0],f)});g.removeClass("l-expandable-close").addClass("l-expandable-open");var i=function(){b.trigger("expand",[{data:f,target:d[0]}])};if(c.slide)a("> .l-children",d).slideToggle("fast",i);else{a("> .l-children",d).show();i()}a("> div ."+b._getParentNodeClassName(),d).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(true))}b.trigger("click",[{data:f,target:d[0]}])});if(a.fn.ligerDrag&&c.nodeDraggable){b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body");b.tree.ligerDrag({revert:true,animate:false,proxyX:20,proxyY:20,proxy:function(e,j){var i=b._getSrcElementByEvent(j);if(i.node){var d="dragging";if(c.nodeDraggingRender)d=c.nodeDraggingRender(e.draggingNodes,e,b);else{d="";var f=false;for(var k in e.draggingNodes){var h=e.draggingNodes[k];if(f)d+=",";d+=h.text;f=true}}var g=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+d+"</div>").appendTo("body");return g}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");b.children[this.id]=this},onStartDrag:function(g,e){if(e.button==2)return false;this.set("cursor","default");var a=b._getSrcElementByEvent(e);if(a.checkbox)return false;if(c.checkbox){var d=b.getChecked();this.draggingNodes=[];for(var f in d)this.draggingNodes.push(d[f].data);if(!this.draggingNodes||!this.draggingNodes.length)return false}else this.draggingNodes=[a.data];this.draggingNode=a.data;this.set("cursor","move");b.nodedragging=true;this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(s,p){var h=this.draggingNode;if(!h)return false;var q=this.draggingNodes?this.draggingNodes:[h];if(b.nodeDropIn==null)b.nodeDropIn=-1;var g=p.pageX,d=p.pageY,n=false,f=this.validRange;if(g<f.left||g>f.right||d>f.bottom||d<f.top){b.nodeDropIn=-1;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var k=0,r=b.nodes.length;k<r;k++){var o=b.nodes[k],e=o.treedataindex;if(h.treedataindex==e)n=true;if(a.inArray(o,q)!=-1)continue;var l=n?true:false;if(b.nodeDropIn!=-1&&b.nodeDropIn!=e)continue;var j=a("li[treedataindex="+e+"] div:first",b.tree),i=j.offset(),c={top:i.top,bottom:i.top+j.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()};if(g>c.left&&g<c.right&&d>c.top&&d<c.bottom){var m=i.top;if(l)m+=j.height();b.nodeDroptip.css({left:c.left,top:m,width:c.right-c.left}).show();b.nodeDropIn=e;b.nodeDropDir=l?"bottom":"top";if(d>c.top+7&&d<c.bottom-7){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");b.nodeDroptip.hide();b.nodeDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");b.nodeDroptip.show();b.nodeDropInParent=false}break}else if(b.nodeDropIn!=-1){b.nodeDropIn=-1;b.nodeDropInParent=false;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}},onStopDrag:function(){var c=this.draggingNodes;b.nodedragging=false;if(b.nodeDropIn!=-1){for(var e=0;e<c.length;e++){var f=c[e].children;if(f)c=a.grep(c,function(c){return a.inArray(c,f)==-1})}for(var e in c){var d=c[e];if(b.nodeDropInParent){b.remove(d);b.append(b.nodeDropIn,[d])}else{b.remove(d);b.append(b.getParent(b.nodeDropIn),[d],b.nodeDropIn,b.nodeDropDir=="bottom")}}b.nodeDropIn=-1}b.nodeDroptip.hide();this.set("cursor","default")}})}},_setParentCheckboxStatus:function(b){var e=this,f=this.options,c=a(".l-checkbox-unchecked",b.parent()).length==0,d=a(".l-checkbox-checked",b.parent()).length==0;if(d)b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked");else if(c||!f.enabledCompleteCheckbox)b.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked");else b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete");b.parent().parent("li").length>0&&e._setParentCheckboxStatus(b.parent().parent("li"))}});function b(a){return!a?a:a.replace(/(^\s*)|(\s*$)/g,"")}})(jQuery);(function(a){var b=a.ligerui;b.windowCount=0;a.ligerWindow=function(){return b.run.call(null,"ligerWindow",arguments,{isStatic:true})};a.ligerWindow.show=function(b){return a.ligerWindow(b)};a.ligerDefaults.Window={showClose:true,showMax:true,showToggle:true,showMin:true,title:"window",load:false,onLoaded:null,onClose:null,onRegain:null,onMax:null,modal:false};a.ligerMethos.Window={};b.controls.Window=function(a){b.controls.Window.base.constructor.call(this,null,a)};b.controls.Window.ligerExtend(b.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return a.ligerMethos.Window},_render:function(){var c=this,d=this.options;c.window=a('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>');c.element=c.window[0];c.window.content=a(".l-window-content",c.window);c.window.header=a(".l-window-header",c.window);c.window.buttons=a(".l-window-header-buttons:first",c.window);if(d.url)if(d.load){c.window.content.load(d.url,function(){c.trigger("loaded")});c.window.content.addClass("l-window-content-scroll")}else{var h=a("<iframe frameborder='0' src='"+d.url+"'></iframe>"),e="ligeruiwindow"+b.windowCount++;if(d.name)e=d.name;h.attr("name",e).attr("id",e);d.framename=e;h.appendTo(c.window.content);c.iframe=h}else if(d.content){var i=a("<div>"+d.content+"</div>");i.appendTo(c.window.content)}else if(d.target){c.window.content.append(d.target);d.target.show()}this.mask();c.active();a("body").append(c.window);c.set({width:d.width,height:d.height});var f=0,g=0;if(d.left!=null)f=d.left;else d.left=f=.5*(a(window).width()-c.window.width());if(d.top!=null)g=d.top;else d.top=g=.5*(a(window).height()-c.window.height())+a(window).scrollTop()-10;if(f<0)d.left=f=0;if(g<0)d.top=g=0;c.set(d);d.framename&&a(">iframe",c.window.content).attr("name",d.framename);!d.showToggle&&a(".l-window-toggle",c.window).remove();!d.showMax&&a(".l-window-max",c.window).remove();!d.showClose&&a(".l-window-close",c.window).remove();c._saveStatus();if(a.fn.ligerDrag)c.draggable=c.window.drag=c.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){c.active()},onStopDrag:function(){c._saveStatus()},animate:false});if(a.fn.ligerResizable){c.resizeable=c.window.resizable=c.window.ligerResizable({onStartResize:function(){c.active();a(".l-window-max",c.window).removeClass("l-window-regain")},onStopResize:function(a){var d=0,b=0;if(!isNaN(parseInt(c.window.css("top"))))d=parseInt(c.window.css("top"));if(!isNaN(parseInt(c.window.css("left"))))b=parseInt(c.window.css("left"));a.diffTop&&c.window.css({top:d+a.diffTop});a.diffLeft&&c.window.css({left:b+a.diffLeft});a.newWidth&&c.window.width(a.newWidth);a.newHeight&&c.window.content.height(a.newHeight-28);c._saveStatus();return false}});c.window.append("<div class='l-btn-nw-drop'></div>")}a(".l-window-toggle",c.window).click(function(){if(a(this).hasClass("l-window-toggle-close")){c.collapsed=false;a(this).removeClass("l-window-toggle-close")}else{c.collapsed=true;a(this).addClass("l-window-toggle-close")}c.window.content.slideToggle()}).hover(function(){c.window.drag&&c.window.drag.set("disabled",true)},function(){c.window.drag&&c.window.drag.set("disabled",false)});a(".l-window-close",c.window).click(function(){if(c.trigger("close")==false)return false;c.window.hide();b.win.removeTask(c)}).hover(function(){c.window.drag&&c.window.drag.set("disabled",true)},function(){c.window.drag&&c.window.drag.set("disabled",false)});a(".l-window-max",c.window).click(function(){if(a(this).hasClass("l-window-regain")){if(c.trigger("regain")==false)return false;c.window.width(c._width).css({left:c._left,top:c._top});c.window.content.height(c._height-28);a(this).removeClass("l-window-regain")}else{if(c.trigger("max")==false)return false;c.window.width(a(window).width()-2).css({left:0,top:0});c.window.content.height(a(window).height()-28).show();a(this).addClass("l-window-regain")}})},_saveStatus:function(){var a=this;a._width=a.window.width();a._height=a.window.height();var c=0,b=0;if(!isNaN(parseInt(a.window.css("top"))))c=parseInt(a.window.css("top"));if(!isNaN(parseInt(a.window.css("left"))))b=parseInt(a.window.css("left"));a._top=c;a._left=b},min:function(){this.window.hide();this.minimize=true;this.actived=false},_setShowMin:function(d){var c=this,e=this.options;if(d){if(!c.winmin){c.winmin=a('<div class="l-window-min"></div>').prependTo(c.window.buttons).click(function(){c.min()});b.win.addTask(c)}}else if(c.winmin){c.winmin.remove();c.winmin=null}},_setLeft:function(a){a!=null&&this.window.css({left:a})},_setTop:function(a){a!=null&&this.window.css({top:a})},_setWidth:function(a){a>0&&this.window.width(a)},_setHeight:function(a){a>28&&this.window.content.height(a-28)},_setTitle:function(b){b&&a(".l-window-header-inner",this.window.header).html(b)},_setUrl:function(c){var a=this,b=this.options;b.url=c;if(b.load)a.window.content.html("").load(b.url,function(){if(a.trigger("loaded")==false)return false});else a.jiframe&&a.jiframe.attr("src",b.url)},hide:function(){var a=this,b=this.options;this.unmask();this.window.hide()},show:function(){var a=this,b=this.options;this.mask();this.window.show()},remove:function(){var a=this,b=this.options;this.unmask();this.window.remove()},active:function(){var c=this,h=this.options;if(c.minimize){var f=c._width,d=c._height,g=c._left,e=c._top;if(c.maximum){f=a(window).width();d=a(window).height();g=e=0;if(b.win.taskbar){d-=b.win.taskbar.outerHeight();if(b.win.top)e+=b.win.taskbar.outerHeight()}}c.set({width:f,height:d,left:g,top:e})}c.actived=true;c.minimize=false;b.win.setFront(c);c.show();b.win.setFront(this)},setUrl:function(a){return _setUrl(a)}})})(jQuery)